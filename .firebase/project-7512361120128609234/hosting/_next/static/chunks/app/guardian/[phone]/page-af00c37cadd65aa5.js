(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[513],{6943:(e,r,s)=>{"use strict";s.d(r,{default:()=>eN});var t=s(5155),n=s(2115),a=s(63),l=s(2619),i=s.n(l),c=s(9708),d=s(4585),o=s(6384),u=s(9017),h=s(2641),x=s(6465),m=s(3998),j=s(6948),p=s(8053),f=s(2544),v=s(6942),g=s(4879);let y=["말티즈","푸들","포메라니안","치와와","시츄","비숑 프리제","요크셔테리어","골든 리트리버","닥스훈트","진돗개","웰시코기","믹스견","기타"],b=["코리안숏헤어","러시안블루","먼치킨","스코티시폴드","페르시안","랙돌","노르웨이숲","브리티시숏헤어","아메리칸숏헤어","샴","믹스묘","기타"];var w=s(1834),N=s(1052),C=s(5142),k=s(6333),R=s(276),I=s(2556),E=s(4446),M=s(3468),D=s(7602),A=s(2431),L=s(3558),S=s(6218),J=s(4288),P=s(8108),z=s(6842),B="Radio",[V,G]=(0,M.A)(B),[O,F]=V(B),Y=n.forwardRef((e,r)=>{let{__scopeRadio:s,name:a,checked:l=!1,required:i,disabled:c,value:d="on",onCheck:o,form:u,...h}=e,[x,m]=n.useState(null),j=(0,E.s)(r,e=>m(e)),p=n.useRef(!1),f=!x||u||!!x.closest("form");return(0,t.jsxs)(O,{scope:s,checked:l,disabled:c,children:[(0,t.jsx)(D.sG.button,{type:"button",role:"radio","aria-checked":l,"data-state":_(l),"data-disabled":c?"":void 0,disabled:c,value:d,...h,ref:j,onClick:(0,I.mK)(e.onClick,e=>{l||null==o||o(),f&&(p.current=e.isPropagationStopped(),p.current||e.stopPropagation())})}),f&&(0,t.jsx)(Z,{control:x,bubbles:!p.current,name:a,value:d,checked:l,required:i,disabled:c,form:u,style:{transform:"translateX(-100%)"}})]})});Y.displayName=B;var q="RadioIndicator",$=n.forwardRef((e,r)=>{let{__scopeRadio:s,forceMount:n,...a}=e,l=F(q,s);return(0,t.jsx)(z.C,{present:n||l.checked,children:(0,t.jsx)(D.sG.span,{"data-state":_(l.checked),"data-disabled":l.disabled?"":void 0,...a,ref:r})})});$.displayName=q;var Z=n.forwardRef((e,r)=>{let{__scopeRadio:s,control:a,checked:l,bubbles:i=!0,...c}=e,d=n.useRef(null),o=(0,E.s)(d,r),u=(0,P.Z)(l),h=(0,J.X)(a);return n.useEffect(()=>{let e=d.current;if(!e)return;let r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(u!==l&&r){let s=new Event("click",{bubbles:i});r.call(e,l),e.dispatchEvent(s)}},[u,l,i]),(0,t.jsx)(D.sG.input,{type:"radio","aria-hidden":!0,defaultChecked:l,...c,tabIndex:-1,ref:o,style:{...c.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function _(e){return e?"checked":"unchecked"}Z.displayName="RadioBubbleInput";var H=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],K="RadioGroup",[W,X]=(0,M.A)(K,[A.RG,G]),Q=(0,A.RG)(),T=G(),[U,ee]=W(K),er=n.forwardRef((e,r)=>{let{__scopeRadioGroup:s,name:n,defaultValue:a,value:l,required:i=!1,disabled:c=!1,orientation:d,dir:o,loop:u=!0,onValueChange:h,...x}=e,m=Q(s),j=(0,S.jH)(o),[p,f]=(0,L.i)({prop:l,defaultProp:null!=a?a:null,onChange:h,caller:K});return(0,t.jsx)(U,{scope:s,name:n,required:i,disabled:c,value:p,onValueChange:f,children:(0,t.jsx)(A.bL,{asChild:!0,...m,orientation:d,dir:j,loop:u,children:(0,t.jsx)(D.sG.div,{role:"radiogroup","aria-required":i,"aria-orientation":d,"data-disabled":c?"":void 0,dir:j,...x,ref:r})})})});er.displayName=K;var es="RadioGroupItem",et=n.forwardRef((e,r)=>{let{__scopeRadioGroup:s,disabled:a,...l}=e,i=ee(es,s),c=i.disabled||a,d=Q(s),o=T(s),u=n.useRef(null),h=(0,E.s)(r,u),x=i.value===l.value,m=n.useRef(!1);return n.useEffect(()=>{let e=e=>{H.includes(e.key)&&(m.current=!0)},r=()=>m.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",r),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",r)}},[]),(0,t.jsx)(A.q7,{asChild:!0,...d,focusable:!c,active:x,children:(0,t.jsx)(Y,{disabled:c,required:i.required,checked:x,...o,...l,name:i.name,ref:h,onCheck:()=>i.onValueChange(l.value),onKeyDown:(0,I.mK)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,I.mK)(l.onFocus,()=>{var e;m.current&&(null==(e=u.current)||e.click())})})})});et.displayName=es;var en=n.forwardRef((e,r)=>{let{__scopeRadioGroup:s,...n}=e,a=T(s);return(0,t.jsx)($,{...a,...n,ref:r})});en.displayName="RadioGroupIndicator";var ea=s(4294);let el=(0,ea.A)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var ei=s(4269);let ec=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)(er,{className:(0,ei.cn)("grid gap-2",s),...n,ref:r})});ec.displayName=er.displayName;let ed=n.forwardRef((e,r)=>{let{className:s,...n}=e;return(0,t.jsx)(et,{ref:r,className:(0,ei.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),...n,children:(0,t.jsx)(en,{className:"flex items-center justify-center",children:(0,t.jsx)(el,{className:"h-2.5 w-2.5 fill-current text-current"})})})});ed.displayName=et.displayName;var eo=s(1186),eu=s(8127),eh=s(5282),ex=s(9592),em=s(5894),ej=s(1218),ep=s(1136);let ef=g.Ik({chartId:g.Yj().min(1,"차트번호는 필수입니다."),name:g.Yj().min(1,"환자 이름은 필수입니다."),species:g.k5(["개","고양이"]),breed:g.Yj().min(1,"품종은 필수입니다."),birthDate:g.p6({required_error:"생년월일은 필수입니다."}),gender:g.k5(["수컷","암컷"]),isNeutered:g.zM().default(!1),weight:g.au.number().min(.1,"몸무게는 0.1kg 이상이어야 합니다.")});function ev(e){let{open:r,onOpenChange:s,guardian:a}=e,[l,i]=(0,n.useState)(!1),[o,u]=(0,n.useState)(!1),{toast:h}=(0,em.dj)(),x=(0,f.mN)({resolver:(0,v.u)(ef),defaultValues:{chartId:"",name:"",species:"개",breed:"",birthDate:void 0,gender:"수컷",isNeutered:!1,weight:0}}),j=(0,f.FH)({control:x.control,name:"species"});(0,n.useEffect)(()=>{x.setValue("breed","")},[j,x]),(0,n.useEffect)(()=>{r&&x.reset({chartId:"",species:"개",name:"",breed:"",birthDate:void 0,gender:"수컷",isNeutered:!1,weight:0})},[r,x]);let p=async e=>{if(!a)return void h({title:"오류",description:"보호자 정보가 없습니다.",variant:"destructive"});i(!0);try{let r=(0,c.H9)(d.db,"patients",e.chartId);if((await (0,c.x7)(r)).exists()){h({title:"오류",description:"이미 존재하는 차트번호입니다. 다른 번호를 입력해주세요.",variant:"destructive"}),x.setError("chartId",{type:"manual",message:"이미 사용 중인 차트번호입니다."}),i(!1);return}await (0,c.BN)(r,{guardianName:a.name,guardianPhone:a.phone,...e,id:e.chartId,birthDate:c.Dc.fromDate(e.birthDate),surgeryDate:c.Dc.now(),createdAt:(0,c.O5)(),updatedAt:(0,c.O5)(),hasHeartCondition:!1,hasLiverCondition:!1,hasKidneyCondition:!1}),h({title:"성공",description:"".concat(a.name," 보호자님의 새 반려동물(").concat(e.name,")이 등록되었습니다.")}),s(!1)}catch(e){console.error("Error adding document: ",e),h({title:"오류",description:"환자 등록 중 오류가 발생했습니다.",variant:"destructive"})}finally{i(!1)}},g="개"===j?y:b;return(0,t.jsx)(w.lG,{open:r,onOpenChange:s,children:(0,t.jsxs)(w.Cf,{className:"sm:max-w-[425px]",children:[(0,t.jsxs)(w.c7,{children:[(0,t.jsx)(w.L3,{children:"새 반려동물 추가"}),(0,t.jsxs)(w.rr,{children:[null==a?void 0:a.name," 보호자님의 반려동물 정보를 입력하세요."]})]}),(0,t.jsx)(N.lV,{...x,children:(0,t.jsxs)("form",{onSubmit:x.handleSubmit(p),className:"space-y-4",children:[(0,t.jsx)(N.zB,{control:x.control,name:"chartId",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{children:[(0,t.jsx)(N.lR,{children:"차트번호"}),(0,t.jsx)(N.MJ,{children:(0,t.jsx)(C.p,{placeholder:"고유 번호 입력",...r})}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsx)(N.zB,{control:x.control,name:"name",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{children:[(0,t.jsx)(N.lR,{children:"이름"}),(0,t.jsx)(N.MJ,{children:(0,t.jsx)(C.p,{placeholder:"예: 사랑이",...r})}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsx)(N.zB,{control:x.control,name:"species",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{children:[(0,t.jsx)(N.lR,{children:"종"}),(0,t.jsx)(N.MJ,{children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(m.$,{type:"button",variant:"개"===r.value?"secondary":"outline",className:(0,ei.cn)("flex-1 h-14 text-xl","개"===r.value&&"shadow-md border-2 border-yellow-400 bg-yellow-100 text-yellow-800 hover:bg-yellow-200"),onClick:()=>r.onChange("개"),children:[(0,t.jsx)(ej.w,{className:"h-8 w-8 mr-2"})," 개"]}),(0,t.jsxs)(m.$,{type:"button",variant:"고양이"===r.value?"secondary":"outline",className:(0,ei.cn)("flex-1 h-14 text-xl","고양이"===r.value&&"shadow-md border-2 border-yellow-400 bg-yellow-100 text-yellow-800 hover:bg-yellow-200"),onClick:()=>r.onChange("고양이"),children:[(0,t.jsx)(ep.k,{className:"h-8 w-8 mr-2"})," 고양이"]})]})}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsx)(N.zB,{control:x.control,name:"breed",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{children:[(0,t.jsx)(N.lR,{children:"품종"}),(0,t.jsxs)(eo.l6,{onValueChange:r.onChange,defaultValue:r.value,children:[(0,t.jsx)(N.MJ,{children:(0,t.jsx)(eo.bq,{children:(0,t.jsx)(eo.yv,{placeholder:"품종을 선택하세요"})})}),(0,t.jsx)(eo.gC,{children:g.map(e=>(0,t.jsx)(eo.eb,{value:e,children:e},e))})]}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsx)(N.zB,{control:x.control,name:"birthDate",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{className:"flex flex-col",children:[(0,t.jsx)(N.lR,{children:"생년월일"}),(0,t.jsxs)(k.AM,{open:o,onOpenChange:u,children:[(0,t.jsx)(k.Wv,{asChild:!0,children:(0,t.jsx)(N.MJ,{children:(0,t.jsxs)(m.$,{variant:"outline",className:(0,ei.cn)("w-full pl-3 text-left font-normal",!r.value&&"text-muted-foreground"),children:[r.value?(0,eh.GP)(r.value,"PPP",{locale:ex.ko}):(0,t.jsx)("span",{children:"날짜 선택"}),(0,t.jsx)(eu.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,t.jsx)(k.hl,{className:"w-auto p-0",align:"start",children:(0,t.jsx)(R.V,{locale:ex.ko,mode:"single",selected:r.value,onSelect:e=>{r.onChange(e),u(!1)},disabled:e=>e>new Date||e<new Date(new Date().setFullYear(new Date().getFullYear()-25)),initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-25,toYear:new Date().getFullYear()})})]}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsx)(N.zB,{control:x.control,name:"gender",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{className:"space-y-3",children:[(0,t.jsx)(N.lR,{children:"성별"}),(0,t.jsx)(N.MJ,{children:(0,t.jsxs)(ec,{onValueChange:r.onChange,defaultValue:r.value,className:"flex items-center space-x-2",children:[(0,t.jsxs)(N.eI,{className:"flex items-center space-x-2 space-y-0",children:[(0,t.jsx)(N.MJ,{children:(0,t.jsx)(ed,{value:"수컷"})}),(0,t.jsx)(N.lR,{className:"font-normal",children:"수컷"})]}),(0,t.jsxs)(N.eI,{className:"flex items-center space-x-2 space-y-0",children:[(0,t.jsx)(N.MJ,{children:(0,t.jsx)(ed,{value:"암컷"})}),(0,t.jsx)(N.lR,{className:"font-normal",children:"암컷"})]})]})}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsx)(N.zB,{control:x.control,name:"isNeutered",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{className:"space-y-3",children:[(0,t.jsx)(N.lR,{children:"중성화 여부"}),(0,t.jsx)(N.MJ,{children:(0,t.jsxs)(ec,{onValueChange:e=>r.onChange("true"===e),defaultValue:String(r.value),className:"flex items-center space-x-2",children:[(0,t.jsxs)(N.eI,{className:"flex items-center space-x-2 space-y-0",children:[(0,t.jsx)(N.MJ,{children:(0,t.jsx)(ed,{value:"true"})}),(0,t.jsx)(N.lR,{className:"font-normal",children:"완료"})]}),(0,t.jsxs)(N.eI,{className:"flex items-center space-x-2 space-y-0",children:[(0,t.jsx)(N.MJ,{children:(0,t.jsx)(ed,{value:"false"})}),(0,t.jsx)(N.lR,{className:"font-normal",children:"미완료"})]})]})}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsx)(N.zB,{control:x.control,name:"weight",render:e=>{let{field:r}=e;return(0,t.jsxs)(N.eI,{children:[(0,t.jsx)(N.lR,{children:"몸무게 (kg)"}),(0,t.jsx)(N.MJ,{children:(0,t.jsx)(C.p,{type:"number",step:"0.1",...r,onFocus:e=>{"0"===e.target.value&&(e.target.value="")},onBlur:e=>{""===e.target.value&&(e.target.value="0")}})}),(0,t.jsx)(N.C5,{})]})}}),(0,t.jsxs)(w.Es,{children:[(0,t.jsx)(m.$,{type:"button",variant:"ghost",onClick:()=>s(!1),children:"취소"}),(0,t.jsx)(m.$,{type:"submit",disabled:l,children:l?"저장 중...":"추가하기"})]})]})})]})})}var eg=s(6204),ey=s(2265),eb=s(3630);let ew=(0,ea.A)("Cat",[["path",{d:"M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7-.42 7 .57 1.07 1 2.24 1 3.44C21 17.9 16.97 21 12 21s-9-3-9-7.56c0-1.25.5-2.4 1-3.44 0 0-1.89-6.42-.5-7 1.39-.58 4.72.23 6.5 2.23A9.04 9.04 0 0 1 12 5Z",key:"x6xyqk"}],["path",{d:"M8 14v.5",key:"1nzgdb"}],["path",{d:"M16 14v.5",key:"1lajdz"}],["path",{d:"M11.25 16.25h1.5L12 17l-.75-.75Z",key:"12kq1m"}]]);function eN(e){let{phone:r}=e,[s,l]=(0,o.M)("isLoggedIn",!1),[f,v]=(0,n.useState)(!1),[g,y]=(0,n.useState)([]),[b,w]=(0,n.useState)(""),[N,C]=(0,n.useState)(!0),[k,R]=(0,n.useState)(!1),[I,E]=(0,n.useState)(!1),[M,D]=(0,n.useState)(null),A=(0,a.useRouter)(),{toast:L}=(0,em.dj)();(0,n.useEffect)(()=>{v(!0);let e=(0,c.P)((0,c.rJ)(d.db,"patients"),(0,c._M)("guardianPhone","==",r)),s=(0,c.aQ)(e,e=>{y(e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>e.name)),e.docs.length>0&&!b?w(e.docs[0].data().guardianName):e.empty&&!N&&A.push("/"),C(!1)},e=>{console.error("Error fetching guardian's patients: ",e),L({title:"오류",description:"환자 목록을 불러오는 중 오류가 발생했습니다.",variant:"destructive"}),C(!1)});return()=>s()},[r,L,A,N,b]);let S=async()=>{if(M)try{await (0,c.kd)((0,c.H9)(d.db,"patients",M.id)),L({title:"성공",description:"".concat(M.name," 환자 정보가 삭제되었습니다.")})}catch(e){console.error("Error deleting patient: ",e),L({title:"오류",description:"환자 정보 삭제 중 오류가 발생했습니다.",variant:"destructive"})}finally{E(!1),D(null)}};return!f||N?(0,t.jsx)(x.p,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Y,{isLoggedIn:s,onLogout:()=>l(!1)}),(0,t.jsx)("div",{className:"container mx-auto p-4 md:p-6",children:s?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(m.$,{asChild:!0,variant:"outline",children:(0,t.jsxs)(i(),{href:"/",children:[(0,t.jsx)(eg.A,{className:"mr-2 h-4 w-4"}),"보호자 목록으로"]})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold tracking-tight",children:[b,"님의 반려동물"]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:r})]}),(0,t.jsxs)(j.Zp,{children:[(0,t.jsx)(j.aR,{children:(0,t.jsx)(j.ZB,{children:"새 반려동물 차트 생성"})}),(0,t.jsx)(j.Wu,{children:(0,t.jsxs)(m.$,{onClick:()=>R(!0),children:[(0,t.jsx)(ey.A,{className:"mr-2 h-4 w-4"})," 새 환자 추가"]})})]}),(0,t.jsx)("div",{className:"space-y-4",children:g.length>0?g.map(e=>(0,t.jsxs)(j.Zp,{className:"flex items-center justify-between p-4 transition-colors hover:bg-muted/50",children:[(0,t.jsxs)("div",{className:"flex-grow flex items-center gap-4 cursor-pointer",onClick:()=>A.push("/patient/".concat(e.id)),children:["개"===e.species?(0,t.jsx)(ej.w,{className:"h-8 w-8 text-muted-foreground"}):(0,t.jsx)(ew,{className:"h-8 w-8 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.species," / ",e.breed]})]})]}),(0,t.jsxs)(m.$,{variant:"ghost",size:"icon",className:"h-8 w-8 flex-shrink-0 text-destructive hover:text-destructive",onClick:r=>{r.stopPropagation(),D(e),E(!0)},children:[(0,t.jsx)(eb.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"삭제"})]})]},e.id)):(0,t.jsx)(j.Zp,{className:"p-8 text-center text-muted-foreground",children:"등록된 반려동물이 없습니다. '새 환자 추가' 버튼을 눌러 등록해주세요."})}),(0,t.jsx)(ev,{open:k,onOpenChange:R,guardian:{name:b,phone:r}}),(0,t.jsx)(p.Lt,{open:I,onOpenChange:E,children:(0,t.jsxs)(p.EO,{children:[(0,t.jsxs)(p.wd,{children:[(0,t.jsx)(p.r7,{children:"정말로 삭제하시겠습니까?"}),(0,t.jsxs)(p.$v,{children:["이 작업은 되돌릴 수 없습니다. ",null==M?void 0:M.name," 환자의 모든 정보가 영구적으로 삭제됩니다."]})]}),(0,t.jsxs)(p.ck,{children:[(0,t.jsx)(p.Zr,{children:"취소"}),(0,t.jsx)(p.Rx,{onClick:S,className:"bg-destructive hover:bg-destructive/90",children:"삭제"})]})]})})]}):(0,t.jsx)(h.A,{onLoginSuccess:()=>l(!0)})})]})}},8434:(e,r,s)=>{Promise.resolve().then(s.bind(s,6943))}},e=>{e.O(0,[992,138,45,619,279,566,815,429,153,441,255,358],()=>e(e.s=8434)),_N_E=e.O()}]);