(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[510],{2260:(e,t,s)=>{Promise.resolve().then(s.bind(s,5516))},2383:()=>{},3686:()=>{},5516:(e,t,s)=>{"use strict";s.d(t,{default:()=>sr});var a=s(5155),n=s(2115),i=s(6384),r=s(2619),l=s.n(r),c=s(63),d=s(9708),o=s(2544),m=s(6942),u=s(4879),x=s(4585);let h=u.Ik({chartId:u.Yj().min(1,"차트 번호는 필수입니다."),guardianName:u.Yj().min(1,"보호자 이름은 필수입니다."),guardianPhone:u.Yj().min(1,"보호자 연락처는 필수입니다."),name:u.Yj().min(1,"이름은 필수입니다."),species:u.k5(["개","고양이"]),breed:u.Yj().min(1,"품종은 필수입니다."),birthDate:u.p6({required_error:"생년월일은 필수입니다."}),gender:u.k5(["수컷","암컷"]),isNeutered:u.zM().default(!1),weight:u.au.number().min(.1,"몸무게는 0.1kg 이상이어야 합니다."),hasHeartCondition:u.zM().default(!1),hasLiverCondition:u.zM().default(!1),hasKidneyCondition:u.zM().default(!1),hasBloodCondition:u.zM().default(!1),surgeryDate:u.p6().optional().nullable(),detailedFindings:u.Yj().optional(),googleDriveLink:u.Yj().url("유효한 URL을 입력해주세요.").optional().or(u.eu("")),surgeryStartTime:u.p6().nullable(),surgeryEndTime:u.p6().nullable(),anesthesiaDuration:u.ai().optional(),catheterSize:u.Yj().optional(),cuffGuide:u.Yj().optional()});var p=s(6465),g=s(3998),j=s(6948),f=s(6204),y=s(3180),b=s(6251),v=s(6713),N=s(9396),w=s(7592),C=s(2033),_=s(8527),k=s(5894),S=s(7270),D=s(7037),R=s(7268),M=s(4269);let A=n.forwardRef((e,t)=>{let{className:s,orientation:n="horizontal",decorative:i=!0,...r}=e;return(0,a.jsx)(R.b,{ref:t,decorative:i,orientation:n,className:(0,M.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",s),...r})});A.displayName=R.b.displayName;var F=s(8162),L=s(2251);let T=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(F.bL,{ref:t,className:(0,M.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...n,children:(0,a.jsx)(F.C1,{className:(0,M.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(L.A,{className:"h-4 w-4"})})})});T.displayName=F.bL.displayName;var I=s(5142),P=s(1064),z=s(7940),E=s(8068),B=s(3107),W=s(9511),O=s(3101),H=s(6615);let $=W.bL,Z=W.l9;W.bm;let G=W.ZL,K=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(W.hJ,{className:(0,M.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...n,ref:t})});K.displayName=W.hJ.displayName;let q=(0,O.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),U=n.forwardRef((e,t)=>{let{side:s="right",className:n,children:i,...r}=e;return(0,a.jsxs)(G,{children:[(0,a.jsx)(K,{}),(0,a.jsxs)(W.UC,{ref:t,className:(0,M.cn)(q({side:s}),n),...r,children:[i,(0,a.jsxs)(W.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(H.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});U.displayName=W.UC.displayName;let V=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,M.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};V.displayName="SheetHeader";let X=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,M.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};X.displayName="SheetFooter";let Y=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(W.hE,{ref:t,className:(0,M.cn)("text-lg font-semibold text-foreground",s),...n})});Y.displayName=W.hE.displayName;let J=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(W.VY,{ref:t,className:(0,M.cn)("text-sm text-muted-foreground",s),...n})});J.displayName=W.VY.displayName;let Q=(e,t)=>e<5?"<5":e<10?"5-10":e<15||"고양이"===t&&e>=15?"10-15":e<20?"15-20":e<30?"20-30":e<40?"30-40":">40",ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.entries(e).map(e=>{let[s,a]=e;return{key:s,label:"".concat(t," ").concat(s).trim(),price:a}})},et={healthCheckup:{dog:{기본검사:{"<5":19e4,"5-10":21e4,"10-15":23e4,"15-20":24e4,"20-30":24e4,"30-40":24e4,">40":24e4},일반검사:{"<5":29e4,"5-10":31e4,"10-15":33e4,"15-20":34e4,"20-30":34e4,"30-40":34e4,">40":34e4},종합검사:{"<5":39e4,"5-10":41e4,"10-15":43e4,"15-20":44e4,"20-30":44e4,"30-40":44e4,">40":44e4},심화검사:{"<5":49e4,"5-10":51e4,"10-15":53e4,"15-20":53e4,"20-30":53e4,"30-40":53e4,">40":53e4}},cat:{기본검사:{"<5":19e4,"5-10":21e4,"10-15":23e4},일반검사:{"<5":29e4,"5-10":31e4,"10-15":33e4},종합검사:{"<5":39e4,"5-10":41e4,"10-15":43e4},심화검사:{"<5":49e4,"5-10":51e4,"10-15":53e4}}},scalingPackage:{dog:{"<5":399e3,"5-10":449e3,"10-15":499e3,"15-20":549e3,"20-30":599e3,"30-40":649e3,">40":699e3},cat:{"<5":399e3,"5-10":449e3,"10-15":499e3}},anesthesiaPackage:{dog:{"<5":36e4,"5-10":41e4,"10-15":46e4,"15-20":51e4,"20-30":56e4,"30-40":61e4,">40":66e4},cat:{"<5":36e4,"5-10":41e4,"10-15":46e4}},additionalAnesthesiaDrugs:{bradycardia:{name:"서맥 대응 약물",priceByWeight:{"<5":11e3,"5-10":12e3,"10-15":13e3,"15-20":14e3,"20-30":15e3,"30-40":16e3,">40":17e3}},hypotension:{name:"저혈압 대응 약물",priceByWeight:{"<5":33e3,"5-10":34e3,"10-15":35e3,"15-20":36e3,"20-30":38e3,"30-40":39e3,">40":4e4}},cpa:{name:"심정지 대응 약물",priceByWeight:{"<5":11e4,"5-10":12e4,"10-15":13e4,"15-20":14e4,"20-30":15e4,"30-40":16e4,">40":17e4}},liver_recovery:{name:"간기능 회복제",priceByWeight:{"<5":11e3,"5-10":12e3,"10-15":13e3,"15-20":14e3,"20-30":15e3,"30-40":16e3,">40":17e3}}},anesthesiaChange:{common:{"<5":33e3,"5-10":35e3,"10-15":37e3,"15-20":38e3,"20-30":4e4,"30-40":43e3,">40":47e3}},anesthesiaExtension:{common:{"<5":66e3,"5-10":7e4,"10-15":73e3,"15-20":76e3,"20-30":8e4,"30-40":99e3,">40":11e4}},localAnesthesia:{common:{"<5":{1:1e4,2:15e3,3:18e3,4:2e4},"5-10":{1:11e3,2:16e3,3:19e3,4:21e3},"10-15":{1:12e3,2:17e3,3:2e4,4:22e3},"15-20":{1:13e3,2:18e3,3:21e3,4:23e3},"20-30":{1:14e3,2:19e3,3:22e3,4:24e3},"30-40":{1:15e3,2:23e3,3:28e3,4:3e4},">40":{1:16e3,2:25e3,3:3e4,4:32e3}}},narcoticInjection:{common:{"<5":2e4,"5-10":21e3,"10-15":22e3,"15-20":23e3,"20-30":24e3,"30-40":3e4,">40":32e3}},sustainedAnalgesia:{common:{"<5":15e3,"5-10":16500,"10-15":18e3,"15-20":19500,"20-30":21e3,"30-40":22500,">40":24e3}},painControlPump:{common:{"<5":4e4,"5-10":42e3,"10-15":44e3,"15-20":46e3,"20-30":48e3,"30-40":6e4,">40":64e3}},narcoticPatch:{"5ug":4e4,"10ug":5e4,"20ug":6e4},antibioticInjection:{common:{"<5":11e3,"5-10":12e3,"10-15":13e3,"15-20":14e3,"20-30":15e3,"30-40":17e3,">40":18e3}},longActingInjection:{common:{"<5":15e3,"5-10":16e3,"10-15":17e3,"15-20":18e3,"20-30":19e3,"30-40":22e3,">40":24e3}},laserTherapy:{common:{local:{"<5":2e4,"5-10":21e3,"10-15":22e3,"15-20":23e3,"20-30":24e3,"30-40":3e4,">40":32e3},full:{"<5":25e3,"5-10":26250,"10-15":27500,"15-20":28750,"20-30":3e4,"30-40":37500,">40":4e4}}},fluoride:{common:{"<5":35e3,"5-10":36e3,"10-15":39e3,"15-20":4e4,"20-30":42e3,"30-40":45e3,">40":48e3}},oralMeds:{common:{"<5":3300,"5-10":3500,"10-15":3800,"15-20":4e3,"20-30":4500,"30-40":5e3,">40":5500}},capsule:{"3d":3e3,"7d":5500},liquidAnalgesicRate:8e3,hexidineSpray:{"헥시딘 스프레이":1e4},oralOintment:{"구강 항생연고":15e3},oralCoatingSpray:{"구강점막 보호제":33e3},parodonGel:{"파로돈 겔":25e3},oralProbiotics:{"구강 유산균":5e4},neckCollar:{"8cm":8e3,"10cm":1e4,"13cm":12e3,"15cm":15e3,"17cm":17e3,"20cm":2e4,"25cm":25e3,"35cm":3e4}},es=e=>{var t,s,a,n,i,r,l,c;let{species:d,weight:o}=e;if(!d||!o||o<=0)return{};let m=Q(o,d);return{categories:[{id:"additionalAnesthesiaDrugs",name:"마취중 대응 약물",description:"마취 중 발생할 수 있는 상황에 대비한 약물입니다."},{id:"anesthesia",name:"마취",description:"마취 관련 추가 처치 항목입니다."},{id:"pain",name:"통증 관리",description:"수술 중 및 수술 후 통증 관리를 위한 항목입니다."},{id:"recovery",name:"회복 촉진",description:"빠른 회복을 돕는 주사, 레이저, 불소 도포 등입니다."},{id:"homeCare",name:"홈케어",description:"퇴원 후 가정에서 필요한 약물 및 용품입니다."}],itemsByCategoryId:{additionalAnesthesiaDrugs:[{id:"additional_anesthesia_drug",name:"추가 약물",options:Object.entries(et.additionalAnesthesiaDrugs).map(e=>{let[t,s]=e;return{key:t,label:s.name,price:s.priceByWeight[m]||0}}),isMultiSelect:!0}],anesthesia:[{id:"anesthesia_change",name:"도입마취 변경: 알팍산",options:[{key:m,label:"",price:(null==(t=et.anesthesiaChange.common)?void 0:t[m])||0}]},{id:"anesthesia_extension",name:"마취 연장",options:[1,2,3,4,5,6,7,8].map(e=>{var t;let s=30*e,a=(null==(t=et.anesthesiaExtension.common)?void 0:t[m])||0;return{key:"".concat(s,"min"),label:"".concat(s,"분"),price:a*e}})},{id:"local_anesthesia",name:"국소마취",options:Object.entries((null==(s=et.localAnesthesia.common)?void 0:s[m])||{}).map(e=>{let[t,s]=e;return{key:"".concat(t,"_sites"),label:"".concat(t," site"),price:s}})}],pain:[{id:"narcotic_injection",name:"마약성 진통 혈관주사",options:[{key:m,label:"",price:(null==(a=et.narcoticInjection.common)?void 0:a[m])||0}]},{id:"sustained_analgesia",name:"24시간 지속 진통 주사",options:[{key:m,label:"",price:(null==(n=et.sustainedAnalgesia.common)?void 0:n[m])||0}]},{id:"pain_control_pump",name:"무통주사 (시린지펌프)",options:[{key:m,label:"",price:(null==(i=et.painControlPump.common)?void 0:i[m])||0}]},{id:"narcotic_patch",name:"마약성 진통패취",options:ee(et.narcoticPatch,"노스판")}],recovery:[{id:"antibiotic_injection",name:"항생/소염 주사 (일반)",options:[{key:m,label:"일반",price:(null==(r=et.antibioticInjection.common)?void 0:r[m])||0}]},{id:"long_acting_injection",name:"1주 지속 항생/소염 주사",options:[{key:m,label:"",price:(null==(l=et.longActingInjection.common)?void 0:l[m])||0}]},{id:"laser_therapy",name:"레이저 치료",options:Object.entries(et.laserTherapy.common).map(e=>{let[t,s]=e;return{key:t,label:"local"===t?"국소":"구강 전체",price:s[m]||0}})},{id:"fluoride",name:"불소 도포",options:[{key:m,label:"",price:(null==(c=et.fluoride.common)?void 0:c[m])||0}]}],homeCare:[{id:"oral_meds",name:"내복약",options:Array.from({length:7},(e,t)=>t+1).map(e=>{var t;return{key:"".concat(e,"d"),label:"".concat(e,"일"),price:((null==(t=et.oralMeds.common)?void 0:t[m])||0)*e}})},{id:"capsule",name:"캡슐 조제",options:[{key:"3d",label:"3일",price:et.capsule["3d"]},{key:"7d",label:"7일(1주)",price:et.capsule["7d"]}]},{id:"liquid_analgesic",name:"액상 진통제(NSAID)",options:Array.from({length:7},(e,t)=>t+1).map(e=>{let t=Math.ceil((.2*o+(e>1?(e-1)*o*.1:0))*10)/10,s=100*Math.ceil(t*et.liquidAnalgesicRate/100);return{key:"".concat(e,"d"),label:"".concat(e,"일 (").concat(t.toFixed(1),"ml)"),price:s}})},{id:"hexidine_spray",name:"헥시딘 스프레이",options:ee(et.hexidineSpray),isMultiSelect:!0},{id:"oral_ointment",name:"구강 항생연고",options:ee(et.oralOintment),isMultiSelect:!0},{id:"oral_coating_spray",name:"구강점막 보호제",options:ee(et.oralCoatingSpray),isMultiSelect:!0},{id:"parodon_gel",name:"파로돈 겔",options:ee(et.parodonGel),isMultiSelect:!0},{id:"oral_probiotics",name:"구강 유산균",options:ee(et.oralProbiotics),isMultiSelect:!0},{id:"neck_collar",name:"넥카라",options:ee(et.neckCollar)}]}}},ea={permanent:{dog:{incisors:["101","102","103","201","202","203","301","302","303","401","402","403"],canines:["104","204","304","404"],premolars:["105","106","107","108","205","206","207","208","305","306","307","308","405","406","407","408"],molars:["109","110","209","210","309","310","311","409","410","411"]},cat:{incisors:["101","102","103","201","202","203","301","302","303","401","402","403"],canines:["104","204","304","404"],premolars:["106","107","108","206","207","208","307","308","407","408"],molars:["109","209","309","409"]}},deciduous:{dog:{incisors:["501","502","503","601","602","603","701","702","703","801","802","803"],canines:["504","604","704","804"],premolars:["505","506","507","508","605","606","607","608","705","706","707","708","805","806","807","808"]},cat:{incisors:["501","502","503","601","602","603","701","702","703","801","802","803"],canines:["504","604","704","804"],premolars:["506","507","508","606","607","608","707","708","807","808"]}}},en={permanent:{upperRight:["101","102","103","104","105","106","107","108","109","110"],upperLeft:["201","202","203","204","205","206","207","208","209","210"],lowerRight:["401","402","403","404","405","406","407","408","409","410","411"],lowerLeft:["301","302","303","304","305","306","307","308","309","310","311"]},deciduous:{upperRight:["501","502","503","504","505","506","507","508"],upperLeft:["601","602","603","604","605","606","607","608"],lowerRight:["801","802","803","804","805","806","807","808"],lowerLeft:["701","702","703","704","705","706","707","708"]}},ei={incisors:"앞니",canines:"송곳니",premolars:"소구치",molars:"어금니"},er=(e,t)=>{if(!t||"기타"===t)return e;let s="";en.permanent.upperRight.includes(e)?s="상악 우측":en.permanent.upperLeft.includes(e)?s="상악 좌측":en.permanent.lowerLeft.includes(e)?s="하악 좌측":en.permanent.lowerRight.includes(e)&&(s="하악 우측");let a="개"===t?ea.permanent.dog:ea.permanent.cat,n="";for(let t in a)if(a[t].includes(e)){n=ei[t];break}return"".concat(e,"(").concat(s," ").concat(n,")")},el={dog:{1:["101","102","103","105","201","202","203","205","301","302","303","305","401","402","403","405","311","411","501","502","503","505","601","602","603","605","701","702","703","705","801","802","803","805"],2:["106","107","110","206","207","210","306","307","308","310","406","407","408","410","506","507","606","607","706","707","708","806","807","808"],3:["108","109","208","209","309","409","508","608"],incisor:[...ea.permanent.dog.incisors,...ea.deciduous.dog.incisors],molar:ea.permanent.dog.molars,premolar:[...ea.permanent.dog.premolars,...ea.deciduous.dog.premolars],carnassial_upper:["108","208"],carnassial_lower:["309","409"],canine:[...ea.permanent.dog.canines,...ea.deciduous.dog.canines],upper_jaw:[...en.permanent.upperRight,...en.permanent.upperLeft,...en.deciduous.upperRight,...en.deciduous.upperLeft],lower_jaw:[...en.permanent.lowerRight,...en.permanent.lowerLeft,...en.deciduous.lowerRight,...en.deciduous.lowerLeft]},cat:{1:["101","102","103","106","109","201","202","203","206","209","301","302","303","309","401","402","403","409","307","407","501","502","503","601","602","603","701","702","703","801","802","803"],2:["107","207","308","408","506","507","606","607","707","708","807","808"],3:["108","208","508","608"],incisor:[...ea.permanent.cat.incisors,...ea.deciduous.cat.incisors],molar:ea.permanent.cat.molars,premolar:[...ea.permanent.cat.premolars,...ea.deciduous.cat.premolars],carnassial_upper:["108","208"],canine:[...ea.permanent.cat.canines,...ea.deciduous.cat.canines],upper_jaw:[...en.permanent.upperRight,...en.permanent.upperLeft,...en.deciduous.upperRight,...en.deciduous.upperLeft],lower_jaw:[...en.permanent.lowerRight,...en.permanent.lowerLeft,...en.deciduous.lowerRight,...en.deciduous.lowerLeft]}},ec=[{id:"ext_surg_1",name:"단근치 수술적 발치",category:"extraction",rootCount:1,isCanine:!1},{id:"ext_norm_1",name:"단근치 일반 발치",category:"extraction",rootCount:1,isCanine:!1},{id:"ext_surg_2",name:"2근치 수술적 발치",category:"extraction",rootCount:2},{id:"ext_norm_2",name:"2근치 일반 발치",category:"extraction",rootCount:2},{id:"ext_surg_3",name:"3근치 수술적 발치",category:"extraction",rootCount:3},{id:"ext_norm_3",name:"3근치 일반 발치",category:"extraction",rootCount:3},{id:"ext_surg_canine_lower",name:"송곳니 수술적 발치(하악)",category:"extraction",isCanine:!0,jaw:"lower"},{id:"ext_norm_canine_lower_suture",name:"송곳니 일반 발치(하악)-봉합",category:"extraction",isCanine:!0,jaw:"lower"},{id:"ext_surg_canine_upper",name:"송곳니 수술적 발치(상악)",category:"extraction",isCanine:!0,jaw:"upper"},{id:"ext_norm_canine_upper_suture",name:"송곳니 일반 발치(상악)-봉합",category:"extraction",isCanine:!0,jaw:"upper"},{id:"forl_crown_1",name:"뿌리 1개 치관절제술",category:"forl_extraction",rootCount:1,isCanine:!1},{id:"forl_root_1",name:"뿌리 1개 흡수 치근 제거",category:"forl_extraction",rootCount:1,isCanine:!1},{id:"forl_crown_2",name:"뿌리 2개 치관절제술",category:"forl_extraction",rootCount:2,isCanine:!1},{id:"forl_root_2",name:"뿌리 2개 흡수 치근 제거",category:"forl_extraction",rootCount:2,isCanine:!1},{id:"dec_ext_gingival",name:"치은 위 유치",category:"deciduous_extraction"},{id:"dec_ext_canine_no_xray",name:"유치 송곳니(X-ray 없이)",category:"deciduous_extraction",isCanine:!0},{id:"dec_ext_canine_xray",name:"유치 송곳니(X-ray 포함)",category:"deciduous_extraction",isCanine:!0},{id:"dec_ext_canine_surg",name:"유치 송곳니(수술 발치)",category:"deciduous_extraction",isCanine:!0},{id:"pdt_ext_surg_1",name:"단근치 수술적 발치 (유치)",category:"deciduous_extraction",rootCount:1,isCanine:!1},{id:"pdt_ext_norm_1",name:"단근치 일반 발치 (유치)",category:"deciduous_extraction",rootCount:1,isCanine:!1},{id:"pdt_ext_surg_2",name:"2근치 수술적 발치 (유치)",category:"deciduous_extraction",rootCount:2},{id:"pdt_ext_norm_2",name:"2근치 일반 발치 (유치)",category:"deciduous_extraction",rootCount:2},{id:"pdt_ext_surg_3",name:"3근치 수술적 발치 (유치)",category:"deciduous_extraction",rootCount:3},{id:"pdt_ext_norm_3",name:"3근치 일반 발치 (유치)",category:"deciduous_extraction",rootCount:3},{id:"vpt_canine",name:"VPT (송곳니)",category:"nerve_treatment",isCanine:!0},{id:"vpt_single_root",name:"VPT (1홀-송곳니 제외)",category:"nerve_treatment"},{id:"vpt_double_root",name:"VPT (2홀)",category:"nerve_treatment",rootCount:2},{id:"vpt_triple_root",name:"VPT (3홀)",category:"nerve_treatment",rootCount:3},{id:"endo_incisor",name:"신경치료 (앞이빨)",category:"nerve_treatment",rootCount:1,toothType:"incisor"},{id:"endo_double_root",name:"신경치료 (뿌리 2개 치아)",category:"nerve_treatment",rootCount:2},{id:"endo_canine",name:"신경치료 (송곳니)",category:"nerve_treatment",isCanine:!0,rootCount:1},{id:"endo_molar",name:"신경치료 (대구치)",category:"nerve_treatment",isMolar:!0},{id:"endo_carnassial",name:"신경치료 (열육치)",category:"nerve_treatment",toothType:"carnassial"},{id:"resin_small",name:"레진 (3mm 이하)",category:"resin_treatment"},{id:"resin_normal",name:"레진 (송곳니, 어금니 제외 3mm 이상)",category:"resin_treatment"},{id:"resin_canine",name:"레진 (송곳니)",category:"resin_treatment",isCanine:!0},{id:"resin_molar",name:"레진 (어금니)",category:"resin_treatment",isMolar:!0},{id:"resin_etching_bonding",name:"에칭&본딩 시술",category:"resin_treatment"},{id:"crown_reduction",name:"치아 단축술(Crown Reduction)",category:"other_surgery"},{id:"gingival_tumor_small",name:"잇몸 종양 (1cm 이하)",category:"other_surgery"},{id:"gingival_tumor_large",name:"잇몸 종양 (1cm 이상)",category:"other_surgery"},{id:"dentigerous_cyst",name:"함치성 치낭 제거술",category:"other_surgery"},{id:"ortho_canine_resin",name:"송곳니 레진 교정",category:"orthodontics",isCanine:!0},{id:"biopsy",name:"조직검사 (1 site)",category:"diagnostics"},{id:"antibiotic_sensitivity",name:"항생제 감수성 검사 (1 site)",category:"diagnostics"},{id:"root_planing",name:"치근활택술",category:"periodontal_treatment"},{id:"open_root_planing",name:"개방 치근활택술(봉합)",category:"periodontal_treatment"},{id:"minocycline",name:"미노클린",category:"periodontal_treatment"},{id:"emdogain",name:"엠도게인",category:"periodontal_treatment"},{id:"gbr_membrane",name:"차폐막",category:"periodontal_treatment"},{id:"bone_graft",name:"인공뼈 이식",category:"periodontal_treatment"},{id:"i_and_d",name:"I&D",category:"periodontal_treatment"},{id:"gingivoplasty",name:"잇몸 성형",category:"periodontal_treatment"},{id:"gingival_suture",name:"잇몸봉합",category:"periodontal_treatment"},{id:"monitoring",name:"모니터링",category:"extraction"}],ed={ext_surg_1:[44e3,46e3,48e3,5e4,52e3,54e3,56e3],ext_norm_1:[22e3,24e3,26e3,28e3,3e4,32e3,34e3],ext_surg_2:[12e4,125e3,13e4,135e3,14e4,145e3,15e4],ext_norm_2:[66e3,68e3,7e4,75e3,8e4,85e3,9e4],ext_surg_3:[25e4,27e4,29e4,31e4,35e4,375e3,4e5],ext_norm_3:[88e3,99e3,11e4,13e4,14e4,15e4,16e4],ext_surg_canine_lower:[3e5,35e4,38e4,39e4,4e5,41e4,45e4],ext_norm_canine_lower_suture:[2e5,21e4,22e4,26e4,28e4,3e5,32e4],ext_surg_canine_upper:[25e4,27e4,29e4,32e4,35e4,375e3,4e5],ext_norm_canine_upper_suture:[2e5,21e4,22e4,26e4,28e4,3e5,32e4],forl_crown_1:[44e3,46e3,48e3,5e4,52e3,54e3,56e3],forl_root_1:[88e3,92400,96800,114400,123200,132e3,140800],forl_crown_2:[88e3,99e3,11e4,13e4,14e4,15e4,16e4],forl_root_2:[15e4,157500,165e3,195e3,21e4,225e3,24e4],dec_ext_gingival:[22e3,24e3,26e3,28e3,3e4,32e3,34e3],dec_ext_canine_no_xray:[33e3,35e3,37e3,4e4,43e3,46e3,49e3],dec_ext_canine_xray:[44e3,47e3,49e3,51e3,55e3,57e3,59e3],dec_ext_canine_surg:[88e3,99e3,11e4,13e4,14e4,15e4,16e4],pdt_ext_surg_1:[44e3,46e3,48e3,5e4,52e3,54e3,56e3],pdt_ext_norm_1:[22e3,24e3,26e3,28e3,3e4,32e3,34e3],pdt_ext_surg_2:[12e4,125e3,13e4,135e3,14e4,145e3,15e4],pdt_ext_norm_2:[66e3,68e3,7e4,75e3,8e4,85e3,9e4],pdt_ext_surg_3:[25e4,27e4,29e4,31e4,35e4,375e3,4e5],pdt_ext_norm_3:[88e3,99e3,11e4,13e4,14e4,15e4,16e4],vpt_canine:[45e4,45e4,45e4,45e4,45e4,45e4,45e4],vpt_single_root:[25e4,25e4,25e4,25e4,25e4,25e4,25e4],vpt_double_root:[66e4,66e4,66e4,66e4,66e4,66e4,66e4],vpt_triple_root:[77e4,77e4,77e4,77e4,77e4,77e4,77e4],endo_incisor:[45e4,45e4,45e4,45e4,45e4,45e4,45e4],endo_double_root:[66e4,66e4,66e4,66e4,66e4,66e4,66e4],endo_canine:[77e4,77e4,77e4,77e4,77e4,77e4,77e4],endo_molar:[88e4,88e4,88e4,88e4,88e4,88e4,88e4],endo_carnassial:[88e4,88e4,88e4,88e4,88e4,88e4,88e4],resin_small:[55e3,55e3,55e3,55e3,55e3,55e3,55e3],resin_normal:[77e3,77e3,77e3,77e3,77e3,77e3,77e3],resin_canine:[11e4,11e4,11e4,11e4,11e4,11e4,11e4],resin_molar:[13e4,13e4,13e4,13e4,13e4,13e4,13e4],resin_etching_bonding:[33e3,33e3,33e3,33e3,33e3,33e3,33e3],crown_reduction:[11e4,115500,121e3,143e3,154e3,165e3,176e3],gingival_tumor_small:[11e4,115500,121e3,143e3,154e3,165e3,176e3],gingival_tumor_large:[22e4,231e3,242e3,286e3,308e3,33e4,352e3],dentigerous_cyst:[22e4,231e3,242e3,286e3,308e3,33e4,352e3],ortho_canine_resin:[66e4,66e4,66e4,66e4,66e4,66e4,66e4],biopsy:[17e4,17e4,17e4,17e4,17e4,17e4,17e4],antibiotic_sensitivity:[143e3,143e3,143e3,143e3,143e3,143e3,143e3],root_planing:[45e3,45e3,45e3,45e3,45e3,45e3,45e3],open_root_planing:[22e4,22e4,22e4,22e4,22e4,22e4,22e4],minocycline:[22e3,24e3,26e3,28e3,3e4,32e3,34e3],emdogain:[99e3,11e4,13e4,15e4,17e4,18e4,19e4],gbr_membrane:[1e5,11e4,13e4,15e4,17e4,18e4,19e4],bone_graft:[2e5,21e4,22e4,26e4,28e4,3e5,32e4],i_and_d:[33e3,35e3,37e3,39e3,41e3,43e3,45e3],gingivoplasty:[5e4,55e3,6e4,65e3,7e4,75e3,8e4],gingival_suture:[33e3,4e4,45e3,5e4,55e3,6e4,65e3],monitoring:[0,0,0,0,0,0,0]},eo=[{id:"extraction",name:"\uD83E\uDDB7 발치"},{id:"forl_extraction",name:"\uD83D\uDC94 치아흡수병변 발치"},{id:"deciduous_extraction",name:"\uD83C\uDF7C 유치 발치"},{id:"nerve_treatment",name:"❤️‍\uD83E\uDE79 신경/보존 치료"},{id:"resin_treatment",name:"\uD83D\uDC8E 레진 치료"},{id:"periodontal_treatment",name:"✨ 치주 치료"},{id:"other_surgery",name:"⚡ 기타 수술/검사"},{id:"orthodontics",name:"\uD83D\uDCD0 교정 치료"},{id:"diagnostics",name:"\uD83D\uDD2C 검사"}],em=(e,t)=>{if(!e||t<=0)return{};let s={"<5":0,"5-10":1,"10-15":2,"15-20":3,"20-30":4,"30-40":5,">40":6}[Q(t,e)],a=ec.map(e=>{var t;let a=ed[e.id]||[],n=null!=(t=a[s])?t:0;return{...e,price:n,available:a.length>0}}),n={};return eo.forEach(e=>{n[e.id]=a.filter(t=>t.category===e.id&&t.available)}),n};var eu=s(8903),ex=s(358);let eh=[{name:"치주 질환",icon:P.A,color:"text-red-500",conditions:[{id:"PD",name:"치주염 (PD)",value:[1,2,3,4],unit:""},{id:"GI",name:"치은염 (GI)",value:[1,2,3],unit:""},{id:"GH",name:"치은 증식 (GH)",value:[1,2,3,4,5],unit:"mm"},{id:"PPD",name:"치주낭 (PPD)",value:[3,4,5,6,7,8,9,10],unit:"mm"},{id:"GR",name:"치은퇴축 (GR)",value:[1,2,3,4,5],unit:"mm"},{id:"CAL",name:"치은부착소실 (CAL)",value:[3,4,5,6,7,8,9,10,11,12,13,14,15],unit:"mm",manual:!0},{id:"F",name:"치근분지부 노출 (F)",value:[1,2,3],unit:""},{id:"M",name:"동요도 (M)",value:[1,2,3],unit:""}]},{name:"치아 구조 이상",icon:eu.A,color:"text-blue-500",conditions:[{id:"FX",name:"치아파절 (FX)",subConditions:[{id:"EF",name:"에나멜 파절"},{id:"UCF",name:"치수 비노출파절"},{id:"CCF",name:"치수 노출파절"},{id:"UCRF",name:"치수 비노출 뿌리파절"},{id:"CCRF",name:"치수 노출 뿌리파절"}]},{id:"A",name:"교모/마모 (A)"},{id:"EH",name:"법랑질 형성부전 (EH)"},{id:"E/D",name:"법랑질 결손 (E/D)"},{id:"NV",name:"실활치 (NV)"},{id:"RD",name:"잔존유치 (RD)"},{id:"UC",name:"미맹출치아 (UC)"},{id:"X",name:"발치/결손치 (X)"},{id:"DT",name:"유치 (DT)"},{id:"SN",name:"과잉치 (SN)"},{id:"U",name:"미맹출치 (U)"},{id:"R",name:"회전치 (R)"},{id:"CWD",name:"총생 (CWD)"}]},{name:"기타",icon:ex.A,color:"text-green-500",conditions:[{id:"TR",name:"치아흡수성병변 (TR)",subConditions:[{id:"T1",name:"Type 1"},{id:"T2",name:"Type 2"},{id:"T3",name:"Type 3"}]},{id:"CN",name:"유착 (CN)"},{id:"RR",name:"잔존치근 (RR)",subConditions:[{id:"IRR",name:"의도적 잔존 치근"},{id:"ORR",name:"존재하던 잔존 치근"}]},{id:"DC",name:"함치성 낭종 (DC)"},{id:"ONF",name:"구비강 누공 (ONF)"},{id:"OM",name:"종양 (OM)"}]}],ep=new Map;eh.forEach(e=>{e.conditions.forEach(e=>{let t=e.name.replace(/\s\(.*\)/,"");ep.set(e.id,{name:t,isSub:!1,unit:e.unit}),e.subConditions&&e.subConditions.forEach(t=>{ep.set(t.id,{name:t.name,isSub:!0,parentId:e.id})})})});let eg=n.memo(function(e){let{patient:t,dentalData:s,onUpdate:i}=e,[r,l]=(0,n.useState)("permanent"),[c,d]=(0,n.useState)(null),[o,m]=(0,n.useState)(null),[u,x]=(0,n.useState)(!1),h=(0,n.useMemo)(()=>t&&t.species&&t.weight?em(t.species,t.weight):null,[t.species,t.weight]),p=(0,n.useMemo)(()=>h?eo.flatMap(e=>h[e.id]||[]):[],[h]),f=(0,n.useMemo)(()=>new Map(p.map(e=>[e.id,e])),[p]),y=(e,t)=>{i({...s,[e]:{...s[e]||{id:e,status:[],procedures:[],isCompleted:!1},...t}})},b=(e,t,a)=>{let n,i=s[e]||{status:[],procedures:[]},r=Array.isArray(i.status)?[...i.status]:[],l=t.value||t.subConditions||t.manual,c=[t.id];t.subConditions&&(c=[...c,...t.subConditions.map(e=>e.id)]);let u=r.filter(e=>!c.some(t=>e.startsWith(t))),x=!1;if(null!=a&&""!==a){let e;e="FX"===t.id||"RR"===t.id||"TR"===t.id?"".concat(a):"".concat(t.id).concat(a),n=r.includes(e)?u:[...u,e],m(null),x=!0}else r.some(e=>c.some(t=>e.startsWith(t)))?(n=u,m(null),x=!0):l?(n=r,m(o===t.id?null:t.id)):(n=[...u,t.id],x=!0);if("GR"===t.id||"PPD"===t.id){var h,p;let e=(null==(h=n.find(e=>e.startsWith("GR")))?void 0:h.replace("GR",""))||"",t=(null==(p=n.find(e=>e.startsWith("PPD")))?void 0:p.replace("PPD",""))||"",s=parseInt(e,10),a=parseInt(t,10);n=n.filter(e=>!e.startsWith("CAL")),isNaN(s)||isNaN(a)||n.push("CAL".concat(s+a))}let g=[...i.procedures||[]];"X"===t.id&&(g=[]),y(e,{status:n,procedures:g}),x&&d(null)},v=(e,t,a)=>{let n,l={...s},c=l[e]||{id:e,status:[],procedures:[]},o=[...c.procedures||[]],m=e=>["extraction","deciduous_extraction","forl_extraction","persistent_deciduous_extraction"].includes(e),u=m(a);if("monitoring"===t)n=o.includes("monitoring")?[]:["monitoring"];else{let e=[...o].filter(e=>"monitoring"!==e);u?n=e.includes(t)?[]:[t]:["nerve_treatment","resin_treatment","periodontal_treatment","other_surgery"].includes(a)?(n=e.filter(e=>{let t=p.find(t=>t.id===e);return!t||!m(t.category)})).includes(t)?n=n.filter(e=>e!==t):n.push(t):e.includes(t)?n=e.filter(e=>e!==t):n.push(t)}l[e]={...c,procedures:n};let h=!1;if("deciduous"===r&&("deciduous_extraction"===a||"persistent_deciduous_extraction"===a)){let t=String(Number(e)-400);if(Number(t)>=101&&411>=Number(t)){let e=l[t]||{id:t,status:[],procedures:[]},s=e.status?[...e.status]:[];s.includes("DT")||s.push("DT"),s.includes("RD")||s.push("RD"),l[t]={...e,status:s}}}let g=f.get(t);if(n.includes(t)){var j;let s=[...(null==(j=l[e])?void 0:j.status)||[]];if(u)t.startsWith("forl_")?s.includes("TR")||s.push("TR"):s.includes("PD4")||s.push("PD4"),h=!0;else if("resin_treatment"===a)s.some(e=>e.startsWith("FX"))||s.push("UCF"),h=!0;else if("periodontal_treatment"===a&&t.includes("root_planing"))s.includes("PD2")||s.push("PD2");else if("nerve_treatment"===a&&(t.startsWith("vpt_")||t.startsWith("endo_"))){let e;s.some(e=>e.startsWith("FX"))||s.push("CCF"),e=(null==g?void 0:g.isCanine)?"resin_canine":(null==g?void 0:g.isMolar)?"resin_molar":"resin_normal";let t=p.find(t=>t.id===e);t&&!n.includes(t.id)&&n.push(t.id),h=!0}else if(t.includes("gingival_tumor")){s.includes("OM")||s.push("OM");let e=p.find(e=>"biopsy"===e.id);e&&!n.includes(e.id)&&n.push(e.id),h=!0}l[e]={...l[e],status:s,procedures:n}}i(l),h&&(d(null),x(!1))},N="개"===t.species,w=ea[r][N?"dog":"cat"],C=e=>{if(!w)return"";for(let t in w)if(w[t].includes(e))return t;return""},_={incisors:"bg-blue-50",canines:"bg-green-50",premolars:"bg-orange-50",molars:"bg-purple-50"},k={incisors:"앞니 (Incisors)",canines:"송곳니 (Canine)",premolars:"소구치 (Premolars)",molars:"어금니 (Molars)"},R=e=>e&&0!==e.length?{text:e.map(e=>{var t;return(null==(t=f.get(e))?void 0:t.name)||e}).join(", "),cost:e.reduce((e,t)=>{var s;return e+((null==(s=f.get(t))?void 0:s.price)||0)},0)}:{text:"시술 선택...",cost:0},F=()=>{c&&(y(c,{status:[]}),d(null))},L=()=>{c&&(y(c,{procedures:[]}),d(null),x(!1))},W=(e,t)=>{let i=ea[r][N?"dog":"cat"],l={incisors:[],canines:[],premolars:[],molars:[]};return e.filter(e=>{let t=C(e);return t&&i[t]&&i[t].includes(e)}).forEach(e=>{let t=C(e);t&&l[t]&&l[t].push(e)}),(0,a.jsxs)(S.XI,{children:[(0,a.jsx)(S.A0,{children:(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nd,{className:"w-[90px]",children:"번호"}),(0,a.jsx)(S.nd,{children:"상태"}),(0,a.jsx)(S.nd,{children:"시술"})]})}),(0,a.jsxs)(S.BF,{children:[(0,a.jsx)(S.Hj,{className:"bg-primary hover:bg-primary",children:(0,a.jsx)(S.nA,{colSpan:3,className:"font-semibold text-center text-lg text-primary-foreground",children:t})}),Object.entries(l).map(e=>{let[t,i]=e;return i.length>0&&(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(S.Hj,{children:(0,a.jsx)(S.nA,{colSpan:3,className:(0,M.cn)("font-semibold text-muted-foreground",_[t]),children:k[t]})}),i.map(e=>(e=>{let t=s[e]||{id:e,status:[],procedures:[],isCompleted:!1},i=Array.isArray(t.status)?t.status:[],l=t.procedures,c=t.isCompleted,{text:o,cost:m}=R(l),u=null;if("permanent"===r){let t=String(Number(e)+400),a=s[t];if(a&&a.procedures){let e=p.filter(e=>["deciduous_extraction","persistent_deciduous_extraction"].includes(e.category||""));a.procedures.some(t=>e.some(e=>e.id===t))&&(u={id:t,procedure:R(a.procedures).text})}}return(0,a.jsxs)(n.Fragment,{children:[(0,a.jsxs)(S.Hj,{className:(0,M.cn)(_[C(e)],c&&"bg-green-100 hover:bg-green-200/80"),children:[(0,a.jsx)(S.nA,{className:"font-mono font-medium w-[90px]",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[l&&l.length>0&&(0,a.jsx)(T,{id:"complete-".concat(e),checked:!!c,onCheckedChange:t=>y(e,{isCompleted:!!t}),"aria-label":"수술 완료"}),(0,a.jsx)("label",{htmlFor:"complete-".concat(e),className:"cursor-pointer",children:e})]})}),(0,a.jsx)(S.nA,{children:(0,a.jsx)(g.$,{variant:"outline",className:(0,M.cn)("w-full h-auto min-h-10 justify-start text-left whitespace-normal","shadow-sm border-b-2 border-slate-300",i.length>0&&"bg-yellow-100 hover:bg-yellow-200"),onClick:()=>{d(e),x(!1)},children:i&&0!==i.length?i.map(e=>{let t=e,s="",a=e.match(/^([A-Z/]+)(.*)$/);if(a){let n=a[1];ep.has(e)&&ep.get(e).isSub?t=e:ep.has(n)&&!ep.get(n).isSub&&(t=n,s=a[2])}let n=ep.get(t);return n?n.isSub?n.name:s?"".concat(n.name,": ").concat(s).concat(n.unit||""):n.name:e}).join(", "):"상태 선택..."})}),(0,a.jsx)(S.nA,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.$,{variant:"outline",className:(0,M.cn)("flex-1 h-auto min-h-10 justify-start text-left whitespace-normal","shadow-sm border-b-2 border-slate-300",l&&l.length>0&&"bg-sky-100 hover:bg-sky-200"),onClick:()=>{d(e),x(!0)},children:o}),m>0&&(0,a.jsxs)("div",{className:"w-[90px] text-right font-mono text-sm text-muted-foreground pr-2",children:["(",m.toLocaleString(),"원)"]})]})})]}),u&&(0,a.jsxs)(S.Hj,{className:(0,M.cn)(_[C(e)],"bg-opacity-50"),children:[(0,a.jsx)(S.nA,{className:"font-mono text-muted-foreground w-[90px] text-right pr-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,a.jsx)(z.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:u.id})]})}),(0,a.jsx)(S.nA,{colSpan:2,className:"text-sm text-muted-foreground italic",children:u.procedure})]},"".concat(e,"-deciduous"))]},e)})(e))]},t)})]})]})},O=en[r],H="개"===t.species||"고양이"===t.species;return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(j.Zp,{children:(0,a.jsxs)(j.aR,{className:"flex-row justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2 text-2xl font-bold tracking-tight",children:[(0,a.jsx)(P.A,{className:"h-6 w-6 text-primary"}),"치과 차트"]}),(0,a.jsxs)(j.BT,{children:[t.name," (",N?"강아지":"고양이",") - ","permanent"===r?"영구치":"유치"]})]}),H&&(0,a.jsxs)(g.$,{type:"button",variant:"outline",onClick:()=>l("permanent"===r?"deciduous":"permanent"),children:[(0,a.jsx)(B.A,{className:"mr-2 h-4 w-4"}),"permanent"===r?"유치 차트 보기":"영구치 차트 보기"]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(j.Zp,{children:(0,a.jsxs)(j.Wu,{className:"p-0",children:[W(O.upperRight,"우측 - 상악"),(0,a.jsx)("div",{className:"my-4"}),W(O.lowerRight,"우측 - 하악")]})}),(0,a.jsx)(j.Zp,{children:(0,a.jsxs)(j.Wu,{className:"p-0",children:[W(O.upperLeft,"좌측 - 상악"),(0,a.jsx)("div",{className:"my-4"}),W(O.lowerLeft,"좌측 - 하악")]})})]}),(()=>{if(!c)return null;let e=s[c]||{id:c,status:[],procedures:[]},t=Array.isArray(e.status)?e.status:[];return(0,a.jsx)($,{open:!!c&&!u,onOpenChange:e=>{e||d(null)},children:(0,a.jsxs)(U,{className:"w-full sm:max-w-xl md:max-w-2xl lg:max-w-3xl",children:[(0,a.jsxs)(V,{className:"flex-row items-center justify-between pr-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(Y,{children:["치아 #",c," 상태 수정"]}),(0,a.jsx)(J,{children:"해당 치아의 진단 상태를 선택하거나 수정하세요."})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(g.$,{variant:"destructive",onClick:F,children:[(0,a.jsx)(E.A,{className:"mr-2"})," 모두 해제"]}),(0,a.jsx)(g.$,{onClick:()=>d(null),children:"확인"})]})]}),(0,a.jsx)(D.F,{className:"h-[calc(100vh-8rem)] pr-6",children:(0,a.jsx)("div",{className:"space-y-6 py-4",children:eh.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(e.icon,{className:(0,M.cn)("h-5 w-5",e.color)}),(0,a.jsx)("h4",{className:(0,M.cn)("font-semibold",e.color),children:e.name})]}),(0,a.jsx)(A,{}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2 pt-3 pl-2",children:e.conditions.map(e=>{var s,n;let i=[e.id];e.subConditions&&(i=[...i,...e.subConditions.map(e=>e.id)]);let r=t.some(e=>i.some(t=>e.startsWith(t))),l=t.find(e=>i.some(t=>e.startsWith(t)))||"",d="";d="FX"===e.id||"RR"===e.id||"TR"===e.id?l:l.replace(new RegExp("^".concat(e.id)),"");let u="".concat(e.name);if(r&&d){let t="";if(e.subConditions){let s=e.subConditions.find(e=>e.id===d);t=s?" (".concat(s.name,")"):" (".concat(d,")")}else t=": ".concat(d).concat(e.unit||"");u+=t}return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(T,{id:"".concat(c,"-").concat(e.id),checked:r,onCheckedChange:t=>{b(c,e,t?void 0:null),t&&(e.value||e.subConditions||e.manual)&&m(o===e.id?null:e.id)}}),(0,a.jsx)("label",{htmlFor:"".concat(c,"-").concat(e.id),className:"flex-1 text-sm font-medium cursor-pointer",onClick:t=>{(e.value||e.subConditions||e.manual)&&m(o===e.id?null:e.id)},children:u})]}),o===e.id&&(e.value||e.subConditions||e.manual)&&(0,a.jsxs)("div",{className:"pl-6 space-y-2",children:[e.manual&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(I.p,{type:"number",placeholder:"직접 입력",className:"h-8 text-sm max-w-24",defaultValue:d,onBlur:t=>b(c,e,t.target.value)}),(0,a.jsx)("span",{children:e.unit})]}),(0,a.jsxs)("div",{className:(0,M.cn)("flex flex-wrap gap-1 mt-1",e.subConditions&&"flex-col items-start"),children:[null==(s=e.value)?void 0:s.map(t=>(0,a.jsxs)(g.$,{variant:d===String(t)?"default":"outline",size:"sm",className:"h-7",onClick:()=>b(c,e,t),children:[" ",t,e.unit," "]},t)),null==(n=e.subConditions)?void 0:n.map(t=>(0,a.jsxs)(g.$,{variant:d===t.id?"default":"ghost",size:"sm",className:"h-7 justify-start w-full text-left",onClick:()=>b(c,e,t.id),children:[" ",t.name," (",t.id,") "]},t.id))]})]})]},e.id)})})]},e.name))})})]})})})(),(()=>{if(!c||!h)return null;let e=(s[c]||{id:c,status:[],procedures:[]}).procedures||[],n="개"===t.species?"dog":"cat",i=el[n],{isCanine:l,isMolar:o,isPremolar:m,isIncisor:j,isCarnassial:f,rootCount:y,jaw:b}=(e=>{var t;let s={isCanine:!1,isMolar:!1,isPremolar:!1,isIncisor:!1,isCarnassial:!1,rootCount:null,jaw:null},a=parseInt(e,10)>=500?ea.deciduous[n]:ea.permanent[n];return a.incisors.includes(e)&&(s.isIncisor=!0),a.canines.includes(e)&&(s.isCanine=!0),a.premolars.includes(e)&&(s.isPremolar=!0),(null==(t=a.molars)?void 0:t.includes(e))&&(s.isMolar=!0),(i.carnassial_upper&&i.carnassial_upper.includes(e)||i.carnassial_lower&&i.carnassial_lower.includes(e))&&(s.isCarnassial=!0),i["1"]&&i["1"].includes(e)?s.rootCount=1:i["2"]&&i["2"].includes(e)?s.rootCount=2:i["3"]&&i["3"].includes(e)&&(s.rootCount=3),i.upper_jaw.includes(e)&&(s.jaw="upper"),i.lower_jaw.includes(e)&&(s.jaw="lower"),s})(c),N=eo;return N="permanent"===r?eo.filter(e=>!["deciduous_extraction","persistent_deciduous_extraction"].includes(e.id)):eo.filter(e=>!!(["deciduous_extraction","persistent_deciduous_extraction"].includes(e.id)||"extraction"===e.id&&p.some(e=>"extraction"===e.category&&"monitoring"===e.id))),(0,a.jsx)($,{open:u,onOpenChange:e=>{e||(d(null),x(!1))},children:(0,a.jsxs)(U,{className:"w-full sm:max-w-2xl",children:[(0,a.jsxs)(V,{className:"flex-row items-center justify-between pr-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(Y,{children:["치아 #",c," 시술 선택"]}),(0,a.jsxs)(J,{children:["이 치아(",l?"송곳니":"",o?"어금니":"",m?"소구치":"",j?"앞니":"",f?"(열육치)":"",", 뿌리 ",y||"N/A","개, ","upper"===b?"상악":"lower"===b?"하악":"",")에 적용 가능한 시술을 선택하세요."]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(g.$,{variant:"destructive",onClick:L,children:[(0,a.jsx)(E.A,{className:"mr-2"})," 모두 해제"]}),(0,a.jsx)(g.$,{onClick:()=>{d(null),x(!1)},children:"확인"})]})]}),(0,a.jsx)(D.F,{className:"h-[calc(100vh-8rem)] pr-4",children:(0,a.jsx)("div",{className:"space-y-4 py-4",children:N.map(t=>{let s=(h[t.id]||[]).filter(e=>{if("deciduous"===r)return"extraction"===t.id&&"monitoring"===e.id||("deciduous_extraction"===t.id?l?e.isCanine:!e.isCanine:"persistent_deciduous_extraction"===t.id&&(void 0===e.isCanine||e.isCanine===l)&&(void 0===e.rootCount||e.rootCount===y));return(void 0===e.isCanine||e.isCanine===l)&&(void 0===e.isMolar||e.isMolar===o)&&(void 0===e.rootCount||e.rootCount===y)&&("carnassial"!==e.toothType||!!f)&&("incisor"!==e.toothType||!!j)&&(void 0===e.jaw||e.jaw===b)&&!0});return("deciduous"!==r||"deciduous_extraction"!==t.id||l||(s=s.filter(e=>"dec_ext_gingival"===e.id)),0===s.length)?null:(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2 text-base text-primary",children:t.name}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:s.map(s=>(0,a.jsxs)("div",{className:(0,M.cn)("flex items-center space-x-3 rounded-md border p-3 cursor-pointer transition-colors",e.includes(s.id)?"bg-secondary border-primary":"hover:bg-muted/50"),onClick:()=>v(c,s.id,t.id),children:[(0,a.jsx)(T,{id:"".concat(c,"-").concat(s.id),checked:e.includes(s.id),onCheckedChange:()=>v(c,s.id,t.id)}),(0,a.jsxs)("label",{htmlFor:"".concat(c,"-").concat(s.id),className:"flex flex-1 justify-between items-center text-sm font-medium cursor-pointer",children:[(0,a.jsx)("span",{className:"whitespace-normal",children:s.name}),(0,a.jsxs)("span",{className:"text-xs font-mono text-muted-foreground pl-2",children:[s.price.toLocaleString(),"원"]})]})]},s.id))})]},t.id)})})})]})})})()]})});var ej=s(1834),ef=s(5282),ey=s(8127),eb=s(9592),ev=s(276),eN=s(6333);function ew(e){let{date:t,setDate:s,highlightedDays:n}=e;return(0,a.jsxs)(eN.AM,{children:[(0,a.jsx)(eN.Wv,{asChild:!0,children:(0,a.jsxs)(g.$,{variant:"outline",className:(0,M.cn)("w-full justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[(0,a.jsx)(ey.A,{className:"mr-2 h-4 w-4"}),t?(0,ef.GP)(t,"PPP",{locale:eb.ko}):(0,a.jsx)("span",{children:"날짜를 선택하세요"})]})}),(0,a.jsx)(eN.hl,{className:"w-auto p-0",children:(0,a.jsx)(ev.V,{mode:"single",selected:t,onSelect:s,initialFocus:!0,locale:eb.ko,modifiers:{highlighted:n||[]},modifiersStyles:{highlighted:{backgroundColor:"hsl(var(--primary) / 0.2)"}}})})]})}var eC=s(6444),e_=s(9056),ek=s(9484);let eS=n.forwardRef((e,t)=>{let{className:s,value:n,...i}=e;return(0,a.jsx)(ek.bL,{ref:t,className:(0,M.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...i,children:(0,a.jsx)(ek.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});eS.displayName=ek.bL.displayName;let eD=(0,O.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eR=n.forwardRef((e,t)=>{let{className:s,variant:n,...i}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:(0,M.cn)(eD({variant:n}),s),...i})});eR.displayName="Alert";let eM=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h5",{ref:t,className:(0,M.cn)("mb-1 font-medium leading-none tracking-tight",s),...n})});eM.displayName="AlertTitle";let eA=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,M.cn)("text-sm [&_p]:leading-relaxed",s),...n})});eA.displayName="AlertDescription";var eF=s(406),eL=s(9915),eT=s(8053);function eI(e){let{open:t,onOpenChange:s,sodalimeRecord:i}=e,[r,l]=(0,n.useState)(new Date),[c,o]=(0,n.useState)(""),[m,u]=(0,n.useState)(!1),{toast:h}=(0,k.dj)();(0,n.useEffect)(()=>{if(t&&r&&(null==i?void 0:i.usage)){let e=(0,ef.GP)(r,"yyyy-MM-dd");o(String(i.usage[e]||""))}else t&&o("")},[t,r,i]);let p=async()=>{if(!r)return void h({title:"오류",description:"날짜를 선택해주세요.",variant:"destructive"});let e=""===c?0:parseInt(c,10);if(isNaN(e)||e<0)return void h({title:"오류",description:"유효한 시간을 입력해주세요 (0 이상의 숫자).",variant:"destructive"});u(!0);try{let t=(0,d.H9)(x.db,"settings","sodalime"),s=(0,ef.GP)(r,"yyyy-MM-dd");await (0,d.c4)(x.db,async a=>{let n=await a.get(t),i=n.exists()?n.data():{totalMinutes:0,usage:{}},r=i.usage[s]||0,l=e-r,c=(i.totalMinutes||0)+l,d={...i.usage};0===e?delete d[s]:d[s]=e,a.set(t,{totalMinutes:c,usage:d},{merge:!0})}),h({title:"성공",description:"".concat(s,"의 사용 시간이 ").concat(e,"분으로 저장되었습니다.")}),o(String(e))}catch(e){console.error("Error updating sodalime record: ",e),h({title:"오류",description:"소다라임 기록 업데이트 중 오류가 발생했습니다.",variant:"destructive"})}finally{u(!1)}},j=async()=>{u(!0);try{let e=(0,d.H9)(x.db,"settings","sodalime");await (0,d.c4)(x.db,async t=>{let s=await t.get(e),a=s.exists()?s.data():{totalMinutes:0,usage:{}};t.set(e,{...a,totalMinutes:0,lastResetDate:d.Dc.now()})}),h({title:"성공",description:"소다라임 누적 사용 시간이 초기화되었습니다. 기존 기록은 보존됩니다."}),s(!1)}catch(e){console.error("Error resetting sodalime record: ",e),h({title:"오류",description:"초기화 중 오류가 발생했습니다.",variant:"destructive"})}finally{u(!1)}},f=(null==i?void 0:i.totalMinutes)||0,y=Math.min(f/900*100,100),b=Math.max(900-f,0),v=null,N="";f>=900?(v={title:"위험",description:"사용 시간 15시간 초과, 즉시 교체 필요.",variant:"destructive"},N="[&>div]:bg-red-500"):f>=720?(v={title:"경고",description:"사용 시간 12시간 초과, FICO2 확인 필수 및 교체 준비.",variant:"destructive",className:"bg-orange-500 border-orange-500 text-white"},N="[&>div]:bg-orange-500"):f>=600&&(v={title:"주의",description:"사용 시간 10시간 초과, FICO2 확인 권장.",variant:"default",className:"bg-yellow-400 border-yellow-400 text-yellow-900 [&>svg]:text-yellow-900"},N="[&>div]:bg-yellow-500");let w=(0,n.useMemo)(()=>(null==i?void 0:i.usage)?Object.keys(i.usage).map(e=>(0,e_.H)(e)):[],[i]),C=(0,n.useMemo)(()=>(null==i?void 0:i.usage)?Object.entries(i.usage).sort((e,t)=>{let[s]=e,[a]=t;return a.localeCompare(s)}):[],[i]);return(0,a.jsx)(ej.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(ej.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(ej.c7,{children:[(0,a.jsx)(ej.L3,{children:"소다라임 사용 시간 관리"}),(0,a.jsx)(ej.rr,{children:"수술 마취 시간을 기록하고 소다라임 교체 시기를 관리합니다."})]}),(0,a.jsxs)("div",{className:"space-y-6 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm font-medium",children:[(0,a.jsxs)("span",{children:["총 사용 시간: ",f,"분"]}),(0,a.jsxs)("span",{children:["남은 시간: ",b,"분"]})]}),(0,a.jsx)(eS,{value:y,className:(0,M.cn)(N)}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(null==i?void 0:i.lastResetDate)&&(0,a.jsxs)("span",{className:"text-blue-600 font-semibold",children:["최근 교체일: ",(0,ef.GP)(i.lastResetDate.toDate(),"yyyy-MM-dd")]}),(0,a.jsxs)("span",{children:[900,"분 기준"]})]})]}),v&&(0,a.jsxs)(eR,{variant:v.variant,className:(0,M.cn)(v.className),children:[(0,a.jsx)(eF.A,{className:"h-4 w-4"}),(0,a.jsx)(eM,{children:v.title}),(0,a.jsx)(eA,{children:v.description})]}),(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"일별 사용 시간 기록/수정"}),(0,a.jsxs)(eN.AM,{children:[(0,a.jsx)(eN.Wv,{asChild:!0,children:(0,a.jsxs)(g.$,{variant:"outline",size:"sm",disabled:0===C.length,children:[(0,a.jsx)(eL.A,{className:"mr-2 h-4 w-4"})," 누적 기록 보기"]})}),(0,a.jsxs)(eN.hl,{className:"w-80",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium leading-none",children:"사용 기록"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"최근 기록 순으로 표시됩니다."})]}),(0,a.jsx)(D.F,{className:"h-64 mt-4",children:(0,a.jsxs)(S.XI,{children:[(0,a.jsx)(S.A0,{children:(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nd,{children:"날짜"}),(0,a.jsx)(S.nd,{className:"text-right",children:"사용 시간(분)"})]})}),(0,a.jsx)(S.BF,{children:C.map(e=>{let[t,s]=e;return(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nA,{children:t}),(0,a.jsx)(S.nA,{className:"text-right",children:s})]},t)})})]})})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eC.J,{htmlFor:"manual-date",children:"날짜 선택"}),(0,a.jsx)(ew,{date:r,setDate:l,highlightedDays:w})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eC.J,{htmlFor:"manual-minutes",children:"사용 시간 (분)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(I.p,{id:"manual-minutes",type:"number",placeholder:"예: 60",value:c,onChange:e=>o(e.target.value)}),(0,a.jsx)(g.$,{onClick:p,disabled:m,children:m?"저장 중...":"저장"})]})]})]})]})]}),(0,a.jsxs)(ej.Es,{className:"sm:justify-between",children:[(0,a.jsxs)(eT.Lt,{children:[(0,a.jsx)(eT.tv,{asChild:!0,children:(0,a.jsx)(g.$,{variant:"destructive",children:"교체 완료 (기록 초기화)"})}),(0,a.jsxs)(eT.EO,{children:[(0,a.jsxs)(eT.wd,{children:[(0,a.jsx)(eT.r7,{children:"정말로 초기화하시겠습니까?"}),(0,a.jsx)(eT.$v,{children:"이 작업은 되돌릴 수 없습니다. 누적 사용 시간이 0으로 초기화되고, 교체일이 오늘로 기록됩니다. (단, 기존의 일별 사용 기록은 통계를 위해 보존됩니다.)"})]}),(0,a.jsxs)(eT.ck,{children:[(0,a.jsx)(eT.Zr,{children:"취소"}),(0,a.jsx)(eT.Rx,{onClick:j,disabled:m,children:m?"초기화 중...":"확인"})]})]})]}),(0,a.jsx)(g.$,{type:"button",variant:"secondary",onClick:()=>s(!1),children:"닫기"})]})]})})}let eP=(0,O.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ez(e){let{className:t,variant:s,...n}=e;return(0,a.jsx)("span",{className:(0,M.cn)(eP({variant:s}),t),...n})}let eE=[{name:"아목시실린",tabletSizeMg:500,species:"common",type:"antibiotic",doseRange:"11-22 mg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((20*e/500*2*t).toFixed(1),"T"),warning:{kidney:"[주의] 심각한 신부전(severe renal failure) 시 투여 간격을 24-48시간으로 연장하는 용량 조절이 필요합니다.",liver:"별도의 용량 조절은 일반적으로 필요하지 않으나, 중증 간질환 시에는 신중히 사용해야 합니다."}},{name:"독시사이클린",tabletSizeMg:100,species:"dog",type:"antibiotic",doseRange:"5-10 mg/kg",doseFrequency:"1일 1-2회",calculate:(e,t)=>"".concat((5*e/100*1*t).toFixed(1),"T"),warning:{kidney:"신장으로 거의 배설되지 않아 신부전 시에도 일반적으로 용량 조절이 필요 없습니다.",liver:"[주의] 중증 간기능 부전 시에는 용량 감량 또는 투여 간격 연장을 고려해야 합니다."}},{name:"독시사이클린",tabletSizeMg:100,species:"cat",type:"antibiotic",doseRange:"5-10 mg/kg",doseFrequency:"1일 1-2회",calculate:(e,t)=>"".concat((5*e/100*2*t).toFixed(1),"T"),warning:{kidney:"신부전 시에도 일반적으로 용량 조절이 필요 없습니다.",liver:"[주의] 중증 간기능 부전 시에는 신중히 투여해야 합니다."}},{name:"메트로니다졸",tabletSizeMg:250,species:"dog",type:"antibiotic",doseRange:"10-25 mg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((10*e/250*2*t).toFixed(1),"T"),warning:{liver:"[주의] 간에서 대사되므로, 심각한 간기능 저하 시 신경독성 위험이 있어 용량을 25-50% 감량해야 합니다.",kidney:"[주의] 심각한 신부전 시 용량 감량을 고려할 수 있습니다."}},{name:"메트로니다졸",tabletSizeMg:250,species:"cat",type:"antibiotic",doseRange:"7.5-12.5 mg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((7.5*e/250*2*t).toFixed(1),"T"),warning:{liver:"[주의] 간 질환 시 용량 감량 필수."}},{name:"세파렉신",tabletSizeMg:500,species:"common",type:"antibiotic",doseRange:"22-30 mg/kg",doseFrequency:"1일 2-3회",calculate:(e,t)=>"".concat((22*e/500*2*t).toFixed(1),"T")},{name:"엔로플록사신",tabletSizeMg:50,species:"dog",type:"antibiotic",doseRange:"5-20 mg/kg",doseFrequency:"1일 1회",calculate:(e,t)=>"".concat((5*e/50*1*t).toFixed(1),"T"),warning:{kidney:"[주의] 심각한 신기능 저하 시 용량을 25-50% 감량하는 것을 고려해야 합니다.",liver:"[주의] 심각한 간기능 저하 시 용량을 25-50% 감량하는 것을 고려해야 합니다."}},{name:"엔로플록사신",tabletSizeMg:50,species:"cat",type:"antibiotic",doseRange:"5 mg/kg",doseFrequency:"1일 1회",calculate:(e,t)=>"".concat((5*e/50*1*t).toFixed(1),"T"),warning:{kidney:"[주의] 심각한 신기능 저하 시 용량 감량을 고려해야 합니다.",liver:"[주의] 심각한 간기능 저하 시 용량을 25-50% 감량하는 것을 고려해야 합니다. 용량 초과 시 실명 위험."}},{name:"클린다마이신",tabletSizeMg:75,species:"common",type:"antibiotic",doseRange:"11-33 mg/kg/day",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((11*e/75*2*t).toFixed(1),"T"),warning:{liver:"[주의] 간 기능 저하 시 주의."}},{name:"베트로캄",tabletSizeMg:"액제",species:"common",type:"analgesic",doseRange:"첫날 0.2, 이후 0.1 mg/kg",doseFrequency:"1일 1회",calculate:(e,t)=>"".concat((Math.ceil(10*(.2*e+(t-1)*e*.1))/10).toFixed(1),"ml"),warning:{kidney:"[금기] 활동성 신장 질환, 특히 신부전이 있는 환자에게는 투여가 금기됩니다.",liver:"[주의] 활동성 간질환이 있는 경우 신중히 사용해야 하며, 간수치 모니터링이 권장됩니다."}},{name:"트라마돌",tabletSizeMg:50,species:"dog",type:"analgesic",doseRange:"2-10 mg/kg",doseFrequency:"1일 2-4회",calculate:(e,t)=>"".concat((2*e/50*2*t).toFixed(1),"T"),warning:{kidney:"[주의] 신장 질환 시 용량 조절.",liver:"[주의] 간 질환 시 용량 조절."}},{name:"트라마돌",tabletSizeMg:50,species:"cat",type:"analgesic",doseRange:"2-4 mg/kg",doseFrequency:"1일 2-3회",calculate:(e,t)=>"".concat((2*e/50*2*t).toFixed(1),"T"),warning:{kidney:"[주의] 신장 질환 시 용량 조절.",liver:"[주의] 간 질환 시 용량 조절."}},{name:"가바펜틴",tabletSizeMg:100,species:"common",type:"analgesic",doseRange:"10-30 mg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((10*e/100*2*t).toFixed(1),"T"),warning:{kidney:"[주의] 신부전 시 배설 지연. 용량 감량 및 투여 간격 연장 필수."}},{name:"아세트아미노펜",tabletSizeMg:500,species:"dog",type:"analgesic",doseRange:"15 mg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((15*e/500*2*t).toFixed(1),"T"),warning:{kidney:"[주의] 신독성 가능성, 신중 사용.",liver:"[금기] 간독성으로 간질환 시 투여 금기."}},{name:"마로피탄트(세레니아)",tabletSizeMg:16,species:"dog",type:"gi",doseRange:"2 mg/kg",doseFrequency:"1일 1회",calculate:(e,t)=>"".concat((2*e/16*1*t).toFixed(1),"T"),warning:{liver:"[주의] 중증 간 질환 시 용량 조절."}},{name:"마로피탄트(세레니아)",tabletSizeMg:16,species:"cat",type:"gi",doseRange:"1 mg/kg",doseFrequency:"1일 1회",calculate:(e,t)=>"".concat((e/16*1*t).toFixed(1),"T"),warning:{liver:"[주의] 중증 간 질환 시 용량 조절."}},{name:"파모티딘",tabletSizeMg:20,species:"common",type:"gi",doseRange:"0.7-2 mg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((.7*e/20*2*t).toFixed(1),"T"),warning:{kidney:"[주의] 중등도 이상 신부전 시 용량 50% 감량 또는 간격 연장."}},{name:"미소프로스톨",tabletSizeMg:200,species:"common",type:"gi",doseRange:"3-5 mcg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((3*e/200*2*t).toFixed(1),"T")},{name:"알마겔",tabletSizeMg:500,species:"common",type:"gi",doseRange:"10-20 mg/kg",doseFrequency:"1일 2회",calculate:(e,t)=>"".concat((10*e/500*2*t).toFixed(1),"T")},{name:"우루사(UDCA)",tabletSizeMg:200,species:"common",type:"liver_support",doseRange:"10-15 mg/kg",doseFrequency:"1일 1-2회",calculate:(e,t)=>"".concat((10*e/200*1*t).toFixed(1),"T"),warning:{liver:"[금기] 담도 완전 폐색 시 금기."}},{name:"실리마린",tabletSizeMg:100,species:"common",type:"liver_support",doseRange:"20-50 mg/kg",doseFrequency:"1일 1회",calculate:(e,t)=>"".concat((20*e/100*1*t).toFixed(1),"T")},{name:"사메탑(SAMe)",tabletSizeMg:200,species:"common",type:"liver_support",doseRange:"2.5kg당 1/4T",doseFrequency:"1일 1회",calculate:(e,t)=>{if(e<=0)return"0T";let s=.25*Math.ceil(e/2.5),a=s*t,n=s<1?"".concat(s.toFixed(2).replace("0.",".")):"".concat(s);return"".concat(a.toFixed(2),"T (").concat(n,"T/day)")}},{name:"이트라코나졸",tabletSizeMg:100,species:"common",type:"antifungal",doseRange:"5-10 mg/kg",doseFrequency:"1일 1-2회",calculate:(e,t)=>"".concat((5*e/100*1*t).toFixed(1),"T"),warning:{liver:"[주의] 간독성 위험, 모니터링 필요."}}],eB={antibiotic:"항생제",analgesic:"진통소염제",gi:"위장관계 약물",liver_support:"간 보호제",antifungal:"항진균제",other:"기타"},eW=n.memo(e=>{let{selectedMeds:t,onSelectedMedsChange:s}=e,{watch:i}=(0,o.xW)(),{species:r,hasLiverCondition:l,hasKidneyCondition:c,weight:d}=i();(0,n.useEffect)(()=>{if(!r)return;let e="개"===r?"dog":"cat",a=eE.filter(t=>t.species===e||"common"===t.species).map(e=>e.name),n=[];n="dog"===e?["베트로캄","아세트아미노펜","미소프로스톨","가바펜틴","아목시실린","알마겔","파모티딘","마로피탄트(세레니아)"]:["베트로캄","트라마돌","미소프로스톨","가바펜틴","아목시실린","알마겔","파모티딘","마로피탄트(세레니아)"],l&&n.push("우루사(UDCA)","실리마린","사메탑(SAMe)");let i=n.filter(e=>a.includes(e));if(0===t.length)s(Array.from(new Set(i)));else{let e=[...t],a=!1;l&&["우루사(UDCA)","실리마린","사메탑(SAMe)"].forEach(t=>{e.includes(t)||(e.push(t),a=!0)}),a&&s(e)}},[r,l,s,t]);let m=eE.filter(e=>e.species===("개"===r?"dog":"cat")||"common"===e.species),u=e=>{var t,s;let a=c&&(null==(t=e.warning)?void 0:t.kidney),n=l&&(null==(s=e.warning)?void 0:s.liver),i=a&&a.includes("[금기]")||n&&n.includes("[금기]"),r=!i&&(a&&a.includes("[주의]")||n&&n.includes("[주의]")),d=!i&&!r&&(a||n),o="",m=null;return i?(o="text-red-600",m=a||n):r?(o="text-green-600",m=a||n):d&&(o="text-blue-600",m=a||n),{kidneyWarning:a,liverWarning:n,isContraindicated:i,isCaution:r,isSafe:d,colorClass:o,description:m}},x=(e,s)=>{let n=[];3===e?n="개"===r?["베트로캄","아세트아미노펜","미소프로스톨","마로피탄트(세레니아)"]:["베트로캄","트라마돌","미소프로스톨","마로피탄트(세레니아)"]:(n=["가바펜틴","아목시실린","알마겔","파모티딘"],l&&n.push("우루사(UDCA)","실리마린","사메탑(SAMe)"));let i=m.filter(e=>t.includes(e.name)&&n.includes(e.name));return(0,a.jsxs)(j.Zp,{className:"bg-blue-50/30 flex-1",children:[(0,a.jsx)(j.aR,{children:(0,a.jsx)(j.ZB,{className:"text-lg",children:s})}),(0,a.jsx)(j.Wu,{className:"space-y-4",children:i.length>0?i.map(t=>{let s=u(t);return(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:(0,M.cn)("font-medium",s.colorClass),children:[(0,a.jsx)("p",{children:t.name}),s.description&&(0,a.jsx)("p",{className:"text-xs font-normal max-w-xs",children:s.description})]}),(0,a.jsx)(ez,{variant:"secondary",className:"text-base font-mono whitespace-nowrap",children:((e,t)=>{if(!d||d<=0)return"체중 입력 필요";try{return e.calculate(d,t)}catch(e){return"계산 오류"}})(t,e)})]},"".concat(t.name,"-").concat(e))}):(0,a.jsx)("p",{className:"text-muted-foreground",children:"선택된 약물이 없습니다."})})]})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-row items-center justify-between hidden md:flex",children:[(0,a.jsx)("div",{}),(0,a.jsxs)($,{children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsxs)(g.$,{variant:"outline",children:[(0,a.jsx)(w.A,{className:"mr-2"}),"약물 보드"]})}),(0,a.jsxs)(U,{className:"w-full sm:max-w-3xl",children:[(0,a.jsx)(V,{children:(0,a.jsx)(Y,{children:"약물 보드"})}),(0,a.jsx)(D.F,{className:"h-[calc(100vh-8rem)] pr-6 py-4",children:Object.keys(eB).map(e=>{let n=m.filter(t=>t.type===e);return 0===n.length?null:(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"font-bold text-lg capitalize mb-2",children:eB[e]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:n.map(e=>((e,n)=>{let i=u(e),r="border-transparent";return n&&(r=i.isContraindicated?"border-red-500":i.isCaution?"border-green-500":i.isSafe?"border-blue-500":"border-primary"),(0,a.jsxs)(j.Zp,{className:(0,M.cn)("cursor-pointer transition-all flex flex-col justify-between",n?"shadow-md":"shadow-sm",r,"border-2"),onClick:()=>(e=>{s(t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e.name),children:[(0,a.jsx)(j.aR,{className:"p-4 pb-2",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)(j.ZB,{className:"text-base",children:e.name}),(0,a.jsx)(T,{checked:n,className:"mt-1"})]})}),(0,a.jsxs)(j.Wu,{className:"p-4 pt-0 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("p",{children:["용량: ",e.doseRange]}),(0,a.jsxs)("p",{children:["횟수: ",e.doseFrequency]}),i.description&&(0,a.jsx)("p",{className:(0,M.cn)("mt-1 text-xs font-bold",i.colorClass),children:i.description})]})]},"".concat(e.name,"-").concat(e.species))})(e,t.includes(e.name)))})]},e)})})]})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[x(3,"3일분 조제 요약"),x(7,"7일분 조제 요약")]})})]})});var eO=s(6083),eH=s(9007);let e$=eO.bL,eZ=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(eO.q7,{ref:t,className:(0,M.cn)("border-b",s),...n})});eZ.displayName="AccordionItem";let eG=n.forwardRef((e,t)=>{let{className:s,children:n,...i}=e;return(0,a.jsx)(eO.Y9,{className:"flex",children:(0,a.jsxs)(eO.l9,{ref:t,className:(0,M.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...i,children:[n,(0,a.jsx)(eH.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});eG.displayName=eO.l9.displayName;let eK=n.forwardRef((e,t)=>{let{className:s,children:n,...i}=e;return(0,a.jsx)(eO.UC,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:(0,a.jsx)("div",{className:(0,M.cn)("pb-4 pt-0",s),children:n})})});eK.displayName=eO.UC.displayName;var eq=s(6803),eU=s(6874),eV=s(6867),eX=s(9338),eY=s(8595),eJ=s(9354),eQ=s(984);let e0={additionalAnesthesiaDrugs:(0,a.jsx)(eq.A,{className:"h-5 w-5"}),anesthesia:(0,a.jsx)(eU.A,{className:"h-5 w-5"}),pain:(0,a.jsx)(eV.A,{className:"h-5 w-5"}),recovery:(0,a.jsx)(eX.A,{className:"h-5 w-5"}),homeCare:(0,a.jsx)(eY.A,{className:"h-5 w-5"})},e1=n.memo(e=>{let{patient:t,selectedTreatments:s,onTreatmentsChange:i,setCosts:r}=e,{watch:l}=(0,o.xW)(),[c,d]=n.useState(null),[m,u]=n.useState([]),x=n.useRef(!1),h=l("species"),p=l("weight"),f=n.useMemo(()=>h&&p?es({...t,species:h,weight:p}):{},[t,h,p]);n.useEffect(()=>{if(x.current||!f.categories||!h||s.length>0)return;let e=[];if("개"===h){let t=Object.values(f.itemsByCategoryId||{}).flat();[{id:"narcotic_injection"},{id:"sustained_analgesia"},{id:"pain_control_pump"},{id:"antibiotic_injection"},{id:"laser_therapy",optionKey:"local"},{id:"oral_meds",optionKey:"7d"},{id:"capsule",optionKey:"7d"},{id:"liquid_analgesic",optionKey:"3d"}].forEach(s=>{let a=t.find(e=>e.id===s.id);if(!a)return;let n=s.optionKey?a.options.find(e=>e.key===s.optionKey):a.options[0];n&&e.push({id:a.id,optionKey:n.key,price:n.price,name:"".concat(a.name).concat(n.label?": ".concat(n.label):"")})})}else if("고양이"===h){let t=Object.values(f.itemsByCategoryId||{}).flat();[{id:"anesthesia_extension",optionKey:"60min"},{id:"local_anesthesia",optionKey:"2_sites"},{id:"narcotic_injection"},{id:"sustained_analgesia"},{id:"pain_control_pump"},{id:"narcotic_patch",optionKey:"5ug"},{id:"antibiotic_injection"},{id:"laser_therapy",optionKey:"local"},{id:"oral_meds",optionKey:"7d"},{id:"capsule",optionKey:"7d"},{id:"liquid_analgesic",optionKey:"3d"},{id:"hexidine_spray"},{id:"oral_ointment"}].forEach(s=>{let a=t.find(e=>e.id===s.id);if(!a)return;let n=s.optionKey?a.options.find(e=>e.key===s.optionKey):a.options[0];n&&e.push({id:a.id,optionKey:n.key,price:n.price,name:"".concat(a.name).concat(n.label?": ".concat(n.label):"")})})}e.length>0&&(i(e),x.current=!0)},[f,h,s,i]),n.useEffect(()=>{c&&u(s)},[c,s]),n.useEffect(()=>{let e=s.reduce((e,t)=>e+(t.price||0),0);r(t=>({...t,additional:e}))},[s,r]);let y=()=>{d(null)},b=()=>{i(m),y()},v=(e,t)=>{u(s=>{let a;if(s.some(s=>s.id===e.id&&s.optionKey===t.key))a=s.filter(s=>s.id!==e.id||s.optionKey!==t.key);else{let n={id:e.id,optionKey:t.key,price:t.price,name:"".concat(e.name).concat(t.label?": ".concat(t.label):"")};e.isMultiSelect?a=[...s,n]:(a=s.filter(t=>t.id!==e.id)).push(n)}return a})},N=(e,t)=>{let s=e.options.find(e=>e.key===t),a=m.filter(t=>t.id!==e.id);if(s){let t={id:e.id,optionKey:s.key,price:s.price,name:"".concat(e.name).concat(s.label?": ".concat(s.label):"")};a.push(t)}u(a)};return f.categories?(0,a.jsx)(eZ,{value:"item-10",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsx)(j.ZB,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eJ.A,{}),"추가 처치 항목"]})})}),(0,a.jsxs)(eK,{className:"p-6 pt-0",children:[(0,a.jsx)(j.BT,{className:"mb-4",children:"각 항목을 클릭하여 세부 처치를 선택하세요."}),(0,a.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4",children:[f.categories.map(e=>{let t=f.itemsByCategoryId[e.id],i=s.filter(e=>null==t?void 0:t.some(t=>t.id===e.id)),r=i.length>0;return(0,a.jsxs)(j.Zp,{className:(0,M.cn)("flex flex-col cursor-pointer transition-all",r?"border-primary shadow-lg":"hover:shadow-md"),onClick:()=>{d(e.id)},children:[(0,a.jsxs)("div",{className:(0,M.cn)("flex-grow flex flex-col items-center justify-center p-4 gap-2 rounded-t-lg",r?"bg-primary/10":""),children:[(0,a.jsxs)("div",{className:(0,M.cn)("flex items-center gap-2 text-lg font-semibold",r?"text-primary":"text-card-foreground"),children:[n.cloneElement(e0[e.id],{className:"h-6 w-6"}),(0,a.jsx)("span",{children:e.name})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:r?"".concat(i.length,"개 항목 선택됨"):e.description})]}),r&&(0,a.jsx)("div",{className:"p-3 border-t border-primary/20 bg-primary/5 space-y-1.5",children:i.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2 text-xs text-primary font-medium",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eQ.A,{className:"h-3 w-3 flex-shrink-0"}),(0,a.jsx)("p",{className:"truncate",children:e.name})]}),(0,a.jsx)("span",{className:"font-mono whitespace-nowrap",children:e.price>0?"(".concat(e.price.toLocaleString(),"원)"):""})]},e.id+e.optionKey))})]},e.id)}),(()=>{if(!c||!f.categories)return null;let e=f.categories.find(e=>e.id===c),t=f.itemsByCategoryId[c];if(!e||!t)return null;if("homeCare"===e.id){let s=t.find(e=>"oral_meds"===e.id),n=t.find(e=>"liquid_analgesic"===e.id),i=t.find(e=>"capsule"===e.id),r=t.filter(e=>!["oral_meds","liquid_analgesic","capsule"].includes(e.id)),l=m.find(e=>"oral_meds"===e.id),d=m.find(e=>"liquid_analgesic"===e.id),o=m.find(e=>"capsule"===e.id);return(0,a.jsx)($,{open:!!c,onOpenChange:e=>!e&&y(),children:(0,a.jsxs)(U,{className:"w-full sm:max-w-xl",children:[(0,a.jsxs)(V,{children:[(0,a.jsxs)(Y,{className:"flex items-center gap-2",children:[e0[e.id]," ",e.name]}),(0,a.jsx)(J,{children:e.description})]}),(0,a.jsx)(g.$,{onClick:b,className:"my-4 w-full",children:"확인"}),(0,a.jsx)(D.F,{className:"h-[calc(100vh-14rem)] pr-4",children:(0,a.jsxs)("div",{className:"space-y-6",children:[s&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm",children:s.name}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[s.options.map(e=>(0,a.jsx)(g.$,{variant:(null==l?void 0:l.optionKey)===e.key?"secondary":"outline",className:(0,M.cn)("text-xs",(null==l?void 0:l.optionKey)===e.key&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>N(s,e.key),children:e.label},e.key)),(0,a.jsx)(g.$,{variant:l?"outline":"secondary",className:(0,M.cn)("text-xs col-span-1",!l&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>N(s,""),children:"선택안함"})]})]}),i&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm",children:i.name}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[i.options.map(e=>(0,a.jsx)(g.$,{variant:(null==o?void 0:o.optionKey)===e.key?"secondary":"outline",className:(0,M.cn)("text-xs",(null==o?void 0:o.optionKey)===e.key&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>N(i,e.key),children:e.label},e.key)),(0,a.jsx)(g.$,{variant:o?"outline":"secondary",className:(0,M.cn)("text-xs",!o&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>N(i,""),children:"선택안함"})]})]}),n&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm",children:n.name}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[n.options.map(e=>(0,a.jsx)(g.$,{variant:(null==d?void 0:d.optionKey)===e.key?"secondary":"outline",className:(0,M.cn)("h-auto text-xs whitespace-normal",(null==d?void 0:d.optionKey)===e.key&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>N(n,e.key),children:e.label},e.key)),(0,a.jsx)(g.$,{variant:d?"outline":"secondary",className:(0,M.cn)("text-xs",!d&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>N(n,""),children:"선택안함"})]})]}),r.map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm",children:e.name}),(0,a.jsx)("div",{className:(0,M.cn)("grid gap-2",e.isMultiSelect?"grid-cols-1":"grid-cols-2"),children:e.options.map(t=>{let s=m.some(s=>s.id===e.id&&s.optionKey===t.key);return(0,a.jsxs)(g.$,{variant:s?"secondary":"outline",className:(0,M.cn)("w-full justify-between h-auto py-2 text-left",s&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>v(e,t),children:[(0,a.jsx)("span",{className:"text-sm whitespace-normal",children:t.label}),(0,a.jsxs)("span",{className:"text-sm font-mono whitespace-nowrap pl-2",children:["(+",t.price.toLocaleString(),"원)"]})]},t.key)})})]},e.id))]})}),(0,a.jsx)(X,{className:"mt-4",children:(0,a.jsx)(g.$,{onClick:b,className:"w-full",children:"확인"})})]})})}return(0,a.jsx)($,{open:!!c,onOpenChange:e=>!e&&y(),children:(0,a.jsxs)(U,{className:"w-full sm:max-w-xl",children:[(0,a.jsxs)(V,{children:[(0,a.jsxs)(Y,{className:"flex items-center gap-2",children:[e0[e.id]," ",e.name]}),(0,a.jsx)(J,{children:e.description})]}),(0,a.jsx)(g.$,{onClick:b,className:"my-4 w-full",children:"확인"}),(0,a.jsx)(D.F,{className:"h-[calc(100vh-14rem)] pr-4",children:(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm",children:e.name}),(0,a.jsx)("div",{className:(0,M.cn)("grid gap-2",e.isMultiSelect?"grid-cols-1":"grid-cols-2"),children:e.options.map(t=>{let s=m.some(s=>s.id===e.id&&s.optionKey===t.key);return(0,a.jsxs)(g.$,{variant:s?"secondary":"outline",className:(0,M.cn)("w-full justify-between h-auto py-2 text-left",s&&"bg-yellow-100 hover:bg-yellow-200 border-yellow-300"),onClick:()=>v(e,t),children:[(0,a.jsx)("span",{className:"text-sm whitespace-normal",children:t.label}),(0,a.jsxs)("span",{className:"text-sm font-mono whitespace-nowrap pl-2",children:["(+",t.price.toLocaleString(),"원)"]})]},t.key)})})]},e.id))})}),(0,a.jsx)(X,{className:"mt-4",children:(0,a.jsx)(g.$,{onClick:b,className:"w-full",children:"확인"})})]})})})()]})]})]})}):(0,a.jsx)(eZ,{value:"item-10",children:(0,a.jsx)(j.Zp,{children:(0,a.jsx)(j.Wu,{className:"pt-6",children:(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"환자 정보 (종, 체중)를 먼저 입력해주세요."})})})})});var e2=s(1052),e4=s(1218),e3=s(1136),e5=s(1222),e6=s(4995);let e8=n.memo(()=>{let{control:e,watch:t}=(0,o.xW)(),[s,i]=n.useState(!1),[r,l]=n.useState(!1),{birthDate:c}=t(),d=n.useMemo(()=>{if(!c)return{display:"정보 없음"};let e=new Date,t=(0,e5.V)(e,c),s=(0,e6.W)(e,c)%12;return{display:"".concat(t,"세 ").concat(s,"개월")}},[c]);return(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(j.aR,{children:(0,a.jsx)(j.ZB,{children:"환자 정보"})}),(0,a.jsx)(j.Wu,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(e2.zB,{control:e,name:"guardianName",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"보호자 이름"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(I.p,{...t,value:t.value||"",readOnly:!0})}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"guardianPhone",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"보호자 연락처"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(I.p,{...t,value:t.value||"",readOnly:!0})}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"chartId",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"차트 번호"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(I.p,{...t,value:t.value||"",readOnly:!0})}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"name",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"이름"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(I.p,{...t,value:t.value||""})}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"species",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"종"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(g.$,{type:"button",variant:"개"===t.value?"secondary":"outline",className:(0,M.cn)("flex-1 h-14 text-xl","개"===t.value&&"shadow-md border-2 border-yellow-400 bg-yellow-100 text-yellow-800 hover:bg-yellow-200"),onClick:()=>t.onChange("개"),children:[(0,a.jsx)(e4.w,{className:"h-8 w-8 mr-2"})," 개"]}),(0,a.jsxs)(g.$,{type:"button",variant:"고양이"===t.value?"secondary":"outline",className:(0,M.cn)("flex-1 h-14 text-xl","고양이"===t.value&&"shadow-md border-2 border-yellow-400 bg-yellow-100 text-yellow-800 hover:bg-yellow-200"),onClick:()=>t.onChange("고양이"),children:[(0,a.jsx)(e3.k,{className:"h-8 w-8 mr-2"})," 고양이"]})]})}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"breed",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"품종"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(I.p,{...t,value:t.value||"",readOnly:!0})}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"birthDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{className:"flex flex-col",children:[(0,a.jsx)(e2.lR,{children:"생년월일 / 나이"}),(0,a.jsxs)(eN.AM,{open:s,onOpenChange:i,children:[(0,a.jsx)(eN.Wv,{asChild:!0,children:(0,a.jsx)(e2.MJ,{children:(0,a.jsxs)(g.$,{type:"button",variant:"outline",className:(0,M.cn)("w-full justify-start text-left font-normal",!t.value&&"text-muted-foreground"),children:[(0,a.jsx)(ey.A,{className:"mr-2 h-4 w-4"}),t.value?(0,ef.GP)(t.value,"PPP",{locale:eb.ko}):(0,a.jsx)("span",{children:"날짜 선택"})]})})}),(0,a.jsx)(eN.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(ev.V,{locale:eb.ko,mode:"single",selected:t.value,onSelect:e=>{t.onChange(e),i(!1)},disabled:e=>e>new Date||e<new Date(new Date().setFullYear(new Date().getFullYear()-25)),initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-25,toYear:new Date().getFullYear()})})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 pt-1 text-sm text-muted-foreground",children:d.display}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"surgeryDate",render:e=>{var t;let{field:s}=e;return(0,a.jsxs)(e2.eI,{className:"flex flex-col",children:[(0,a.jsx)(e2.lR,{children:"수술일"}),(0,a.jsxs)(eN.AM,{open:r,onOpenChange:l,children:[(0,a.jsx)(eN.Wv,{asChild:!0,children:(0,a.jsx)(e2.MJ,{children:(0,a.jsxs)(g.$,{type:"button",variant:"outline",className:(0,M.cn)("w-full justify-start text-left font-normal",!s.value&&"text-muted-foreground"),children:[(0,a.jsx)(ey.A,{className:"mr-2 h-4 w-4"}),s.value?(0,ef.GP)(s.value,"PPP",{locale:eb.ko}):(0,a.jsx)("span",{children:"날짜 선택"})]})})}),(0,a.jsx)(eN.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(ev.V,{locale:eb.ko,mode:"single",selected:null!=(t=s.value)?t:void 0,onSelect:e=>{s.onChange(e),l(!1)},initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-25,toYear:new Date().getFullYear()})})]}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"gender",render:t=>{let{field:s}=t;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"성별 / 중성화"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 h-10",children:[(0,a.jsx)(g.$,{type:"button",variant:"수컷"===s.value?"secondary":"outline",className:(0,M.cn)("flex-1 font-bold text-lg","수컷"===s.value&&"bg-blue-100 text-blue-800 border-blue-300 hover:bg-blue-200"),onClick:()=>s.onChange("수컷"),children:"♂"}),(0,a.jsx)(g.$,{type:"button",variant:"암컷"===s.value?"secondary":"outline",className:(0,M.cn)("flex-1 font-bold text-lg","암컷"===s.value&&"bg-pink-100 text-pink-800 border-pink-300 hover:bg-pink-200"),onClick:()=>s.onChange("암컷"),children:"♀"}),(0,a.jsx)(e2.zB,{control:e,name:"isNeutered",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{className:"flex items-center gap-2 space-y-0",children:[(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(T,{checked:t.value,onCheckedChange:t.onChange})}),(0,a.jsx)(e2.lR,{children:"중성화"})]})}})]}),(0,a.jsx)(e2.C5,{})]})}}),(0,a.jsx)(e2.zB,{control:e,name:"weight",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"몸무게 (kg)"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(I.p,{type:"number",step:"0.1",...t,value:t.value||0,onFocus:e=>{"0"===e.target.value&&(e.target.value="")},onBlur:e=>{""===e.target.value&&(e.target.value="0")}})}),(0,a.jsx)(e2.C5,{})]})}})]})})]})});var e7=s(9997),e9=s(8457),te=s(1851),tt=s(2111),ts=s(7600),ta=s(3381),tn=s(2593);function ti(e){let{date:t,setDate:s}=e,[i,r]=n.useState(!1),l=(e,a)=>{let n=t?new Date(t):new Date;n.setHours(e,a,0,0),s(n)},c=t?12>t.getHours()?"AM":"PM":"AM",d=t&&t.getHours()%12||12,o=t?t.getMinutes():0,m=e=>{if(!t)return;let s=t.getHours();"AM"===e&&s>=12?l(s-12,o):"PM"===e&&s<12&&l(s+12,o)};return(0,a.jsxs)(eN.AM,{open:i,onOpenChange:r,children:[(0,a.jsx)(eN.Wv,{asChild:!0,children:(0,a.jsxs)(g.$,{variant:"outline",className:(0,M.cn)("w-full justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[(0,a.jsx)(tn.A,{className:"mr-2 h-4 w-4"}),t?(0,ef.GP)(t,"hh:mm a"):(0,a.jsx)("span",{children:"시간 선택"})]})}),(0,a.jsx)(eN.hl,{className:"w-auto p-0",children:(0,a.jsxs)("div",{className:"p-2 space-y-2",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(g.$,{variant:"AM"===c?"secondary":"outline",onClick:()=>m("AM"),className:(0,M.cn)("AM"===c&&"bg-yellow-100 hover:bg-yellow-200 text-yellow-800"),children:"오전"}),(0,a.jsx)(g.$,{variant:"PM"===c?"secondary":"outline",onClick:()=>m("PM"),className:(0,M.cn)("PM"===c&&"bg-yellow-100 hover:bg-yellow-200 text-yellow-800"),children:"오후"})]}),(0,a.jsx)(A,{}),(0,a.jsx)("div",{className:"grid grid-cols-6 gap-1",children:Array.from({length:12},(e,t)=>t+1).map(e=>(0,a.jsx)(g.$,{size:"icon",variant:d===e?"secondary":"ghost",className:"h-8 w-8",onClick:()=>{let t;return t=e,void("PM"===c&&12!==e&&(t+=12),"AM"===c&&12===e&&(t=0),l(t,o))},children:e},"hour-".concat(e)))}),(0,a.jsx)(A,{}),(0,a.jsx)("div",{className:"grid grid-cols-6 gap-1",children:Array.from({length:6},(e,t)=>10*t).map(e=>(0,a.jsx)(g.$,{size:"icon",variant:o===e?"secondary":"ghost",className:"h-8 w-8",onClick:()=>l((null==t?void 0:t.getHours())||0,e),children:e.toString().padStart(2,"0")},"minute-".concat(e)))})]})})]})}let tr=n.memo(e=>{let{sodalimeRecord:t,setSodalimeDialogOpen:s}=e,{watch:i,setValue:r,getValues:l}=(0,o.xW)(),{toast:c}=(0,k.dj)(),[m,u]=n.useState("00:00:00"),h=n.useRef(null),p=i("surgeryStartTime"),f=i("surgeryEndTime"),y=i("anesthesiaDuration"),b=n.useMemo(()=>{let e=y||0;if(e<=0)return"0분";let t=Math.floor(e/60),s=e%60,a="";return t>0&&(a+="".concat(t,"시간 ")),(s>0||0===t)&&(a+="".concat(s,"분")),a.trim()},[y]),v=n.useCallback(()=>{h.current&&(clearInterval(h.current),h.current=null),u("00:00:00")},[]),w=n.useCallback(e=>{v(),h.current=setInterval(()=>{let t=new Date,s=(0,e7.O)(t,e),a=Math.floor(s/3600).toString().padStart(2,"0"),n=Math.floor(s%3600/60).toString().padStart(2,"0"),i=(s%60).toString().padStart(2,"0");u("".concat(a,":").concat(n,":").concat(i)),r("anesthesiaDuration",(0,e9.o)(t,e),{shouldDirty:!0})},1e3)},[r,v]);n.useEffect(()=>{let e=l("surgeryStartTime"),t=l("surgeryEndTime");return e&&!t?w(e):v(),()=>v()},[p,f,w,v,l]);let C=e=>{let t=new Date;if("start"===e)r("surgeryStartTime",t,{shouldDirty:!0}),r("surgeryEndTime",null,{shouldDirty:!0}),w(t);else if("stop"===e){let e=l("surgeryStartTime");e?(r("surgeryEndTime",t,{shouldDirty:!0}),r("anesthesiaDuration",(0,e9.o)(t,e),{shouldDirty:!0}),v()):c({title:"오류",description:"시작 시간을 먼저 기록해주세요.",variant:"destructive"})}else"reset"===e&&(r("surgeryStartTime",null,{shouldDirty:!0}),r("surgeryEndTime",null,{shouldDirty:!0}),r("anesthesiaDuration",0,{shouldDirty:!0}),v())},_=(e,t)=>{r(e,t,{shouldDirty:!0});let s=l(),a=s.surgeryStartTime,n=s.surgeryEndTime;if(a&&n){if(n<a){c({title:"경고",description:"종료 시간이 시작 시간보다 빠릅니다.",variant:"destructive"}),r("anesthesiaDuration",0,{shouldDirty:!0}),v();return}let e=(0,e9.o)(n,a);r("anesthesiaDuration",e>0?e:0,{shouldDirty:!0}),v()}else a&&n||(r("anesthesiaDuration",0,{shouldDirty:!0}),a&&!n?w(a):v())},S=async()=>{let e=l("anesthesiaDuration"),t=l("surgeryStartTime")||l("surgeryDate");if(!e||e<=0)return void c({title:"오류",description:"유효한 마취 시간이 없습니다.",variant:"destructive"});if(!t)return void c({title:"오류",description:"수술 날짜 정보가 없습니다.",variant:"destructive"});try{let s=(0,d.H9)(x.db,"settings","sodalime"),a=(0,ef.GP)(t,"yyyy-MM-dd");await (0,d.c4)(x.db,async t=>{let n=await t.get(s),i=n.exists()?n.data():{totalMinutes:0,usage:{}},r=i.usage[a]||0,l=r+e,c=l-r,d=(i.totalMinutes||0)+c,o={...i.usage,[a]:l};t.set(s,{totalMinutes:d,usage:o},{merge:!0})}),c({title:"성공",description:"".concat(a,"에 ").concat(e,"분의 소다라임 사용 시간이 추가되었습니다.")})}catch(e){console.error("Error updating sodalime record from surgery time: ",e),c({title:"오류",description:"소다라임 기록 업데이트 중 오류가 발생했습니다.",variant:"destructive"})}};return(0,a.jsx)(eZ,{value:"item-4",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(te.A,{}),"수술 관리"]})}),(0,a.jsx)(eK,{className:"p-6 pt-0",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"수술/마취 시간 기록"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(e2.lR,{children:"시작 시간"}),(0,a.jsx)(ti,{date:p,setDate:e=>_("surgeryStartTime",e)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(e2.lR,{children:"종료 시간"}),(0,a.jsx)(ti,{date:f,setDate:e=>_("surgeryEndTime",e)})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsxs)("div",{className:"text-lg font-bold",children:["총 마취: ",(0,a.jsx)("span",{className:"font-mono text-primary",children:b}),h.current&&(0,a.jsxs)("span",{className:"ml-2 text-sm font-mono text-muted-foreground tabular-nums",children:["(",m,")"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center md:justify-end gap-2",children:[(0,a.jsx)(g.$,{type:"button",size:"icon",variant:"outline",onClick:()=>C("start"),children:(0,a.jsx)(tt.A,{className:"text-green-600"})}),(0,a.jsx)(g.$,{type:"button",size:"icon",variant:"outline",onClick:()=>C("stop"),children:(0,a.jsx)(ts.A,{className:"text-red-600"})}),(0,a.jsx)(g.$,{type:"button",size:"icon",variant:"outline",onClick:()=>C("reset"),children:(0,a.jsx)(ta.A,{})})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:y>0&&p&&f&&(0,a.jsxs)(g.$,{type:"button",onClick:S,children:[(0,a.jsx)(eL.A,{className:"mr-2"}),"소다라임 사용 시간에 추가"]})})]}),(0,a.jsxs)("div",{className:"mt-6 border-t pt-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"소다라임 관리"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["누적 사용 시간: ",(null==t?void 0:t.totalMinutes)||0," 분",t&&t.totalMinutes>=720&&(0,a.jsx)(ez,{variant:"destructive",className:"ml-2",children:"FICO2 확인 요망"})]}),(0,a.jsxs)(g.$,{type:"button",onClick:()=>s(!0),className:(0,M.cn)(t&&t.totalMinutes>=720&&"bg-yellow-500 hover:bg-yellow-600"),children:[(0,a.jsx)(N.A,{className:"mr-2"})," 소다라임 관리"]})]})]})]})})]})})});var tl=s(8770);let tc=n.memo(()=>{let{watch:e}=(0,o.xW)(),t=e("species"),s=e("weight"),i=n.useMemo(()=>{if(!t||!s||s<=0)return{type:"정보 부족",recipe:"",rate:""};if("개"===t){let e=(.58*s).toFixed(2),t=(2.9*s).toFixed(2);return{type:"도부타민 CRI",recipe:"도부타민 1.7mL + N/S 98.3mL",rate:"".concat(e," ~ ").concat(t," mL/hr")}}{let e=(.3*s).toFixed(2),t=(3*s).toFixed(2);return{type:"노르에피네프린 CRI",recipe:"노르에피네프린 1.0mL + N/S 99.0mL",rate:"".concat(e," ~ ").concat(t," mL/hr")}}},[t,s]),r=n.useMemo(()=>t&&s&&!(s<=0)?"개"===t?{title:"강아지 심정지 (CPA) 프로토콜 (RECOVER 기반)",bls:["즉시 100-120회/분 흉부압박","6초에 1회 환기 시작"],als:["2분마다 흉부압박 교대하며 아래 약물 투여"],meds:[{name:"에피네프린 (Low dose, 1차)",details:"희석법: 에피네프린 원액 0.1mL + N/S 0.9mL (총 1mL)",dose:"".concat((.1*s).toFixed(2)," mL (희석액) IV")},{name:"아트로핀 (Asystole/PEA 시)",dose:"".concat((.04*s).toFixed(2)," mL (").concat((.02*s).toFixed(2)," mg) IV")},{name:"에피네프린 (High dose, 반응 없을 시)",dose:"".concat((.1*s).toFixed(2)," mL (원액) IV")}]}:{title:"고양이 심정지 (CPA) 프로토콜 (RECOVER 기반)",bls:["분당 100-120회 속도로 흉곽 1/3 깊이 압박 (2분마다 교대)","즉시 기관 삽관, 6초에 1회 인공 환기 (과환기 금지)"],als:[],meds:[{name:"에피네프린 (Low dose)",details:"희석: 원액 0.1mL + N/S 0.9mL",dose:"".concat((.1*s).toFixed(2)," mL (희석액) IV")},{name:"바소프레신 (대체 가능)",dose:"".concat((.04*s).toFixed(2)," mL IV")},{name:"아트로핀 (Vagal arrest 의심 시)",dose:"".concat((.04*s).toFixed(2)," mL IV")}]}:null,[t,s]);return(0,a.jsx)(eZ,{value:"item-8",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2 text-red-600",children:[(0,a.jsx)(tl.A,{})," 응급 대응"]})}),(0,a.jsx)(eK,{className:"p-6 pt-0",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)(j.Zp,{className:"bg-orange-50",children:[(0,a.jsx)(j.aR,{children:(0,a.jsx)(j.ZB,{className:"text-base",children:"저혈압 대응 CRI"})}),(0,a.jsxs)(j.Wu,{children:[(0,a.jsx)("h5",{className:"font-semibold",children:i.type}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:i.recipe}),(0,a.jsxs)("p",{className:"font-semibold mt-2",children:["주입 속도: ",(0,a.jsx)("span",{className:"font-mono text-lg font-bold text-primary",children:i.rate})]})]})]}),(0,a.jsxs)(j.Zp,{className:"bg-red-50",children:[(0,a.jsx)(j.aR,{children:(0,a.jsx)(j.ZB,{className:"text-base",children:"응급 Bolus (서맥/저혈압)"})}),(0,a.jsx)(j.Wu,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h5",{className:"font-semibold flex items-center gap-2",children:[(0,a.jsx)(e4.w,{className:"h-5 w-5"}),(0,a.jsx)(e3.k,{className:"h-5 w-5"}),"강아지/고양이: 아트로핀 (IV)"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"저혈압(MAP<60) 동반 유의미한 서맥 시 (※ 예방적 사용 금지)"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-semibold text-sm",children:["초기: ",(0,a.jsxs)("span",{className:"font-mono text-lg font-bold text-primary",children:[(.04*s).toFixed(2)," mL"]})]}),(0,a.jsxs)("p",{className:"font-semibold text-sm",children:["최대: ",(0,a.jsxs)("span",{className:"font-mono text-lg font-bold text-primary",children:[(.08*s).toFixed(2)," mL"]})]})]})]})})]}),r&&(0,a.jsxs)(j.Zp,{className:"lg:col-span-2 border-red-500 border-2",children:[(0,a.jsx)(j.aR,{children:(0,a.jsx)(j.ZB,{className:"flex items-center gap-2 text-red-600",children:r.title})}),(0,a.jsxs)(j.Wu,{className:"space-y-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-base",children:"BLS (기본소생술)"}),(0,a.jsx)("ul",{className:"list-disc pl-5 mt-1 space-y-1 text-muted-foreground",children:r.bls.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-base",children:"ALS (전문소생술)"}),r.als.length>0&&(0,a.jsx)("ul",{className:"list-disc pl-5 mt-1 space-y-1 text-muted-foreground",children:r.als.map((e,t)=>(0,a.jsx)("li",{children:e},t))}),(0,a.jsx)("div",{className:"mt-2 space-y-3",children:r.meds.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start justify-between p-2 bg-red-50 rounded-md",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.name}),e.details&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.details})]}),(0,a.jsx)(ez,{variant:"destructive",className:"text-base font-mono whitespace-nowrap",children:e.dose})]},t))})]})]})]})]})})]})})}),td=n.memo(()=>{let{watch:e}=(0,o.xW)(),{species:t,weight:s,hasHeartCondition:i,hasLiverCondition:r,hasKidneyCondition:l}=e(),c=n.useMemo(()=>{if(!t||!s||s<=0)return{corrected:"N/A",original:"N/A"};if(i)if("개"===t){let e=(+s).toFixed(2),t=(5*s).toFixed(2);return{corrected:"".concat(e," ml/hr"),original:"(절대 상한: ".concat(t," ml/hr)"),isHeartCondition:!0,recommended:"권장 시작: 1-3ml/kg/hr"}}else{let e=(+s).toFixed(2),t=(3*s).toFixed(2);return{corrected:"".concat(e," ml/hr"),original:"(절대 상한: ".concat(t," ml/hr)"),isHeartCondition:!0,recommended:"권장 시작: 1-2ml/kg/hr"}}let e=5*s,a=60/41*e;return{corrected:"".concat(a.toFixed(2)," ml/hr"),original:"(보정 전: ".concat(e.toFixed(2)," ml/hr)")}},[t,s,i]),d=n.useMemo(()=>{if(!t||!s)return{type:"정보 부족",recipe:"",rate:""};if("개"===t)return r&&l?{type:"CRI 불가",recipe:"간과 신장 기능 저하로 CRI를 권장하지 않습니다.",rate:"",isContraindicated:!0}:l?{type:"리도카인 CRI",recipe:"리도카인 10mL + N/S 90mL",rate:"".concat((25*s*.03).toFixed(2)," ~ ").concat((50*s*.03).toFixed(2)," mL/hr")}:r?{type:"케타민 CRI",recipe:"케타민(50mg/mL) 2mL + N/S 98mL",rate:"정보 없음"}:{type:"LK CRI",recipe:"리도카인 10mL + 케타민 0.8mL + N/S 89.2mL",rate:"".concat((25*s*.03).toFixed(2)," ~ ").concat((50*s*.03).toFixed(2)," mL/hr")};{if(l)return{type:"케타민 CRI 금기",recipe:"신장 기능 저하로 케타민 사용을 권장하지 않습니다.",rate:"",isContraindicated:!0};let e=(.3*s).toFixed(2);return{type:"케타민 CRI",recipe:"케타민(50mg/mL) 2mL + N/S 98mL",rate:"".concat(e," mL/hr")}}},[t,s,r,l]);return(0,a.jsx)(eZ,{value:"item-2",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(eU.A,{}),"수액 및 CRI"]})}),(0,a.jsx)(eK,{className:"p-6 pt-0",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-bold text-center",children:"수액 펌프 속도"}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"펌프 설정 속도"}),(0,a.jsx)("p",{className:(0,M.cn)("text-3xl font-bold text-primary",c.isHeartCondition&&"text-red-600"),children:c.corrected}),(0,a.jsx)("p",{className:(0,M.cn)("text-xs text-muted-foreground",c.isHeartCondition&&"font-bold text-red-600"),children:c.original}),c.isHeartCondition&&(0,a.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:c.recommended})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"font-bold text-center",children:"진통제 CRI"}),(0,a.jsxs)("div",{className:(0,M.cn)("p-4 rounded-lg",d.isContraindicated?"bg-red-100":"bg-blue-50"),children:[(0,a.jsxs)("h5",{className:"font-bold flex items-center gap-2",children:[d.isContraindicated&&(0,a.jsx)(eF.A,{className:"text-red-600"}),"추천: ",(0,a.jsx)("span",{className:(0,M.cn)(d.isContraindicated?"text-red-600":"text-blue-600"),children:d.type})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:d.recipe}),d.rate&&(0,a.jsxs)("p",{className:"font-semibold mt-2 text-sm",children:["주입 속도: ",(0,a.jsx)("span",{className:"font-mono",children:d.rate})]})]})]})]})})]})})});var to=s(1186),tm=s(1706);let tu=n.memo(()=>{let{watch:e}=(0,o.xW)(),{species:t,weight:s,birthDate:i,hasHeartCondition:r,hasKidneyCondition:l,hasLiverCondition:c}=e(),[d,m]=n.useState(0),u=n.useMemo(()=>i?((e,t,s)=>{if(!t)return null;let a=(0,e5.V)(new Date,t);if("고양이"===e){if(a>=15)return{name:"초고령기",color:"bg-red-500"};if(a>=11)return{name:"노령기",color:"bg-orange-500"};if(a>=7)return{name:"성숙기",color:"bg-blue-500"}}else if(s>40){if(a>=5)return{name:"노령기",color:"bg-orange-500"}}else if(s>25){if(a>=7)return{name:"노령기",color:"bg-orange-500"}}else if(s>10){if(a>=8)return{name:"노령기",color:"bg-orange-500"}}else if(a>=9)return{name:"노령기",color:"bg-orange-500"};return null})(t,i,s):null,[t,i,s]),x=n.useMemo(()=>!!u||r||l||c,[u,r,l,c]),h=n.useMemo(()=>{if(!t||!s||s<=0||0===d)return{total:0,perSite:0,maxSafe:0};let e=s*(x?"개"===t?.15:.1:"개"===t?.3:.2)/4*d,a=d>0?e/d:0;return{total:e,perSite:a,maxSafe:.4*s}},[t,s,x,d]);return(0,a.jsx)(eZ,{value:"item-1",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(tm.A,{}),"수술 전 약물 준비"]})}),(0,a.jsx)(eK,{className:"p-6 pt-0",children:(0,a.jsxs)("div",{className:"space-y-6 text-sm",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)(j.Zp,{className:"bg-blue-50/50 p-4",children:[(0,a.jsx)(j.ZB,{className:"text-base font-semibold mb-2",children:"예방적 항생제"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{children:["바이트릴/세프론: ",(0,a.jsxs)("span",{className:"font-bold text-lg",children:[(.05*s).toFixed(2)," ml"]})]}),(0,a.jsxs)("p",{children:["덱사메타손: ",(0,a.jsxs)("span",{className:"font-bold text-lg",children:[(.1*s).toFixed(2)," ml"]})]})]})]}),(0,a.jsxs)(j.Zp,{className:"bg-green-50/50 p-4",children:[(0,a.jsx)(j.ZB,{className:"text-base font-semibold mb-2",children:"24시간 지속 진통 주사"}),(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsxs)("p",{children:["노바트: ",(0,a.jsxs)("span",{className:"font-bold text-lg",children:[(.1*s).toFixed(2)," ml"]})]})})]}),(0,a.jsxs)(j.Zp,{className:"bg-yellow-50/50 p-4",children:[(0,a.jsx)(j.ZB,{className:"text-base font-semibold mb-2",children:"전 마취 주사"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{children:["부토르파놀: ",(0,a.jsxs)("span",{className:"font-bold text-lg",children:[(.08*s).toFixed(2)," ml"]})]}),(0,a.jsxs)("p",{children:["미다졸람: ",(0,a.jsxs)("span",{className:"font-bold text-lg",children:[(.08*s).toFixed(2)," ml"]})]})]})]}),(0,a.jsxs)(j.Zp,{className:"bg-red-50/50 p-4",children:[(0,a.jsx)(j.ZB,{className:"text-base font-semibold mb-2",children:"국소 마취 (부피바카인)"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(to.l6,{onValueChange:e=>m(Number(e)),value:String(d),children:[(0,a.jsx)(to.bq,{children:(0,a.jsx)(to.yv,{placeholder:"부위 선택"})}),(0,a.jsxs)(to.gC,{children:[(0,a.jsx)(to.eb,{value:"0",children:"선택 안함"}),(0,a.jsx)(to.eb,{value:"1",children:"1 site"}),(0,a.jsx)(to.eb,{value:"2",children:"2 sites"}),(0,a.jsx)(to.eb,{value:"3",children:"3 sites"}),(0,a.jsx)(to.eb,{value:"4",children:"4 sites"})]})]}),d>0&&(0,a.jsxs)("div",{className:"text-xs space-y-1 bg-white/50 p-2 rounded-md",children:[(0,a.jsxs)("p",{children:["총 주사량: ",(0,a.jsxs)("span",{className:"font-bold",children:[h.total.toFixed(2)," ml"]})]}),(0,a.jsxs)("p",{children:["부위당: ",(0,a.jsxs)("span",{className:"font-bold",children:[h.perSite.toFixed(2)," ml"]})]}),(0,a.jsxs)("p",{className:"text-red-600",children:["안전 최대 용량: ",(0,a.jsxs)("span",{className:"font-bold",children:[h.maxSafe.toFixed(2)," ml"]})]})]})]})]})]}),(0,a.jsxs)(j.Zp,{className:"bg-purple-50/50 p-4",children:[(0,a.jsx)(j.ZB,{className:"text-base font-semibold mb-2",children:"도입 마취제"}),(0,a.jsxs)("div",{className:"flex gap-8",children:[(0,a.jsxs)("p",{children:["프로포폴: ",(0,a.jsxs)("span",{className:"font-bold text-lg",children:[((e,t)=>t<=0?0:("고양이"===e?t<=4?6:5.5:t<=4?5:t<=7?4.5:t<=10?4:t<=20?3.5:t<=40?3:2.5)*t/10)(t,s).toFixed(2)," ml"]})]}),(0,a.jsxs)("p",{children:["알팍산: ",(0,a.jsxs)("span",{className:"font-bold text-lg",children:[((e,t)=>t<=0?0:("고양이"===e?t<=4?3:2.5:t<=4?2.5:t<=10?2:t<=20?1.8:t<=40?1.5:t<=80?1.2:1)*t/10)(t,s).toFixed(2)," ml"]}),x&&(0,a.jsx)(ez,{variant:"destructive",className:"ml-2",children:"추천"})]})]})]})]})})]})})});var tx=s(8134),th=s(5667);let tp=th.bL,tg=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(th.B8,{ref:t,className:(0,M.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...n})});tg.displayName=th.B8.displayName;let tj=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(th.l9,{ref:t,className:(0,M.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...n})});tj.displayName=th.l9.displayName;let tf=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(th.UC,{ref:t,className:(0,M.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n})});tf.displayName=th.UC.displayName;var ty=s(5239),tb=s(7776),tv=s(4223),tN=s(3630),tw=s(2265);let tC=n.memo(e=>{let{patientId:t,images:s,setImages:i,openImageViewer:r}=e,[l,c]=n.useState(!1),[o,m]=n.useState(0),u=n.useRef(null),[h,p]=n.useState("general"),[f,y]=n.useState(null),[b,v]=n.useState(!1),[N,w]=n.useState(!1),{toast:C}=(0,k.dj)(),_=(e,s)=>{c(!0),m(0),Array.from(e).forEach(e=>{let a=e.name.replace(/[^a-zA-Z0-9\uAC00-\uD7A3_.-]/g,"_"),n="images/".concat(t,"/").concat(s,"/").concat(Date.now(),"_").concat(a),i=(0,tx.KR)(x.IG,n),r=(0,tx.bp)(i,e);r.on("state_changed",e=>{m(e.bytesTransferred/e.totalBytes*100)},t=>{console.error("Upload failed:",t),C({title:"업로드 실패",description:"".concat(e.name," 업로드 중 오류 발생"),variant:"destructive"}),c(!1)},async()=>{let a=await (0,tx.qk)(r.snapshot.ref);await (0,d.gS)((0,d.rJ)(x.db,"patients",t,"images"),{imageUrl:a,storagePath:n,category:s,uploadedAt:(0,d.O5)()}),C({title:"성공",description:"".concat(e.name,"이(가) 업로드되었습니다.")}),c(!1)})})},S=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?w(!0):"dragleave"===e.type&&w(!1)},D=async()=>{if(f){i(s.filter(e=>e.id!==f.id));try{let e=await fetch("/api/deleteFile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:t,fileId:f.id,storagePath:f.storagePath})});if(!e.ok){let t=await e.json().catch(()=>({message:"Server error"}));throw Error(t.message||"Server responded with ".concat(e.status))}C({title:"성공",description:"파일이 삭제되었습니다."})}catch(e){console.error("Error deleting file: ",e),i(s),C({title:"오류",description:e.message||"파일 삭제 중 오류가 발생했습니다.",variant:"destructive"})}finally{v(!1),y(null)}}},R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd";return e?(0,ef.GP)(e.toDate(),t,{locale:eb.ko}):"정보 없음"},A=e=>{let t=s.filter(t=>t.category===e);return(0,a.jsxs)("div",{className:"mt-4",onDragEnter:S,onDragOver:S,onDragLeave:S,onDrop:t=>((e,t)=>{e.preventDefault(),e.stopPropagation(),w(!1);let s=e.dataTransfer.files;s&&s.length>0&&_(s,t)})(t,e),children:[(0,a.jsxs)("div",{className:(0,M.cn)("relative p-4 border-2 border-dashed rounded-lg transition-colors",N?"border-primary bg-primary/10":"border-muted-foreground/20"),children:[N&&(0,a.jsxs)("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-background/80 backdrop-blur-sm",children:[(0,a.jsx)(tb.A,{className:"h-12 w-12 text-primary"}),(0,a.jsx)("p",{className:"mt-2 text-lg font-medium text-primary",children:"여기에 파일을 드롭하세요"})]}),t.length>0?(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:t.map((e,s)=>(0,a.jsxs)("div",{className:"relative aspect-square group overflow-hidden rounded-lg shadow-md cursor-pointer",onClick:()=>r(t,s),children:[(0,a.jsx)(ty.default,{src:e.imageUrl,alt:"".concat(R(e.uploadedAt,"yyyy-MM-dd HH:mm"),"의 사진"),fill:!0,sizes:"(max-width: 640px) 50vw, (max-width: 768px) 33vw, (max-width: 1024px) 25vw, 16vw",className:"object-cover transition-transform duration-300 group-hover:scale-105"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent p-2 flex flex-col justify-end",children:(0,a.jsx)("p",{className:"text-white text-xs font-medium truncate",children:R(e.uploadedAt,"yyyy-MM-dd HH:mm")})}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(tv.A,{className:"text-white h-8 w-8"})}),(0,a.jsx)(g.$,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:t=>{t.stopPropagation(),y(e),v(!0)},children:(0,a.jsx)(tN.A,{className:"h-3 w-3"})})]},e.id))}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"업로드된 사진이 없습니다. 파일을 드래그하거나 버튼을 클릭하세요."})})]}),(0,a.jsxs)(g.$,{className:"mt-4",type:"button",onClick:()=>(e=>{var t;p(e),null==(t=u.current)||t.click()})(e),disabled:l,children:[(0,a.jsx)(tw.A,{className:"mr-2 h-4 w-4"})," 사진 추가"]}),l&&(0,a.jsx)(eS,{value:o,className:"mt-2"})]})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eZ,{value:"item-5",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsx)(j.ZB,{children:"사진 및 X-Ray 기록"})}),(0,a.jsxs)(eK,{className:"p-6 pt-0",children:[(0,a.jsx)(j.BT,{children:"일반 사진, 수술 전/후 X-Ray를 관리합니다."}),(0,a.jsxs)(tp,{defaultValue:"general",className:"w-full mt-4",children:[(0,a.jsxs)(tg,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(tj,{value:"general",children:"일반 사진"}),(0,a.jsx)(tj,{value:"pre-surgery",children:"수술 전 X-Ray"}),(0,a.jsx)(tj,{value:"post-surgery",children:"수술 후 X-Ray"})]}),(0,a.jsx)(tf,{value:"general",children:A("general")}),(0,a.jsx)(tf,{value:"pre-surgery",children:A("pre-surgery")}),(0,a.jsx)(tf,{value:"post-surgery",children:A("post-surgery")})]})]})]})}),(0,a.jsx)("input",{type:"file",ref:u,onChange:e=>{let t=e.target.files;t&&0!==t.length&&_(t,h)},className:"hidden",accept:"image/*",disabled:l,multiple:!0}),(0,a.jsx)(eT.Lt,{open:b,onOpenChange:v,children:(0,a.jsxs)(eT.EO,{children:[(0,a.jsxs)(eT.wd,{children:[(0,a.jsx)(eT.r7,{children:"파일을 삭제하시겠습니까?"}),(0,a.jsx)(eT.$v,{children:"이 작업은 되돌릴 수 없습니다. 선택한 파일이 영구적으로 삭제됩니다."})]}),(0,a.jsxs)(eT.ck,{children:[(0,a.jsx)(eT.Zr,{children:"취소"}),(0,a.jsx)(eT.Rx,{onClick:D,className:"bg-destructive hover:bg-destructive/90",children:"삭제"})]})]})})]})});var t_=s(671);let tk=n.memo(e=>{let{costs:t,setCosts:s,dentalData:i,additionalTreatments:r,patient:l,selectedPackages:c}=e,{watch:d}=(0,o.xW)(),m=d("species"),u=d("weight"),x=n.useMemo(()=>m&&u?em(m,u):null,[m,u]),h=n.useMemo(()=>x?eo.flatMap(e=>x[e.id]||[]):[],[x]),p=n.useMemo(()=>new Map(h.map(e=>[e.id,e])),[h]);n.useEffect(()=>{if(!i||!p.size)return;let e=Object.values(i).reduce((e,t)=>t.procedures?e+t.procedures.reduce((e,t)=>{let s=p.get(t);return e+((null==s?void 0:s.price)||0)},0):e,0);s(t=>({...t,procedure:e}))},[i,p,s]);let g=n.useMemo(()=>{let e={};return Object.entries(i).forEach(t=>{let[s,a]=t;a.procedures&&a.procedures.length>0&&a.procedures.forEach(t=>{let a=p.get(t);a&&(e[t]?(e[t].count++,e[t].toothIds.push(s)):e[t]={name:a.name,price:a.price,count:1,toothIds:[s]})})}),Object.values(e)},[i,p]),f=n.useMemo(()=>{if(!l||!l.species||!l.weight)return{};let e=es(l);return e.categories?r.reduce((t,s)=>{for(let a of e.categories){let n=e[a.id];if(null==n?void 0:n.some(e=>e.id===s.id)){t[a.name]||(t[a.name]=[]),t[a.name].push(s);break}}return t},{}):{}},[r,l]),y=(t.procedure||0)+(t.anesthesia||0)+(t.checkup||0)+(t.additional||0);return(0,a.jsx)(eZ,{value:"item-6",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(t_.A,{}),"비용 정보"]})}),(0,a.jsxs)(eK,{className:"p-6 pt-0 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-center",children:[(0,a.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"치과 수술 비용"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-slate-800 tracking-tighter",children:[(t.procedure||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"스케일링 패키지 비용"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-slate-800 tracking-tighter",children:[(t.anesthesia||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"건강검진 비용"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-slate-800 tracking-tighter",children:[(t.checkup||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-600",children:"추가 처치 비용"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-slate-800 tracking-tighter",children:[(t.additional||0).toLocaleString()," 원"]})]})]}),g.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold",children:"치과 수술 상세 내역"}),(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsxs)(S.XI,{children:[(0,a.jsx)(S.A0,{children:(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nd,{className:"text-base",children:"시술명"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"단가"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"횟수"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"합계"})]})}),(0,a.jsx)(S.BF,{children:g.map((e,t)=>(0,a.jsxs)(S.Hj,{children:[(0,a.jsxs)(S.nA,{className:"text-base",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:l.species&&e.toothIds.map(e=>er(e,l.species)).join(", ")})]}),(0,a.jsxs)(S.nA,{className:"text-right font-mono text-base",children:[e.price.toLocaleString(),"원"]}),(0,a.jsx)(S.nA,{className:"text-right font-mono text-base",children:e.count}),(0,a.jsxs)(S.nA,{className:"text-right font-mono text-base",children:[(e.price*e.count).toLocaleString(),"원"]})]},"".concat(e.name,"-").concat(t)))})]})})]}),r.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold",children:"추가 처치 상세 내역"}),(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-4",children:Object.entries(f).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"break-inside-avoid",children:[(0,a.jsx)("h5",{className:"text-base font-medium text-gray-800 mb-2",children:t}),(0,a.jsx)("ul",{className:"space-y-1.5 text-sm text-muted-foreground",children:s.map(e=>(0,a.jsxs)("li",{className:"flex justify-between text-base",children:[(0,a.jsx)("span",{className:"pr-2",children:e.name}),(0,a.jsxs)("span",{className:"font-mono whitespace-nowrap",children:[e.price.toLocaleString(),"원"]})]},e.id+e.optionKey))})]},t)})})})]}),(0,a.jsxs)("div",{className:"text-right mt-4 p-4 rounded-lg bg-blue-50",children:[(0,a.jsx)("span",{className:"text-xl font-bold mr-4",children:"총 비용:"}),(0,a.jsxs)("span",{className:"text-3xl font-bold text-blue-700 tracking-tighter",children:[y.toLocaleString()," 원"]})]})]})]})})});function tS(e){let[t,s]=(0,n.useState)(null),[a,i]=(0,n.useState)({}),[r,l]=(0,n.useState)([]),[o,m]=(0,n.useState)([]),[u,h]=(0,n.useState)([]),[p,g]=(0,n.useState)({procedure:0,additional:0,anesthesia:0,checkup:0}),[j,f]=(0,n.useState)([]),[y,b]=(0,n.useState)(null),[v,N]=(0,n.useState)(""),[w,C]=(0,n.useState)(!0),[_,S]=(0,n.useState)(null),D=(0,c.useRouter)(),{toast:R}=(0,k.dj)(),M=(0,n.useRef)(!0);return(0,n.useEffect)(()=>{if(!e)return;console.log("Subscribing to patient data for patientId:",e);let t=(0,d.H9)(x.db,"patients",e),a=(0,d.aQ)(t,e=>{if(e.exists()){let t={id:e.id,...e.data()};s(t),i(t.dentalData||{}),l(t.dischargeMeds||[]),m(t.additionalTreatments||[]),h(t.selectedPackages||[]),g(t.costs||{procedure:0,additional:0,anesthesia:0,checkup:0}),b(t.analysisResult||null),N(t.analysisText||"")}else R({title:"오류",description:"환자를 찾을 수 없습니다.",variant:"destructive"}),D.push("/");C(!1)},e=>{console.error("Error fetching patient data: ",e),R({title:"오류",description:"환자 정보를 가져오지 못했습니다.",variant:"destructive"}),C(!1)}),n=(0,d.H9)(x.db,"settings","sodalime"),r=(0,d.aQ)(n,e=>{S(e.exists()?e.data():{totalMinutes:0,usage:{}})}),c=(0,d.rJ)(x.db,"patients",e,"images"),o=(0,d.P)(c,(0,d.My)("uploadedAt","desc")),u=(0,d.aQ)(o,e=>{M.current?(f(e.docs.map(e=>({id:e.id,...e.data()}))),M.current=!1):e.docChanges().forEach(e=>{let t={id:e.doc.id,...e.doc.data()};"added"===e.type&&f(e=>e.some(e=>e.id===t.id)?e:[t,...e]),"modified"===e.type&&f(e=>e.map(e=>e.id===t.id?t:e)),"removed"===e.type&&f(e=>e.filter(e=>e.id!==t.id))})},e=>{console.error("Error listening to images collection:",e),R({title:"오류",description:"이미지를 실시간으로 불러오지 못했습니다.",variant:"destructive"})});return()=>{console.log("Unsubscribing from patient data for patientId:",e),a(),r(),u()}},[e,R,D]),{patient:t,dentalData:a,setDentalData:i,dischargeMeds:r,setDischargeMeds:l,additionalTreatments:o,setAdditionalTreatments:m,selectedPackages:u,setSelectedPackages:h,costs:p,setCosts:g,images:j,setImages:f,sodalimeRecord:_,isLoading:w,analysisResult:y,setAnalysisResult:b,analysisText:v,setAnalysisText:N}}var tD=s(3693),tR=s.n(tD);let tM=[{maxWeight:2,id:3},{maxWeight:4,id:3.5},{maxWeight:6,id:4},{maxWeight:8,id:4.5},{maxWeight:10,id:5},{maxWeight:12,id:5.5},{maxWeight:14,id:6},{maxWeight:16,id:6.5},{maxWeight:18,id:7},{maxWeight:20,id:7.5},{maxWeight:25,id:8},{maxWeight:30,id:9},{maxWeight:40,id:10},{maxWeight:1/0,id:10}],tA=[{maxWeight:2,id:2.5},{maxWeight:3.5,id:3},{maxWeight:4,id:3.5},{maxWeight:6,id:4},{maxWeight:9,id:4.5},{maxWeight:1/0,id:4.5}],tF=[{id:2.5,od:4.1},{id:3,od:4.6},{id:3.5,od:5.3},{id:4,od:5.9},{id:4.5,od:6.5},{id:5,od:7},{id:5.5,od:7.6},{id:6,od:8.2},{id:6.5,od:9},{id:7,od:9.5},{id:7.5,od:10.2},{id:10,od:13.5}],tL=(e,t)=>{let s=e-t;return s<1?{title:"\uD83D\uDFE2 풍선 최소량 주입",desc:"튜브가 기관에 거의พอดี. 최소한의 공기 주입으로도 충분한 밀봉이 예상됩니다."}:s>=1&&s<=2?{title:"\uD83D\uDFE1 풍선 적당량 주입",desc:"일반적인 경우입니다. 적절한 공기 주입이 필요합니다."}:{title:"\uD83D\uDD34 풍선 충분히 주입 (누출 확인)",desc:"기관과 튜브 사이의 공간이 클 수 있습니다. 누출(leak)이 없는지 확인하며 충분한 공기 주입이 필요합니다."}};function tT(e){let{species:t,weight:s,currentSize:i,currentCuffGuide:r,onSave:l}=e,[c,d]=(0,n.useState)(""),[o,m]=(0,n.useState)(null),[u,x]=(0,n.useState)(i||""),[h,p]=(0,n.useState)(r||""),{toast:j}=(0,k.dj)();(0,n.useEffect)(()=>{x(i||""),p(r||"")},[i,r]);let f=(0,n.useMemo)(()=>{if(!s||s<=0)return null;let e=("개"===t?tM:tA).find(e=>s<=e.maxWeight);return e?"".concat(e.id.toFixed(1)," mm"):"N/A"},[t,s]),y=(0,n.useCallback)(tR()(e=>{let t=parseFloat(e);if(isNaN(t)||t<=0)return void m(null);let s=.8*t,a=null,n=1/0;if(tF.forEach(e=>{let t=Math.abs(e.od-s);t<n&&(n=t,a=e)}),!a)return void m(null);let i=tL(t,a.od),r={recommendedId:a.id.toFixed(1),diameterDiff:(t-a.od).toFixed(2),cuffGuide:i};m(r),x(r.recommendedId),p(r.cuffGuide.title)},300),[]);return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)(eC.J,{children:"체중 기반 추천"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-primary",children:f||"체중 입력 필요"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eC.J,{htmlFor:"t1-diameter",children:"T1 기관 직경 (mm)"}),(0,a.jsx)(I.p,{id:"t1-diameter",type:"number",placeholder:"X-ray에서 측정한 값",value:c,onChange:e=>{let t=e.target.value;d(t),t?y(t):m(null)},step:"0.1"})]}),o&&(0,a.jsxs)("div",{className:"space-y-4 border p-4 rounded-lg bg-blue-50/50",children:[(0,a.jsx)("h4",{className:"font-bold text-center",children:"T1 직경 기반 계산 결과"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(eC.J,{children:"\uD83C\uDFAF 추천 I.D"}),(0,a.jsxs)("span",{className:"text-xl font-bold text-blue-600",children:[o.recommendedId," mm"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(eC.J,{children:"↔ 직경 차이 (T1 - O.D)"}),(0,a.jsxs)("span",{className:"font-semibold",children:[o.diameterDiff," mm"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(eC.J,{children:"\uD83C\uDF88 커프 팽창 가이드"}),(0,a.jsxs)("div",{className:"p-2 mt-1 rounded-md bg-white text-center",children:[(0,a.jsx)("p",{className:"font-bold",children:o.cuffGuide.title}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:o.cuffGuide.desc})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eC.J,{htmlFor:"final-decision",className:"text-base font-bold",children:"최종 결정 사이즈 (mm)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(I.p,{id:"final-decision",type:"number",placeholder:"수의사 최종 결정",value:u,onChange:e=>x(e.target.value),step:"0.1",className:"font-bold text-lg"}),(0,a.jsx)(g.$,{onClick:()=>{let e=parseFloat(c),t=parseFloat(u);if(isNaN(t)||t<=0)return void j({title:"오류",description:"유효한 최종 결정 사이즈를 입력해주세요.",variant:"destructive"});let s=h;if(!isNaN(e)&&e>0){let a=tF.find(e=>e.id===t);a?s=tL(e,a.od).title:j({title:"경고",description:"선택한 튜브 사이즈에 대한 정보가 없습니다. 커프 가이드를 직접 확인해주세요.",variant:"destructive"})}l(u,s),j({title:"저장 완료",description:"카테터 사이즈 ".concat(u,"mm와 커프 가이드가 저장되었습니다.")})},children:"선택 저장"})]})]}),(0,a.jsx)(A,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-bold text-center text-sm",children:"튜브 사이즈 참고표"}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto border rounded-md",children:(0,a.jsxs)(S.XI,{children:[(0,a.jsx)(S.A0,{children:(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nd,{className:"text-center",children:"I.D (mm)"}),(0,a.jsx)(S.nd,{className:"text-center",children:"O.D (mm)"})]})}),(0,a.jsx)(S.BF,{children:tF.map(e=>(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nA,{className:"text-center font-mono",children:e.id.toFixed(1)}),(0,a.jsx)(S.nA,{className:"text-center font-mono",children:e.od.toFixed(1)})]},e.id))})]})})]})]})]})})}var tI=s(1190),tP=s(3263),tz=s(5866);function tE(e){var t;let{imageData:s,onClose:i}=e,[r,l]=(0,n.useState)((null==s?void 0:s.startIndex)||0),[c,d]=(0,n.useState)(1),[o,m]=(0,n.useState)({x:0,y:0}),[u,x]=(0,n.useState)(1),[h,p]=(0,n.useState)(1),j=(0,n.useRef)(null),f=(0,n.useRef)(!1),y=(0,n.useRef)(!1),b=(0,n.useRef)({x:0,y:0}),v=(null==s?void 0:s.images)||[],N=null==(t=v[r])?void 0:t.imageUrl,w=(0,n.useCallback)(()=>{d(1),m({x:0,y:0}),x(1),p(1)},[]);(0,n.useEffect)(()=>{s&&(l(s.startIndex),w())},[s,w]);let C=(0,n.useCallback)(()=>{v&&0!==v.length&&(l(e=>(e+1)%v.length),w())},[v,w]),_=(0,n.useCallback)(()=>{v&&0!==v.length&&(l(e=>(e-1+v.length)%v.length),w())},[v,w]);return(0,n.useEffect)(()=>{let e=e=>{"ArrowRight"===e.key&&C(),"ArrowLeft"===e.key&&_()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[C,_]),(0,a.jsx)(ej.lG,{open:!!s,onOpenChange:e=>{e||(i(),w())},children:(0,a.jsxs)(ej.Cf,{className:"max-w-[95vw] w-[95vw] h-[95vh] p-2 bg-black border-gray-800 flex flex-col",children:[(0,a.jsxs)(ej.c7,{children:[(0,a.jsx)(ej.L3,{className:"sr-only",children:"이미지 뷰어"}),(0,a.jsx)(ej.rr,{className:"sr-only",children:"확대된 이미지입니다. 마우스로 이동, 확대/축소, 밝기/대비 조절이 가능합니다."})]}),(0,a.jsx)("div",{className:"relative w-full h-full overflow-hidden cursor-grab active:cursor-grabbing",onMouseDown:e=>{e.preventDefault(),0===e.button?f.current=!0:2===e.button&&(y.current=!0),b.current={x:e.clientX,y:e.clientY}},onMouseMove:e=>{e.preventDefault();let t=e.clientX-b.current.x,s=e.clientY-b.current.y;f.current&&m(e=>({x:e.x+t,y:e.y+s})),y.current&&(x(e=>Math.max(.1,e-.01*s)),p(e=>Math.max(.1,e+.01*t))),b.current={x:e.clientX,y:e.clientY}},onMouseUp:e=>{e.preventDefault(),f.current=!1,y.current=!1},onMouseLeave:()=>{f.current=!1,y.current=!1},onDoubleClick:e=>{e.preventDefault(),w()},onContextMenu:e=>e.preventDefault(),onWheel:e=>{e.preventDefault(),d(t=>Math.max(.5,Math.min(10,t-.001*e.deltaY)))},children:N&&(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center transition-transform duration-100",style:{transform:"translate(".concat(o.x,"px, ").concat(o.y,"px) scale(").concat(c,")")},children:(0,a.jsx)(ty.default,{ref:j,src:N,alt:"이미지 뷰어",fill:!0,className:"object-contain drop-shadow-lg",style:{filter:"brightness(".concat(u,") contrast(").concat(h,")")}})})}),v.length>1&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.$,{variant:"outline",size:"icon",onClick:_,className:"absolute left-4 top-1/2 -translate-y-1/2 bg-background/50 hover:bg-background/80 z-10",children:(0,a.jsx)(tI.A,{className:"h-6 w-6"})}),(0,a.jsx)(g.$,{variant:"outline",size:"icon",onClick:C,className:"absolute right-4 top-1/2 -translate-y-1/2 bg-background/50 hover:bg-background/80 z-10",children:(0,a.jsx)(tP.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/50 text-white text-sm px-3 py-1 rounded-full",children:[r+1," / ",v.length]})]}),(0,a.jsx)("div",{className:"absolute top-4 right-16 flex items-center gap-2",children:(0,a.jsxs)(g.$,{variant:"outline",size:"icon",onClick:w,className:"bg-background/50 hover:bg-background/80",children:[(0,a.jsx)(tz.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"초기화"})]})})]})})}var tB=s(7482);let tW={permanent:{dog:{incisors:["101","102","103","201","202","203","301","302","303","401","402","403"],canines:["104","204","304","404"],premolars:["105","106","107","108","205","206","207","208","305","306","307","308","405","406","407","408"],molars:["109","110","209","210","309","310","311","409","410","411"]},cat:{incisors:["101","102","103","201","202","203","301","302","303","401","402","403"],canines:["104","204","304","404"],premolars:["106","107","108","206","207","208","307","308","407","408"],molars:["109","209","309","409"]}},deciduous:{dog:{incisors:["501","502","503","601","602","603","701","702","703","801","802","803"],canines:["504","604","704","804"],premolars:["505","506","507","508","605","606","607","608","705","706","707","708","805","806","807","808"]},cat:{incisors:["501","502","503","601","602","603","701","702","703","801","802","803"],canines:["504","604","704","804"],premolars:["506","507","508","606","607","608","707","708","807","808"]}}},tO={permanent:{upperRight:["101","102","103","104","105","106","107","108","109","110"],upperLeft:["201","202","203","204","205","206","207","208","209","210"],lowerRight:["401","402","403","404","405","406","407","408","409","410","411"],lowerLeft:["301","302","303","304","305","306","307","308","309","310","311"]}},tH=[{name:"치주 질환",conditions:[{id:"PD",name:"치주염 (PD)"},{id:"GI",name:"치은염 (GI)"},{id:"GH",name:"치은 증식 (GH)"},{id:"PPD",name:"치주낭 (PPD)"},{id:"GR",name:"치은퇴축 (GR)"},{id:"CAL",name:"치은부착소실 (CAL)"},{id:"F",name:"치근분지부 노출 (F)"},{id:"M",name:"동요도 (M)"}]},{name:"치아 구조 이상",conditions:[{id:"FX",name:"치아파절 (FX)",subConditions:[{id:"EF",name:"에나멜 파절"},{id:"UCF",name:"치수 비노출파절"},{id:"CCF",name:"치수 노출파절"},{id:"UCRF",name:"치수 비노출 뿌리파절"},{id:"CCRF",name:"치수 노출 뿌리파절"}]},{id:"A",name:"교모/마모 (A)"},{id:"EH",name:"법랑질 형성부전 (EH)"},{id:"E/D",name:"법랑질 결손 (E/D)"},{id:"NV",name:"실활치 (NV)"},{id:"RD",name:"잔존유치 (RD)"},{id:"UC",name:"미맹출치아 (UC)"},{id:"X",name:"발치/결손치 (X)"},{id:"DT",name:"유치 (DT)"},{id:"SN",name:"과잉치 (SN)"},{id:"U",name:"미맹출치 (U)"},{id:"R",name:"회전치 (R)"},{id:"CWD",name:"총생 (CWD)"}]},{name:"기타",conditions:[{id:"TR",name:"치아흡수성병변 (TR)",subConditions:[{id:"T1",name:"Type 1"},{id:"T2",name:"Type 2"},{id:"T3",name:"Type 3"}]},{id:"CN",name:"유착 (CN)"},{id:"RR",name:"잔존치근 (RR)",subConditions:[{id:"IRR",name:"의도적 잔존 치근"},{id:"ORR",name:"존재하던 잔존 치근"}]},{id:"DC",name:"함치성 낭종 (DC)"},{id:"ONF",name:"구비강 누공 (ONF)"},{id:"OM",name:"종양 (OM)"}]}],t$=new Map;function tZ(e){let{data:t,onBack:s}=e,{toast:i}=(0,k.dj)(),{patient:r,costs:l,images:c,dentalData:o,additionalTreatments:m,selectedPackages:u}=t,x=(0,n.useMemo)(()=>(null==c?void 0:c.filter(e=>"general"===e.category))||[],[c]),h=(0,n.useMemo)(()=>r&&r.species&&r.weight?em(r.species,r.weight):null,[r]),p=(0,n.useMemo)(()=>h?eo.flatMap(e=>h[e.id]||[]):[],[h]),j=(0,n.useMemo)(()=>new Map(p.map(e=>[e.id,e])),[p]),y=(0,n.useMemo)(()=>{if(!(null==r?void 0:r.birthDate))return"정보 없음";let e=r.birthDate instanceof d.Dc?r.birthDate.toDate():r.birthDate,t=new Date,s=(0,e5.V)(t,e),a=(0,e6.W)(t,e)%12;return"".concat(s,"세 ").concat(a,"개월")},[null==r?void 0:r.birthDate]),v=(0,n.useMemo)(()=>{if(!o)return[];let e={};return Object.entries(o).forEach(t=>{let[s,a]=t;a.procedures&&a.procedures.length>0&&a.procedures.forEach(t=>{let a=j.get(t);a&&(e[t]?(e[t].count++,e[t].toothIds.push(s)):e[t]={name:a.name,price:a.price,count:1,toothIds:[s]})})}),Object.values(e)},[o,j]),N=n.useMemo(()=>m.filter(e=>"scaling_package"!==e.id&&"anesthesia_package"!==e.id&&!e.id.startsWith("health_checkup")),[m]),w=(0,n.useMemo)(()=>{if(!r||!r.species||!r.weight||!N)return{};let e=es(r);return e.categories?N.reduce((t,s)=>{for(let a of e.categories){let n=e.itemsByCategoryId[a.id];if(null==n?void 0:n.some(e=>e.id===s.id)){t[a.name]||(t[a.name]=[]),t[a.name].push(s);break}}return t},{}):{}},[N,r]),C=((null==l?void 0:l.procedure)||0)+((null==l?void 0:l.additional)||0)+((null==l?void 0:l.anesthesia)||0)+((null==l?void 0:l.checkup)||0);null==r||r.species;let _=e=>{var t;if(!r.species)return"";let s=parseInt(e,10)>=500,a="개"===r.species?"dog":"cat",n=null==(t=tW[s?"deciduous":"permanent"])?void 0:t[a];if(!n)return"";for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&n[t].includes(e))return t;return""},D={incisors:"bg-blue-50",canines:"bg-green-50",premolars:"bg-orange-50",molars:"bg-purple-50"},R={incisors:"앞니 (Incisors)",canines:"송곳니 (Canine)",premolars:"소구치 (Premolars)",molars:"어금니 (Molars)"},A=(e,t)=>{if(!o)return null;let s=e.flatMap(e=>{var t,s,a,n;let i=o[e],r=o[String(parseInt(e,10)+400)],l=[];return i&&((null==(t=i.status)?void 0:t.length)>0||(null==(s=i.procedures)?void 0:s.length)>0)&&l.push(i),i&&(null==(a=i.status)?void 0:a.includes("RD"))&&r&&(null==(n=r.procedures)?void 0:n.length)>0&&l.push({...r,displayId:r.id,mainToothId:e}),l}).filter((e,t,s)=>t===s.findIndex(t=>t.id===e.id));if(0===s.length)return null;let i={incisors:[],canines:[],premolars:[],molars:[]};return(s.forEach(e=>{let t=_(e.mainToothId||e.id);t&&i[t]&&!i[t].find(t=>t.id===e.id)&&i[t].push(e)}),Object.values(i).some(e=>e.length>0))?(0,a.jsx)("div",{className:"quadrant-table",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"w-1/6",children:"번호"}),(0,a.jsx)("th",{className:"w-2/5",children:"상태"}),(0,a.jsx)("th",{className:"w-2/5",children:"시술"}),(0,a.jsx)("th",{className:"w-1/6 text-right",children:"비용"})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"quadrant-title",children:t})}),Object.entries(i).map(e=>{let[t,s]=e;return 0===s.length?null:(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:(0,M.cn)("group-title",D[t]),children:R[t]})}),s.map(e=>{var t;let s=e.displayId||e.id,n=Array.isArray(e.status)?e.status.filter(e=>"RD"!==e&&"DT"!==e):[],{text:i,cost:r}=(t=e.procedures)&&0!==t.length?{text:t.map(e=>{var t;return(null==(t=j.get(e))?void 0:t.name)||e}).join(", "),cost:t.reduce((e,t)=>{var s;return e+((null==(s=j.get(t))?void 0:s.price)||0)},0)}:{text:"-",cost:0};return(0,a.jsxs)("tr",{className:D[_(e.id)],children:[(0,a.jsx)("td",{className:"font-mono font-medium",children:s}),(0,a.jsx)("td",{className:"status-text",children:n&&0!==n.length?n.map(e=>{let t=e,s="",a=e.match(/^([A-Z/]+)(.*)$/);if(a){let n=a[1];t$.has(e)&&t$.get(e).isSub?t=e:t$.has(n)&&!t$.get(n).isSub&&(t=n,s=a[2])}let n=t$.get(t);return n?n.isSub?n.name:s?"".concat(n.name,": ").concat(s).concat(n.unit||""):n.name:e}).join(", "):"-"}),(0,a.jsx)("td",{className:"proc-text",children:i}),(0,a.jsx)("td",{className:"text-right font-mono",children:r>0?"".concat(r.toLocaleString(),"원"):"-"})]},e.id)})]},t)})]})]})}):null};return r?(0,a.jsx)("div",{"data-print-wrapper":!0,children:(0,a.jsx)("div",{className:"bg-background/80 backdrop-blur-sm fixed inset-0 z-40 overflow-y-auto",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto my-8 p-4 sm:p-8 bg-white shadow-2xl rounded-lg","data-print-content":!0,children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white/80 backdrop-blur-sm py-4 mb-4 border-b z-10 flex justify-center gap-4 no-print",children:[(0,a.jsxs)(g.$,{type:"button",variant:"outline",onClick:s,children:[(0,a.jsx)(f.A,{className:"mr-2"})," 뒤로가기"]}),(0,a.jsxs)(g.$,{type:"button",variant:"outline",onClick:()=>{i({title:"준비 중",description:"이미지로 저장하는 기능은 현재 개발 중입니다."})},children:[(0,a.jsx)(tB.A,{className:"mr-2"})," 이미지로 저장"]}),(0,a.jsxs)(g.$,{onClick:()=>{var e;let t=r.surgeryDate?(0,ef.GP)(r.surgeryDate instanceof d.Dc?r.surgeryDate.toDate():r.surgeryDate,"yyyy-MM-dd"):(0,ef.GP)(new Date,"yyyy-MM-dd"),s="".concat(r.name,"_예상비용안내서_").concat(t,".pdf"),a=null==(e=document.getElementById("estimate-print-area"))?void 0:e.innerHTML;if(a){let e=window.open("","_blank");e&&(e.document.write("\n                    <html>\n                        <head>\n                            <title>".concat(s,"</title>\n                            <style>\n                                @page { \n                                  size: A4;\n                                  margin: 0; \n                                }\n                                body { \n                                    font-family: 'Inter', sans-serif; \n                                    line-height: 1.6; \n                                    color: #333;\n                                    padding: 15mm;\n                                    -webkit-print-color-adjust: exact !important;\n                                    print-color-adjust: exact !important;\n                                }\n                                .no-print { display: none; }\n                                @media print {\n                                  .print-instructions { display: none; }\n                                }\n                                .print-instructions {\n                                  text-align: center;\n                                  padding: 1rem;\n                                  background-color: #f2f7ff !important;\n                                  border: 1px dashed #0056b3;\n                                  margin-bottom: 1.5rem;\n                                }\n                                .header { text-align: center; margin-bottom: 2rem; }\n                                .header h1 { font-size: 2em; margin: 0; color: #1a1a1a; }\n                                .header p { font-size: 1.1em; margin: 0; color: #555; }\n                                .section { margin-bottom: 2rem; page-break-inside: avoid; }\n                                .section-title { font-size: 1.4em; font-weight: bold; color: #0056b3; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem; margin-bottom: 1rem; }\n                                .image-gallery { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }\n                                .image-container { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; page-break-inside: avoid; }\n                                .image-container img { width: 100%; height: auto; display: block; }\n                                table { width: 100%; border-collapse: collapse; margin-bottom: 1rem;}\n                                th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; font-size: 11px; }\n                                th { background-color: #f8f9fa !important; font-weight: bold; }\n                                .cost-summary-table td:first-child { width: 70%; }\n                                .cost-summary-table td:nth-child(2) { text-align: right; font-weight: bold; }\n                                .procedure-details-table th:not(:first-child), .procedure-details-table td:not(:first-child) { text-align: right; }\n                                .total-cost-row { font-weight: bold; font-size: 1.2em; }\n                                .total-cost-row td:first-child { text-align: right; }\n                                .footer-note { margin-top: 2.5rem; padding: 1.5rem; background-color: #f2f7ff !important; border-left: 5px solid #0056b3; font-size: 0.95em; }\n                                .hospital-info { text-align: center; margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid #ccc; font-size: 0.9em; color: #666; }\n                                .patient-info-table td:first-child { font-weight: bold; background-color: #f9f9f9 !important; width: 120px; }\n                                .dental-chart-print { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }\n                                .dental-chart-print .quadrant-table { page-break-inside: avoid; }\n                                .dental-chart-print th, .dental-chart-print td { padding: 4px 8px; font-size: 10px; }\n                                .dental-chart-print .quadrant-title { background-color: #3b82f6 !important; color: white !important; font-weight: bold; text-align: center; }\n                                .dental-chart-print .group-title { font-weight: bold; color: #6b7280; }\n                                .bg-blue-50 { background-color: #eff6ff !important; } .bg-green-50 { background-color: #f0fdf4 !important; } .bg-orange-50 { background-color: #fff7ed !important; } .bg-purple-50 { background-color: #faf5ff !important; }\n                                .status-text { background-color: #fefce8 !important; font-size: 9px; }\n                                .proc-text { background-color: #e0f2fe !important; font-size: 9px; }\n                                .additional-treatments-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; page-break-inside: avoid; }\n                                .bg-slate-50 { background-color: #f8fafc !important; }\n                            </style>\n                        </head>\n                        <body>\n                            <div class=\"print-instructions\">\n                              <p>모든 내용이 올바르게 보이는지 확인 후, <strong>Ctrl+P</strong> 또는 <strong>Cmd+P</strong>를 눌러 인쇄하세요.</p>\n                            </div>\n                            ").concat(a,"\n                        </body>\n                    </html>\n                ")),e.document.close(),e.focus())}},children:[(0,a.jsx)(b.A,{className:"mr-2"})," PDF로 저장/인쇄"]})]}),(0,a.jsxs)("div",{id:"estimate-print-area",children:[(0,a.jsxs)("div",{className:"header",children:[(0,a.jsx)(ty.default,{src:"https://raw.githubusercontent.com/ivomec/image/main/Final%20Logo.png",alt:"Hospital Logo",width:120,height:120,className:"mx-auto"}),(0,a.jsx)("h1",{className:"mt-4",children:"예상 비용 안내서"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:r.guardianName})," 보호자님 (환자: ",(0,a.jsx)("strong",{children:r.name}),")"]})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"환자 정보"}),(0,a.jsx)("table",{className:"patient-info-table",children:(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"차트번호"}),(0,a.jsx)("td",{children:r.id})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"환자 이름"}),(0,a.jsx)("td",{children:r.name})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"종/품종"}),(0,a.jsxs)("td",{children:[r.species," / ",r.breed]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"나이"}),(0,a.jsx)("td",{children:y})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"성별/중성화"}),(0,a.jsxs)("td",{children:[r.gender," / ",r.isNeutered?"완료":"미완료"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"몸무게"}),(0,a.jsxs)("td",{children:[r.weight," kg"]})]})]})})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"치과 차트 요약 (예상 시술)"}),(0,a.jsxs)("div",{className:"dental-chart-print",children:[(0,a.jsxs)("div",{className:"quadrant-container",children:[A(tO.permanent.upperRight,"우측 - 상악"),A(tO.permanent.lowerRight,"우측 - 하악")]}),(0,a.jsxs)("div",{className:"quadrant-container",children:[A(tO.permanent.upperLeft,"좌측 - 상악"),A(tO.permanent.lowerLeft,"좌측 - 하악")]})]})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"환자 사진"}),x.length>0?(0,a.jsx)("div",{className:"image-gallery",children:x.map(e=>(0,a.jsx)("div",{className:"image-container",children:(0,a.jsx)(ty.default,{src:e.imageUrl,alt:"환자 일반 사진",width:200,height:200,style:{width:"100%",height:"auto"}})},e.id))}):(0,a.jsx)("p",{children:"업로드된 일반 사진이 없습니다."})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"패키지 항목"}),u.length>0?(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsx)("ul",{className:"space-y-1.5 text-sm text-muted-foreground",children:u.map(e=>(0,a.jsxs)("li",{className:"flex justify-between text-base",children:[(0,a.jsx)("span",{className:"pr-2",children:e.name}),(0,a.jsxs)("span",{className:"font-mono whitespace-nowrap",children:[e.price.toLocaleString(),"원"]})]},e.id+e.optionKey))})}):(0,a.jsx)("p",{children:"선택된 패키지 항목이 없습니다."})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"추가 처치 항목"}),N&&N.length>0?(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsx)("div",{className:"additional-treatments-grid",children:Object.entries(w).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"break-inside-avoid",children:[(0,a.jsx)("h5",{className:"text-base font-medium text-gray-800 mb-2",children:t}),(0,a.jsx)("ul",{className:"space-y-1.5 text-sm text-muted-foreground",children:s.map(e=>(0,a.jsxs)("li",{className:"flex justify-between text-base",children:[(0,a.jsx)("span",{className:"pr-2",children:e.name}),(0,a.jsxs)("span",{className:"font-mono whitespace-nowrap",children:[e.price.toLocaleString(),"원"]})]},e.id+e.optionKey))})]},t)})})}):(0,a.jsx)("p",{children:"선택된 추가 처치 항목이 없습니다."})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"비용 정보"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("table",{className:"cost-summary-table",children:(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"치과 수술 비용"}),(0,a.jsxs)("td",{children:[(l.procedure||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"스케일링 패키지 비용"}),(0,a.jsxs)("td",{children:[(l.anesthesia||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"건강검진 비용"}),(0,a.jsxs)("td",{children:[(l.checkup||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"추가 처치 비용"}),(0,a.jsxs)("td",{children:[(l.additional||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{className:"total-cost-row",children:[(0,a.jsx)("td",{className:"text-right",children:"총 예상 비용:"}),(0,a.jsxs)("td",{children:[C.toLocaleString()," 원"]})]})]})}),v.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold",children:"시술 비용 상세 내역"}),(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsxs)(S.XI,{className:"procedure-details-table",children:[(0,a.jsx)(S.A0,{children:(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nd,{className:"text-base",children:"시술명"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"단가"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"횟수"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"합계"})]})}),(0,a.jsx)(S.BF,{children:v.map((e,t)=>(0,a.jsxs)(S.Hj,{children:[(0,a.jsxs)(S.nA,{className:"text-base",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:r.species&&e.toothIds.map(e=>er(e,r.species)).join(", ")})]}),(0,a.jsxs)(S.nA,{className:"text-right font-mono text-base",children:[e.price.toLocaleString(),"원"]}),(0,a.jsx)(S.nA,{className:"text-right font-mono text-base",children:e.count}),(0,a.jsxs)(S.nA,{className:"text-right font-mono text-base",children:[(e.price*e.count).toLocaleString(),"원"]})]},"".concat(e.name,"-").concat(t)))})]})})]})]})]}),(0,a.jsxs)("div",{className:"footer-note",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"안내 말씀"})}),(0,a.jsx)("p",{children:"본 예상 비용 안내서는 현재까지의 환자 사진과 구강 상태에 대한 시각적 평가를 바탕으로 산출된 개략적인 금액입니다. 수술 당일, 마취 후 진행되는 정밀 구강 검사 및 방사선 촬영 결과에 따라, 숨어있는 추가적인 문제(치근단 농양, 치아 흡수성 병변, 치주 질환 등)가 발견될 수 있습니다."}),(0,a.jsx)("p",{children:"이러한 경우, 아이의 통증을 없애고 삶의 질을 높이기 위해 꼭 필요한 추가적인 치료가 진행될 수 있으며, 이에 따라 최종 비용에는 변동이 발생할 수 있음을 미리 안내해 드립니다. 저희는 항상 보호자님과 충분히 소통하며 최선의 치료를 약속드립니다."})]}),(0,a.jsxs)("div",{className:"hospital-info",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"치과 특화 금호동물병원"})}),(0,a.jsx)("p",{children:"광주 광역시 서구 금호동 금화로54 거북빌딩 1층 110호"}),(0,a.jsx)("p",{children:"Tel: 062-383-7572"})]})]})]})})}):null}tH.forEach(e=>{e.conditions.forEach(e=>{let t=e.name.replace(/\s\(.*\)/,"");t$.set(e.id,{name:t,isSub:!1}),e.subConditions&&e.subConditions.forEach(t=>{t$.set(t.id,{name:t.name,isSub:!0,parentId:e.id})})})});let tG={permanent:{dog:{incisors:["101","102","103","201","202","203","301","302","303","401","402","403"],canines:["104","204","304","404"],premolars:["105","106","107","108","205","206","207","208","305","306","307","308","405","406","407","408"],molars:["109","110","209","210","309","310","311","409","410","411"]},cat:{incisors:["101","102","103","201","202","203","301","302","303","401","402","403"],canines:["104","204","304","404"],premolars:["106","107","108","206","207","208","307","308","407","408"],molars:["109","209","309","409"]}},deciduous:{dog:{incisors:["501","502","503","601","602","603","701","702","703","801","802","803"],canines:["504","604","704","804"],premolars:["505","506","507","508","605","606","607","608","705","706","707","708","805","806","807","808"]},cat:{incisors:["501","502","503","601","602","603","701","702","703","801","802","803"],canines:["504","604","704","804"],premolars:["506","507","508","606","607","608","707","708","807","808"]}}},tK={permanent:{upperRight:["101","102","103","104","105","106","107","108","109","110"],upperLeft:["201","202","203","204","205","206","207","208","209","210"],lowerRight:["401","402","403","404","405","406","407","408","409","410","411"],lowerLeft:["301","302","303","304","305","306","307","308","309","310","311"]}},tq=[{name:"치주 질환",conditions:[{id:"PD",name:"치주염 (PD)"},{id:"GI",name:"치은염 (GI)"},{id:"GH",name:"치은 증식 (GH)"},{id:"PPD",name:"치주낭 (PPD)"},{id:"GR",name:"치은퇴축 (GR)"},{id:"CAL",name:"치은부착소실 (CAL)"},{id:"F",name:"치근분지부 노출 (F)"},{id:"M",name:"동요도 (M)"}]},{name:"치아 구조 이상",conditions:[{id:"FX",name:"치아파절 (FX)",subConditions:[{id:"EF",name:"에나멜 파절"},{id:"UCF",name:"치수 비노출파절"},{id:"CCF",name:"치수 노출파절"},{id:"UCRF",name:"치수 비노출 뿌리파절"},{id:"CCRF",name:"치수 노출 뿌리파절"}]},{id:"A",name:"교모/마모 (A)"},{id:"EH",name:"법랑질 형성부전 (EH)"},{id:"E/D",name:"법랑질 결손 (E/D)"},{id:"NV",name:"실활치 (NV)"},{id:"RD",name:"잔존유치 (RD)"},{id:"UC",name:"미맹출치아 (UC)"},{id:"X",name:"발치/결손치 (X)"},{id:"DT",name:"유치 (DT)"},{id:"SN",name:"과잉치 (SN)"},{id:"U",name:"미맹출치 (U)"},{id:"R",name:"회전치 (R)"},{id:"CWD",name:"총생 (CWD)"}]},{name:"기타",conditions:[{id:"TR",name:"치아흡수성병변 (TR)",subConditions:[{id:"T1",name:"Type 1"},{id:"T2",name:"Type 2"},{id:"T3",name:"Type 3"}]},{id:"CN",name:"유착 (CN)"},{id:"RR",name:"잔존치근 (RR)",subConditions:[{id:"IRR",name:"의도적 잔존 치근"},{id:"ORR",name:"존재하던 잔존 치근"}]},{id:"DC",name:"함치성 낭종 (DC)"},{id:"ONF",name:"구비강 누공 (ONF)"},{id:"OM",name:"종양 (OM)"}]}],tU=new Map;function tV(e){let{data:t,onBack:s}=e,{toast:i}=(0,k.dj)(),{patient:r,costs:l,images:c,dentalData:o,additionalTreatments:m,selectedPackages:u}=t,x=(0,n.useMemo)(()=>(null==c?void 0:c.filter(e=>"pre-surgery"===e.category))||[],[c]),h=(0,n.useMemo)(()=>(null==c?void 0:c.filter(e=>"post-surgery"===e.category))||[],[c]),p=(0,n.useMemo)(()=>r&&r.species&&r.weight?em(r.species,r.weight):null,[r]),j=(0,n.useMemo)(()=>p?eo.flatMap(e=>p[e.id]||[]):[],[p]),y=(0,n.useMemo)(()=>new Map(j.map(e=>[e.id,e])),[j]),v=(0,n.useMemo)(()=>{if(!(null==r?void 0:r.birthDate))return"정보 없음";let e=r.birthDate instanceof d.Dc?r.birthDate.toDate():r.birthDate,t=new Date,s=(0,e5.V)(t,e),a=(0,e6.W)(t,e)%12;return"".concat(s,"세 ").concat(a,"개월")},[null==r?void 0:r.birthDate]),N=(0,n.useMemo)(()=>{if(!o)return[];let e={};return Object.entries(o).forEach(t=>{let[s,a]=t;a.procedures&&a.procedures.length>0&&a.procedures.forEach(t=>{let a=y.get(t);a&&(e[t]?(e[t].count++,e[t].toothIds.push(s)):e[t]={name:a.name,price:a.price,count:1,toothIds:[s]})})}),Object.values(e)},[o,y]),w=n.useMemo(()=>m.filter(e=>"scaling_package"!==e.id&&"anesthesia_package"!==e.id&&!e.id.startsWith("health_checkup")),[m]),C=(0,n.useMemo)(()=>{if(!r||!r.species||!r.weight||!w)return{};let e=es(r);return e.categories?w.reduce((t,s)=>{for(let a of e.categories){let n=e.itemsByCategoryId[a.id];if(null==n?void 0:n.some(e=>e.id===s.id)){t[a.name]||(t[a.name]=[]),t[a.name].push(s);break}}return t},{}):{}},[w,r]),_=((null==l?void 0:l.procedure)||0)+((null==l?void 0:l.additional)||0)+((null==l?void 0:l.anesthesia)||0)+((null==l?void 0:l.checkup)||0),D=(null==r?void 0:r.species)==="개",R=e=>{var t;if(!r.species)return"";let s=parseInt(e,10)>=500,a="개"===r.species?"dog":"cat",n=null==(t=tG[s?"deciduous":"permanent"])?void 0:t[a];if(!n)return"";for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&n[t].includes(e))return t;return""},A={incisors:"bg-blue-50",canines:"bg-green-50",premolars:"bg-orange-50",molars:"bg-purple-50"},F={incisors:"앞니 (Incisors)",canines:"송곳니 (Canine)",premolars:"소구치 (Premolars)",molars:"어금니 (Molars)"},L=(e,t)=>{if(!o)return null;let s=D?"dog":"cat",i=e.filter(e=>{let t=R(e),a=tG.permanent[s];return t&&a[t]&&a[t].includes(e)}),r={incisors:[],canines:[],premolars:[],molars:[]};return(i.forEach(e=>{var t,s;let a=o[e];if(a&&((null==(t=a.status)?void 0:t.length)>0||(null==(s=a.procedures)?void 0:s.length)>0)){let t=R(e);t&&r[t]&&r[t].push(a)}}),Object.values(r).some(e=>e.length>0))?(0,a.jsx)("div",{className:"quadrant-table",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"w-1/6",children:"번호"}),(0,a.jsx)("th",{className:"w-2/5",children:"상태"}),(0,a.jsx)("th",{className:"w-2/5",children:"시술"}),(0,a.jsx)("th",{className:"w-1/6 text-right",children:"비용"})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"quadrant-title",children:t})}),Object.entries(r).map(e=>{let[t,s]=e;return 0===s.length?null:(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:(0,M.cn)("group-title",A[t]),children:F[t]})}),s.map(e=>{var t;let s=Array.isArray(e.status)?e.status:[],{text:n,cost:i}=(t=e.procedures)&&0!==t.length?{text:t.map(e=>{var t;return(null==(t=y.get(e))?void 0:t.name)||e}).join(", "),cost:t.reduce((e,t)=>{var s;return e+((null==(s=y.get(t))?void 0:s.price)||0)},0)}:{text:"-",cost:0};return(0,a.jsxs)("tr",{className:A[R(e.id)],children:[(0,a.jsx)("td",{className:"font-mono font-medium",children:e.id}),(0,a.jsx)("td",{className:"status-text",children:s&&0!==s.length?s.map(e=>{let t=e,s="",a=e.match(/^([A-Z/]+)(.*)$/);if(a){let n=a[1];tU.has(e)&&tU.get(e).isSub?t=e:tU.has(n)&&!tU.get(n).isSub&&(t=n,s=a[2])}let n=tU.get(t);return n?n.isSub?n.name:s?"".concat(n.name,": ").concat(s).concat(n.unit||""):n.name:e}).join(", "):"-"}),(0,a.jsx)("td",{className:"proc-text",children:n}),(0,a.jsx)("td",{className:"text-right font-mono",children:i>0?"".concat(i.toLocaleString(),"원"):"-"})]},e.id)})]},t)})]})]})}):null};return r?(0,a.jsx)("div",{"data-print-wrapper":!0,children:(0,a.jsx)("div",{className:"bg-background/80 backdrop-blur-sm fixed inset-0 z-40 overflow-y-auto",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto my-8 p-4 sm:p-8 bg-white shadow-2xl rounded-lg","data-print-content":!0,children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-white/80 backdrop-blur-sm py-4 mb-4 border-b z-10 flex justify-center gap-4 no-print",children:[(0,a.jsxs)(g.$,{type:"button",variant:"outline",onClick:s,children:[(0,a.jsx)(f.A,{className:"mr-2"})," 뒤로가기"]}),(0,a.jsxs)(g.$,{type:"button",variant:"outline",onClick:()=>{i({title:"준비 중",description:"이미지로 저장하는 기능은 현재 개발 중입니다."})},children:[(0,a.jsx)(tB.A,{className:"mr-2"})," 이미지로 저장"]}),(0,a.jsxs)(g.$,{onClick:()=>{var e;let t=r.surgeryDate?(0,ef.GP)(r.surgeryDate instanceof d.Dc?r.surgeryDate.toDate():r.surgeryDate,"yyyy-MM-dd"):(0,ef.GP)(new Date,"yyyy-MM-dd"),s="".concat(r.name,"_수술기록서_").concat(t),a=null==(e=document.getElementById("record-print-area"))?void 0:e.innerHTML;if(a){let e=window.open("","_blank");e&&(e.document.write("\n                    <html>\n                        <head>\n                            <title>".concat(s,"</title>\n                            <style>\n                                @page { \n                                  size: A4;\n                                  margin: 0; \n                                }\n                                body { \n                                    font-family: 'Inter', sans-serif; \n                                    line-height: 1.6; \n                                    color: #333;\n                                    padding: 15mm;\n                                    -webkit-print-color-adjust: exact !important;\n                                    print-color-adjust: exact !important;\n                                }\n                                .no-print { display: none; }\n                                @media print {\n                                  .print-instructions { display: none; }\n                                }\n                                .print-instructions {\n                                  text-align: center;\n                                  padding: 1rem;\n                                  background-color: #f2f7ff !important;\n                                  border: 1px dashed #0056b3;\n                                  margin-bottom: 1.5rem;\n                                }\n                                .header { text-align: center; margin-bottom: 2rem; }\n                                .header h1 { font-size: 2em; margin: 0; color: #1a1a1a; }\n                                .header p { font-size: 1.1em; margin: 0; color: #555; }\n                                .section { margin-bottom: 2rem; page-break-inside: avoid; }\n                                .section-title { font-size: 1.4em; font-weight: bold; color: #0056b3; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem; margin-bottom: 1rem; }\n                                .image-gallery { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }\n                                .image-container { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; page-break-inside: avoid; }\n                                .image-container img { width: 100%; height: auto; display: block; }\n                                table { width: 100%; border-collapse: collapse; margin-bottom: 1rem;}\n                                th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; font-size: 11px; }\n                                th { background-color: #f8f9fa !important; font-weight: bold; }\n                                .cost-summary-table td:first-child { width: 70%; }\n                                .cost-summary-table td:nth-child(2) { text-align: right; font-weight: bold; }\n                                .procedure-details-table th:not(:first-child), .procedure-details-table td:not(:first-child) { text-align: right; }\n                                .total-cost-row { font-weight: bold; font-size: 1.2em; }\n                                .total-cost-row td:first-child { text-align: right; }\n                                .footer-note { margin-top: 2.5rem; padding: 1.5rem; background-color: #f2f7ff !important; border-left: 5px solid #0056b3; font-size: 0.95em; }\n                                .hospital-info { text-align: center; margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid #ccc; font-size: 0.9em; color: #666; }\n                                .patient-info-table td:first-child { font-weight: bold; background-color: #f9f9f9 !important; width: 120px; }\n                                .dental-chart-print { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }\n                                .dental-chart-print .quadrant-table { page-break-inside: avoid; }\n                                .dental-chart-print th, .dental-chart-print td { padding: 4px 8px; font-size: 10px; }\n                                .dental-chart-print .quadrant-title { background-color: #3b82f6 !important; color: white !important; font-weight: bold; text-align: center; }\n                                .dental-chart-print .group-title { font-weight: bold; color: #6b7280; }\n                                .bg-blue-50 { background-color: #eff6ff !important; } .bg-green-50 { background-color: #f0fdf4 !important; } .bg-orange-50 { background-color: #fff7ed !important; } .bg-purple-50 { background-color: #faf5ff !important; }\n                                .status-text { background-color: #fefce8 !important; font-size: 9px; }\n                                .proc-text { background-color: #e0f2fe !important; font-size: 9px; }\n                                .additional-treatments-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; page-break-inside: avoid; }\n                                .bg-slate-50 { background-color: #f8fafc !important; }\n                            </style>\n                        </head>\n                        <body>\n                            <div class=\"print-instructions\">\n                              <p>모든 내용이 올바르게 보이는지 확인 후, <strong>Ctrl+P</strong> 또는 <strong>Cmd+P</strong>를 눌러 인쇄하세요.</p>\n                            </div>\n                            ").concat(a,"\n                        </body>\n                    </html>\n                ")),e.document.close(),e.focus())}},children:[(0,a.jsx)(b.A,{className:"mr-2"})," PDF로 저장/인쇄"]})]}),(0,a.jsxs)("div",{id:"record-print-area",children:[(0,a.jsxs)("div",{className:"header",children:[(0,a.jsx)(ty.default,{src:"https://raw.githubusercontent.com/ivomec/image/main/Final%20Logo.png",alt:"Hospital Logo",width:120,height:120,className:"mx-auto"}),(0,a.jsx)("h1",{className:"mt-4",children:"수술 기록 안내서"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:r.guardianName})," 보호자님 (환자: ",(0,a.jsx)("strong",{children:r.name}),")"]})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"환자 정보"}),(0,a.jsx)("table",{className:"patient-info-table",children:(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"차트번호"}),(0,a.jsx)("td",{children:r.id})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"환자 이름"}),(0,a.jsx)("td",{children:r.name})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"종/품종"}),(0,a.jsxs)("td",{children:[r.species," / ",r.breed]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"나이"}),(0,a.jsx)("td",{children:v})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"성별/중성화"}),(0,a.jsxs)("td",{children:[r.gender," / ",r.isNeutered?"완료":"미완료"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"몸무게"}),(0,a.jsxs)("td",{children:[r.weight," kg"]})]})]})})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"치과 차트"}),(0,a.jsxs)("div",{className:"dental-chart-print",children:[(0,a.jsxs)("div",{className:"quadrant-container",children:[L(tK.permanent.upperRight,"우측 - 상악"),L(tK.permanent.lowerRight,"우측 - 하악")]}),(0,a.jsxs)("div",{className:"quadrant-container",children:[L(tK.permanent.upperLeft,"좌측 - 상악"),L(tK.permanent.lowerLeft,"좌측 - 하악")]})]})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"수술 전 X-Ray"}),x.length>0?(0,a.jsx)("div",{className:"image-gallery",children:x.map(e=>(0,a.jsx)("div",{className:"image-container",children:(0,a.jsx)(ty.default,{src:e.imageUrl,alt:"수술 전 X-Ray",width:200,height:200,style:{width:"100%",height:"auto"}})},e.id))}):(0,a.jsx)("p",{children:"업로드된 수술 전 X-Ray 사진이 없습니다."})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"수술 후 X-Ray"}),h.length>0?(0,a.jsx)("div",{className:"image-gallery",children:h.map(e=>(0,a.jsx)("div",{className:"image-container",children:(0,a.jsx)(ty.default,{src:e.imageUrl,alt:"수술 후 X-Ray",width:200,height:200,style:{width:"100%",height:"auto"}})},e.id))}):(0,a.jsx)("p",{children:"업로드된 수술 후 X-Ray 사진이 없습니다."})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"패키지 항목"}),u.length>0?(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsx)("ul",{className:"space-y-1.5 text-sm text-muted-foreground",children:u.map(e=>(0,a.jsxs)("li",{className:"flex justify-between text-base",children:[(0,a.jsx)("span",{className:"pr-2",children:e.name}),(0,a.jsxs)("span",{className:"font-mono whitespace-nowrap",children:[e.price.toLocaleString(),"원"]})]},e.id+e.optionKey))})}):(0,a.jsx)("p",{children:"선택된 패키지 항목이 없습니다."})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"추가 처치 항목"}),w&&w.length>0?(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsx)("div",{className:"additional-treatments-grid",children:Object.entries(C).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"break-inside-avoid",children:[(0,a.jsx)("h5",{className:"text-base font-medium text-gray-800 mb-2",children:t}),(0,a.jsx)("ul",{className:"space-y-1.5 text-sm text-muted-foreground",children:s.map(e=>(0,a.jsxs)("li",{className:"flex justify-between text-base",children:[(0,a.jsx)("span",{className:"pr-2",children:e.name}),(0,a.jsxs)("span",{className:"font-mono whitespace-nowrap",children:[e.price.toLocaleString(),"원"]})]},e.id+e.optionKey))})]},t)})})}):(0,a.jsx)("p",{children:"선택된 추가 처치 항목이 없습니다."})]}),(0,a.jsxs)("div",{className:"section",children:[(0,a.jsx)("h2",{className:"section-title",children:"최종 비용 정보"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("table",{className:"cost-summary-table",children:(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"치과 수술 비용"}),(0,a.jsxs)("td",{children:[(l.procedure||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"스케일링 패키지 비용"}),(0,a.jsxs)("td",{children:[(l.anesthesia||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"건강검진 비용"}),(0,a.jsxs)("td",{children:[(l.checkup||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:"추가 처치 비용"}),(0,a.jsxs)("td",{children:[(l.additional||0).toLocaleString()," 원"]})]}),(0,a.jsxs)("tr",{className:"total-cost-row",children:[(0,a.jsx)("td",{className:"text-right",children:"총 최종 비용:"}),(0,a.jsxs)("td",{children:[_.toLocaleString()," 원"]})]})]})}),N.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold",children:"시술 비용 상세 내역"}),(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-50",children:(0,a.jsxs)(S.XI,{className:"procedure-details-table",children:[(0,a.jsx)(S.A0,{children:(0,a.jsxs)(S.Hj,{children:[(0,a.jsx)(S.nd,{className:"text-base",children:"시술명"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"단가"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"횟수"}),(0,a.jsx)(S.nd,{className:"text-right text-base",children:"합계"})]})}),(0,a.jsx)(S.BF,{children:N.map((e,t)=>(0,a.jsxs)(S.Hj,{children:[(0,a.jsxs)(S.nA,{className:"text-base",children:[(0,a.jsx)("div",{children:e.name}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:r.species&&e.toothIds.map(e=>er(e,r.species)).join(", ")})]}),(0,a.jsxs)(S.nA,{className:"text-right font-mono text-base",children:[e.price.toLocaleString(),"원"]}),(0,a.jsx)(S.nA,{className:"text-right font-mono text-base",children:e.count}),(0,a.jsxs)(S.nA,{className:"text-right font-mono text-base",children:[(e.price*e.count).toLocaleString(),"원"]})]},"".concat(e.name,"-").concat(t)))})]})})]})]})]}),(0,a.jsxs)("div",{className:"footer-note",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"안내 말씀"})}),(0,a.jsxs)("p",{children:["오늘 ",r.name,"의 치과 수술이 무사히 끝났습니다. 아이의 회복을 위해 최선을 다했으며, 위 기록은 오늘 진행된 수술의 모든 내용을 정리한 것입니다. 퇴원약 복용과 주의사항을 잘 지켜주시고, 궁금한 점이 있으시면 언제든 병원으로 연락주세요. ",((e,t)=>{if(!e)return e;let s=e.charCodeAt(e.length-1);return s<44032||s>55203?e+("을/를"===t?"을":""):"을/를"===t?e+((s-44032)%28>0?"을":"를"):e})(r.name,"을/를")," 저희에게 믿고 맡겨주셔서 진심으로 감사합니다."]})]}),(0,a.jsxs)("div",{className:"hospital-info",children:[(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"치과 특화 금호동물병원"})}),(0,a.jsx)("p",{children:"광주 광역시 서구 금호동 금화로54 거북빌딩 1층 110호"}),(0,a.jsx)("p",{children:"Tel: 062-383-7572"})]})]})]})})}):null}tq.forEach(e=>{e.conditions.forEach(e=>{let t=e.name.replace(/\s\(.*\)/,"");tU.set(e.id,{name:t,isSub:!1}),e.subConditions&&e.subConditions.forEach(t=>{tU.set(t.id,{name:t.name,isSub:!0,parentId:e.id})})})});let tX=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("textarea",{className:(0,M.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});tX.displayName="Textarea";var tY=s(4817),tJ=s(5225),tQ=s(4550),t0=s(805),t1=s(8772),t2=s(4246),t4=s(8257);let t3={liver:[{id:"ALKP",aliases:["ALKP"]},{id:"ALT",aliases:["ALT"]},{id:"GGT",aliases:["GGT"]},{id:"T-bil",aliases:["Bilirubin-Total","T-bil"]}],blood:[{id:"WBC",aliases:["WBC"]},{id:"RBC",aliases:["RBC"]},{id:"Hct",aliases:["Hematocrit","Hct"]},{id:"Plt",aliases:["Platelet","Plt"]}],kidney:[{id:"SDMA",aliases:["SDMA"]},{id:"Creatinine",aliases:["Creatinine","cre"]},{id:"BUN",aliases:["BUN"]}],heart:[{id:"Murmur",aliases:["Murmur"]},{id:"VLAS",aliases:["VLAS"]},{id:"VHS",aliases:["VHS"]}]},t5={heart:(0,a.jsx)(eV.A,{className:"h-4 w-4 text-red-500"}),liver:(0,a.jsx)(P.A,{className:"h-4 w-4 text-orange-500"}),kidney:(0,a.jsx)(eu.A,{className:"h-4 w-4 text-blue-500"}),blood:(0,a.jsx)(eU.A,{className:"h-4 w-4 text-rose-500"})},t6={heart:"심장",liver:"간",kidney:"신장",blood:"혈구"},t8={heart:"hasHeartCondition",liver:"hasLiverCondition",kidney:"hasKidneyCondition",blood:"hasBloodCondition"},t7=n.memo(e=>{let{patientId:t,initialAnalysisResult:s,initialAnalysisText:i}=e,{setValue:r,control:l}=(0,o.xW)(),[c,m]=n.useState(!1),[u,h]=n.useState(i),[p,f]=n.useState(s),[b,v]=n.useState(!s),[N,w]=n.useState("idle"),{toast:S}=(0,k.dj)(),D=n.useRef(null);n.useEffect(()=>{f(s),h(i),v(!s)},[s,i]);let R=async e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){f(null);try{let e="";if(s.type.includes("spreadsheetml")||s.name.endsWith(".xlsx")||s.name.endsWith(".xls")){let t=await s.arrayBuffer(),a=t2.LF(t);a.SheetNames.forEach(t=>{let s=a.Sheets[t],n=t2.Wp.sheet_to_json(s,{header:1,defval:""}).filter(e=>Array.isArray(e)&&e.some(e=>null!==e&&""!==e)).map(e=>e.join("	")).join("\n");e+=n+"\n\n"})}else{if(!("text/html"===s.type||s.name.endsWith(".html")))return void S({title:"지원하지 않는 파일 형식",description:"엑셀(.xlsx, .xls) 또는 HTML 파일만 지원합니다.",variant:"destructive"});let t=await s.text();e=t4.Hh(t)("body").text()}h(e),S({title:"파일 로드 성공",description:"".concat(s.name,"의 내용이 텍스트 영역에 로드되었습니다.")})}catch(e){console.error("File reading error:",e),S({title:"파일 읽기 오류",description:"파일을 읽는 중 오류가 발생했습니다.",variant:"destructive"})}finally{D.current&&(D.current.value="")}}},A=async()=>{w("saving");try{let e=(0,d.H9)(x.db,"patients",t);await (0,d.mZ)(e,{analysisResult:p,analysisText:u}),w("saved"),setTimeout(()=>w("idle"),2e3),S({title:"저장 완료",description:"분석 결과가 차트에 저장되었습니다."})}catch(e){console.error("Error saving analysis:",e),w("idle"),S({title:"저장 실패",description:"분석 결과 저장 중 오류가 발생했습니다.",variant:"destructive"})}};return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h3",{className:"text-base font-semibold flex items-center gap-2 mb-2",children:[(0,a.jsx)(tJ.A,{}),"검사 결과 분석"]}),!b&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(g.$,{type:"button",onClick:()=>{f(null),h(""),v(!0)},variant:"outline",size:"sm",children:[(0,a.jsx)(tQ.A,{className:"mr-2 h-4 w-4"})," 새로 분석하기"]}),(0,a.jsxs)(g.$,{type:"button",onClick:A,variant:"outline",size:"sm",disabled:"idle"!==N,children:["saving"===N&&(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4 animate-spin"}),"saved"===N&&(0,a.jsx)(_.A,{className:"mr-2 h-4 w-4 text-green-600"}),"idle"===N&&(0,a.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"saved"===N?"저장됨":"추출 결과 저장"]})]}),b&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.BT,{className:"text-xs",children:"혈액 검사 결과 등 텍스트를 붙여넣거나 파일을 업로드하여 분석하세요."}),(0,a.jsx)("input",{type:"file",ref:D,onChange:R,className:"hidden",accept:".xlsx, .xls, .html, .htm"}),(0,a.jsx)(tX,{placeholder:"이곳에 검사 결과 텍스트를 붙여넣으세요...",rows:6,value:u,onChange:e=>{h(e.target.value)}}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(g.$,{type:"button",onClick:()=>{if(!u.trim())return void S({title:"오류",description:"분석할 텍스트를 입력해주세요.",variant:"destructive"});m(!0);try{let e=u.split("\n"),t={liver:[],blood:[],kidney:[],heart:[]},s={liver:new Set,blood:new Set,kidney:new Set,heart:new Set},a=Object.entries(t3).flatMap(e=>{let[t,s]=e;return s.map(e=>({...e,category:t}))});e.forEach(e=>{let n=e.trim();if(!n)return;let i=a.find(e=>e.aliases.some(e=>{let t=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]");return("WBC"===e.toUpperCase()?RegExp("^".concat(t,"(?![\\-%#a-zA-Z])\\b"),"i"):"BUN"===e.toUpperCase()?RegExp("^".concat(t,"(?!\\/)"),"i"):RegExp("^".concat(t,"\\b"),"i")).test(n)}));if(i){let e=n.includes("▲")||n.includes("▼");if("murmur"===i.id.toLowerCase()){let t=n.match(/(\d+)\/6/);e=!!t&&parseInt(t[1],10)>=3}let a=n.replace(/\s*\(.*\)\s*/,"").split(/\s+/),r=a.find(e=>/[▲▼]/.test(e)||!isNaN(parseFloat(e)))||a[a.length-1]||"",l="".concat(i.id," ").concat(r);t[i.category]&&t[i.category].push(l),e&&s[i.category].add(i.id)}}),f(t),r("hasLiverCondition",s.liver.size>=2,{shouldDirty:!0}),r("hasBloodCondition",s.blood.size>=2,{shouldDirty:!0}),r("hasKidneyCondition",s.kidney.size>=2,{shouldDirty:!0}),r("hasHeartCondition",s.heart.size>=2,{shouldDirty:!0}),S({title:"추출 완료",description:"핵심 항목이 아래 카드에 표시되고 이상 상태가 업데이트되었습니다."}),v(!1)}catch(e){console.error("항목 추출 중 오류 발생:",e),S({title:"추출 실패",description:e.message||"알 수 없는 오류가 발생했습니다.",variant:"destructive"})}finally{m(!1)}},disabled:c,children:[(0,a.jsx)(t0.A,{className:"mr-2"})," ",c?"추출 중...":"핵심 항목 추출"]}),(0,a.jsxs)(g.$,{type:"button",variant:"outline",onClick:()=>{var e;return null==(e=D.current)?void 0:e.click()},disabled:c,children:[(0,a.jsx)(t1.A,{className:"mr-2"})," 파일 업로드하여 분석"]})]})]}),p&&(0,a.jsx)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-2",children:Object.keys(p).map(e=>(0,a.jsxs)(j.Zp,{children:[(0,a.jsxs)(j.aR,{className:"flex-row items-center justify-between space-y-0 p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t5[e],(0,a.jsx)(j.ZB,{className:"text-sm font-semibold",children:t6[e]})]}),(0,a.jsx)(e2.zB,{control:l,name:t8[e],render:e=>{let{field:t}=e;return(0,a.jsx)(e2.eI,{className:"flex flex-row items-center space-x-2 space-y-0",children:(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(T,{checked:t.value,onCheckedChange:t.onChange})})})}})]}),(0,a.jsx)(j.Wu,{className:"p-3 pt-0",children:p[e].length>0?(0,a.jsx)("ul",{className:"space-y-1 text-xs",children:p[e].map((e,t)=>(0,a.jsx)("li",{className:(0,M.cn)("font-mono",(e.includes("▲")||e.includes("▼"))&&"text-red-600 font-bold"),children:e},t))}):(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"해당 항목 없음"})})]},e))})]})}),t9=n.memo(e=>{let{patientId:t}=e,{control:s}=(0,o.xW)(),{analysisResult:n,analysisText:i}=tS(t);return(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(j.aR,{children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(tY.A,{}),"특이사항"]})}),(0,a.jsxs)(j.Wu,{className:"space-y-8",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,a.jsx)(e2.zB,{control:s,name:"detailedFindings",render:e=>{let{field:t}=e;return(0,a.jsxs)(e2.eI,{children:[(0,a.jsx)(e2.lR,{children:"상세 소견 기록"}),(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(tX,{placeholder:"혈액 검사 AI 요약, 특이 사항 등 상세 내용을 기록하세요.",...t,value:t.value||"",rows:6})}),(0,a.jsx)(e2.C5,{})]})}})}),(0,a.jsx)("div",{className:"border-t pt-6",children:(0,a.jsx)(t7,{patientId:t,initialAnalysisResult:n,initialAnalysisText:i||""})})]})]})});var se=s(1719);let st=n.memo(e=>{let{patient:t,selectedPackages:s,onPackagesChange:i,setCosts:r}=e,{watch:l}=(0,o.xW)(),[c,d]=n.useState(null),m=l("species"),u=l("weight"),x=n.useMemo(()=>m&&u?(e=>{let{species:t,weight:s}=e;if(!t||!s||s<=0)return null;let a="개"===t?"dog":"cat",n=Q(s,t);return{categories:[{id:"scalingPackages",name:"스케일링 & 마취",description:"스케일링 및 마취 관련 패키지"},{id:"checkupPackages",name:"건강검진",description:"건강검진 패키지를 선택합니다."}],itemsByCategoryId:{scalingPackages:[{id:"scaling_package",name:"스케일링 패키지",category:"scaling",options:[{key:"full_scaling",label:"스케일링 패키지",price:et.scalingPackage[a][n]||0}]},{id:"anesthesia_package",name:"스케일링 제외 패키지",category:"scaling",options:[{key:"anesthesia_only",label:"치과 수술 마취",price:et.anesthesiaPackage[a][n]||0}]}],checkupPackages:[{id:"health_checkup",name:"건강검진 패키지",category:"checkup",options:Object.entries(et.healthCheckup[a]).map(e=>{let[t,s]=e;return{key:t,label:t,price:s[n]||0}})}]}}})({...t,species:m,weight:u}):null,[t,m,u]);n.useEffect(()=>{let e=s.filter(e=>"scaling"===e.category).reduce((e,t)=>e+(t.price||0),0),t=s.filter(e=>"checkup"===e.category).reduce((e,t)=>e+(t.price||0),0);r(s=>({...s,anesthesia:e,checkup:t}))},[s,r]);let h=()=>{d(null)};if(!x)return(0,a.jsx)(eZ,{value:"item-9",children:(0,a.jsx)(j.Zp,{children:(0,a.jsx)(j.Wu,{className:"pt-6",children:(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"환자 정보 (종, 체중)를 먼저 입력해주세요."})})})});let p=e=>{let t=s.filter(t=>t.category===e),n=t.length>0;return(0,a.jsxs)(j.Zp,{className:(0,M.cn)("flex flex-col cursor-pointer transition-all",n?"border-primary shadow-lg":"hover:shadow-md"),onClick:()=>{d(e)},children:[(0,a.jsxs)("div",{className:(0,M.cn)("flex-grow flex flex-col items-center justify-center p-4 gap-2 rounded-t-lg",n?"bg-primary/10":""),children:[(0,a.jsxs)("div",{className:(0,M.cn)("flex items-center gap-2 text-lg font-semibold",n?"text-primary":"text-card-foreground"),children:[(0,a.jsx)(se.A,{className:"h-6 w-6"}),(0,a.jsx)("span",{children:"scaling"===e?"스케일링 & 마취":"건강검진"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-center h-4",children:n?"".concat(t.length,"개 항목 선택됨"):"패키지를 선택하세요."})]}),n&&(0,a.jsx)("div",{className:"p-3 border-t border-primary/20 bg-primary/5 space-y-1.5",children:t.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2 text-xs text-primary font-medium",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(eQ.A,{className:"h-3 w-3 flex-shrink-0"}),(0,a.jsx)("p",{className:"truncate",children:e.name})]}),(0,a.jsx)("span",{className:"font-mono whitespace-nowrap",children:e.price>0?"(".concat(e.price.toLocaleString(),"원)"):""})]},e.id+e.optionKey))})]})};return(0,a.jsx)(eZ,{value:"item-9",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsx)(j.ZB,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(se.A,{}),"패키지 선택"]})})}),(0,a.jsxs)(eK,{className:"p-6 pt-0",children:[(0,a.jsx)(j.BT,{className:"mb-4",children:"각 항목을 클릭하여 스케일링, 마취 및 건강검진 패키지를 선택하세요."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p("scaling"),p("checkup")]}),(()=>{if(!c||!x)return null;let e="scaling"===c?x.itemsByCategoryId.scalingPackages:x.itemsByCategoryId.checkupPackages;return(0,a.jsx)($,{open:!!c,onOpenChange:e=>!e&&h(),children:(0,a.jsxs)(U,{className:"w-full sm:max-w-md",children:[(0,a.jsxs)(V,{children:[(0,a.jsxs)(Y,{children:["scaling"===c?"스케일링 & 마취":"건강검진"," 패키지 선택"]}),(0,a.jsx)(J,{children:"원하는 패키지를 선택하세요. 그룹 내에서 하나만 선택할 수 있습니다."})]}),(0,a.jsx)(D.F,{className:"h-[calc(100vh-8rem)] pr-4 mt-4",children:(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm",children:e.name}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:e.options.map(t=>{let n=s.some(s=>s.category===e.category&&s.optionKey===t.key);return(0,a.jsxs)(j.Zp,{className:(0,M.cn)("flex flex-col cursor-pointer transition-all hover:shadow-md",n?"border-primary shadow-lg":""),onClick:()=>((e,t)=>{let a={id:e.id,optionKey:t.key,price:t.price,name:t.label,category:e.category};i(s.some(e=>e.id===a.id&&e.optionKey===a.optionKey)?s.filter(s=>s.category!==e.category||s.id!==e.id||s.optionKey!==t.key):[...s.filter(t=>t.category!==e.category),a]),h()})(e,t),children:[(0,a.jsx)(j.aR,{className:(0,M.cn)("flex-grow p-3",n?"bg-primary/10":""),children:(0,a.jsx)(j.ZB,{className:(0,M.cn)("text-sm",n?"text-primary":""),children:t.label})}),(0,a.jsx)(j.Wu,{className:(0,M.cn)("p-3 border-t",n?"border-primary/20 bg-primary/5":""),children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"font-semibold text-base",children:[(t.price||0).toLocaleString(),"원"]}),n&&(0,a.jsx)(eQ.A,{className:"h-5 w-5 text-primary"})]})})]},"".concat(e.id,"-").concat(t.key))})})]},e.id))})})]})})})()]})]})})}),ss=e=>{if(void 0===e)return null;if(Array.isArray(e))return e.map(e=>ss(e));if(null!==e&&"object"==typeof e&&!(e instanceof d.Dc)&&!(e instanceof Date)){let t={};for(let s in e)if(Object.prototype.hasOwnProperty.call(e,s)){let a=e[s];t[s]=ss(a)}return t}return e};function sa(e){let{patientId:t}=e,{patient:s,dentalData:i,setDentalData:r,dischargeMeds:S,setDischargeMeds:D,additionalTreatments:R,setAdditionalTreatments:M,selectedPackages:A,setSelectedPackages:F,costs:L,setCosts:T,sodalimeRecord:P,isLoading:z,images:E,setImages:B}=tS(t),[W,O]=(0,n.useState)("idle"),[H,$]=(0,n.useState)(null),[Z,G]=(0,n.useState)("none"),[K,q]=(0,n.useState)(!1);(0,c.useRouter)();let{toast:U}=(0,k.dj)(),V=(0,o.mN)({resolver:(0,m.u)(h),defaultValues:{guardianName:"",guardianPhone:"",chartId:"",name:"",species:"개",breed:"",birthDate:null,gender:"수컷",isNeutered:!1,weight:0,hasHeartCondition:!1,hasLiverCondition:!1,hasKidneyCondition:!1,hasBloodCondition:!1,surgeryDate:null,detailedFindings:"",googleDriveLink:"",surgeryStartTime:null,surgeryEndTime:null,anesthesiaDuration:0,catheterSize:"",cuffGuide:""}});(0,n.useEffect)(()=>{if(s){var e,t,a,n,i,r,l,c,o,m,u,x,h,p,g,j,f,y;let b={guardianName:null!=(e=s.guardianName)?e:"",guardianPhone:null!=(t=s.guardianPhone)?t:"",chartId:null!=(a=s.id)?a:"",name:null!=(n=s.name)?n:"",species:null!=(i=s.species)?i:"개",breed:null!=(r=s.breed)?r:"",detailedFindings:null!=(l=s.detailedFindings)?l:"",googleDriveLink:null!=(c=s.googleDriveLink)?c:"",catheterSize:null!=(o=s.catheterSize)?o:"",cuffGuide:null!=(m=s.cuffGuide)?m:"",weight:null!=(u=s.weight)?u:0,anesthesiaDuration:null!=(x=s.anesthesiaDuration)?x:0,birthDate:s.birthDate instanceof d.Dc?s.birthDate.toDate():s.birthDate||null,surgeryDate:s.surgeryDate instanceof d.Dc?s.surgeryDate.toDate():s.surgeryDate||null,surgeryStartTime:s.surgeryStartTime instanceof d.Dc?s.surgeryStartTime.toDate():s.surgeryStartTime||null,surgeryEndTime:s.surgeryEndTime instanceof d.Dc?s.surgeryEndTime.toDate():s.surgeryEndTime||null,isNeutered:null!=(h=s.isNeutered)&&h,hasHeartCondition:null!=(p=s.hasHeartCondition)&&p,hasKidneyCondition:null!=(g=s.hasKidneyCondition)&&g,hasLiverCondition:null!=(j=s.hasLiverCondition)&&j,hasBloodCondition:null!=(f=s.hasBloodCondition)&&f,gender:null!=(y=s.gender)?y:"수컷"};V.reset(b)}},[s,V]);let X=(0,n.useCallback)(async e=>{if(s){O("saving");try{let a=(0,d.H9)(x.db,"patients",t),n={...e,birthDate:e.birthDate?d.Dc.fromDate(e.birthDate):null,surgeryDate:e.surgeryDate?d.Dc.fromDate(e.surgeryDate):null,surgeryStartTime:e.surgeryStartTime?d.Dc.fromDate(e.surgeryStartTime):null,surgeryEndTime:e.surgeryEndTime?d.Dc.fromDate(e.surgeryEndTime):null,updatedAt:(0,d.O5)(),dentalData:i,costs:L,additionalTreatments:R,selectedPackages:A,dischargeMeds:S,analysisResult:s.analysisResult||null,analysisText:s.analysisText||""};n=ss(n),await (0,d.mZ)(a,n),O("saved"),setTimeout(()=>O("idle"),2e3),U({title:"성공",description:"모든 차트 정보가 저장되었습니다."})}catch(e){console.error("Manual save failed:",e),U({title:"저장 실패",description:"차트 정보를 저장하는 데 실패했습니다: ".concat(e.message||e),variant:"destructive"}),O("idle")}}},[s,i,L,R,A,S,t,U]),Y=(0,n.useCallback)((e,t)=>{V.setValue("catheterSize",e,{shouldDirty:!0}),V.setValue("cuffGuide",t,{shouldDirty:!0})},[V]);if(z)return(0,a.jsx)(p.p,{text:"환자 정보를 불러오는 중..."});if(!s)return(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{children:"환자를 찾을 수 없습니다."}),(0,a.jsx)(g.$,{asChild:!0,variant:"outline",className:"mt-4",children:(0,a.jsxs)(l(),{href:"/",children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"환자 목록으로 돌아가기"]})})]});if("none"!==Z){let e=V.getValues(),t={patient:{...s,...e,id:s.id},costs:L,images:E||[],dentalData:i,additionalTreatments:R||[],selectedPackages:A||[]};if("estimate"===Z)return(0,a.jsx)(tZ,{data:t,onBack:()=>G("none")});if("record"===Z)return(0,a.jsx)(tV,{data:t,onBack:()=>G("none")})}let{control:J,species:Q,weight:ee,catheterSize:et,cuffGuide:es,googleDriveLink:ea}=V.watch();return(0,a.jsxs)("div",{className:"relative min-h-[calc(100vh-10rem)] space-y-8",children:[(0,a.jsx)(o.Op,{...V,children:(0,a.jsxs)("form",{onSubmit:V.handleSubmit(X),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[(0,a.jsx)(g.$,{asChild:!0,variant:"secondary",type:"button",className:"w-full md:w-auto",children:(0,a.jsxs)(l(),{href:"/guardian/".concat(encodeURIComponent(s.guardianPhone)),children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"보호자 정보로 돌아가기"]})}),(0,a.jsx)("div",{className:"flex w-full md:w-auto items-center gap-2",children:(0,a.jsxs)(g.$,{type:"submit",className:"flex-1 bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(y.A,{className:"mr-2"})," 전체 차트 저장"]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:["개"===s.species?(0,a.jsx)(e4.w,{className:"h-10 w-10 text-primary"}):(0,a.jsx)(e3.k,{className:"h-10 w-10 text-primary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:s.name}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[s.guardianName," (",s.guardianPhone,")"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 w-full md:w-auto items-center gap-2",children:[(0,a.jsxs)(g.$,{type:"button",onClick:()=>G("estimate"),children:[(0,a.jsx)(b.A,{className:"mr-2"})," 예상비용 출력"]}),(0,a.jsxs)(g.$,{type:"button",onClick:()=>G("record"),children:[(0,a.jsx)(b.A,{className:"mr-2"})," 수술기록 출력"]})]})]}),(0,a.jsx)(e8,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)(t9,{patientId:t}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(e2.zB,{control:J,name:"googleDriveLink",render:e=>{let{field:t}=e;return(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(j.aR,{children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{})," Google Drive 링크"]})}),(0,a.jsxs)(j.Wu,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(e2.MJ,{children:(0,a.jsx)(I.p,{placeholder:"사진, 파일 등이 저장된 폴더 링크",...t,value:t.value||""})}),(0,a.jsx)(g.$,{type:"button",variant:"outline",size:"icon",asChild:!0,disabled:!ea||!u.Yj().url().safeParse(ea).success,children:(0,a.jsx)("a",{href:ea||"",target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(v.A,{})})})]}),(0,a.jsx)(e2.C5,{})]})]})}}),(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(j.aR,{children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(N.A,{}),"기관 카테터 선택"]})}),(0,a.jsx)(j.Wu,{children:(0,a.jsx)(tT,{species:Q,weight:ee,currentSize:et,currentCuffGuide:es,onSave:Y})})]})]})]}),(0,a.jsxs)(e$,{type:"multiple",className:"w-full space-y-6",defaultValue:[],children:[(0,a.jsx)(tu,{}),(0,a.jsx)(td,{}),(0,a.jsx)(tc,{}),(0,a.jsx)(tr,{sodalimeRecord:P,setSodalimeDialogOpen:q}),(0,a.jsx)(eZ,{value:"item-11",children:(0,a.jsxs)(j.Zp,{children:[(0,a.jsx)(eG,{className:"p-6",children:(0,a.jsxs)(j.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{}),"퇴원약 조제"]})}),(0,a.jsxs)(eK,{className:"p-6 pt-0",children:[(0,a.jsx)(j.BT,{className:"mb-4",children:"환자 상태에 따라 약물을 선택하고, 필요한 총량을 계산합니다."}),(0,a.jsx)(eW,{selectedMeds:S,onSelectedMedsChange:D})]})]})})]}),(0,a.jsx)(eg,{patient:s,dentalData:i,onUpdate:r}),(0,a.jsxs)(e$,{type:"multiple",className:"w-full space-y-6",defaultValue:["item-9"],children:[(0,a.jsx)(st,{patient:s,selectedPackages:A,onPackagesChange:F,setCosts:T}),(0,a.jsx)(e1,{patient:s,selectedTreatments:R,onTreatmentsChange:M,setCosts:T}),(0,a.jsx)(tC,{patientId:t,images:E,setImages:B,openImageViewer:(e,t)=>{$({images:e,startIndex:t})}}),(0,a.jsx)(tk,{costs:L,setCosts:T,dentalData:i,additionalTreatments:R,patient:s,selectedPackages:A})]})]})}),(0,a.jsxs)("div",{className:"fixed bottom-4 right-4 z-50",children:["saving"===W&&(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-secondary p-3 text-secondary-foreground shadow-lg",children:[(0,a.jsx)(C.A,{className:"h-5 w-5 animate-spin"}),(0,a.jsx)("span",{children:"저장 중..."})]}),"saved"===W&&(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-green-100 p-3 text-green-800 shadow-lg",children:[(0,a.jsx)(_.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"모든 변경사항이 저장되었습니다."})]})]}),(0,a.jsx)(eI,{open:K,onOpenChange:q,sodalimeRecord:P}),s&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(tE,{imageData:H,onClose:()=>$(null)})})]})}var sn=s(9017),si=s(2641);function sr(e){let{patientId:t}=e,[s,r]=(0,i.M)("isLoggedIn",!1),[l,c]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{c(!0)},[]),l)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sn.Y,{isLoggedIn:s,onLogout:()=>r(!1)}),(0,a.jsx)("div",{className:"container mx-auto p-4 md:p-6",children:s?(0,a.jsx)(sa,{patientId:t}):(0,a.jsx)(si.A,{onLoginSuccess:()=>r(!0)})})]}):null}},7270:(e,t,s)=>{"use strict";s.d(t,{A0:()=>l,BF:()=>c,Hj:()=>d,XI:()=>r,nA:()=>m,nd:()=>o});var a=s(5155),n=s(2115),i=s(4269);let r=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",s),...n})})});r.displayName="Table";let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",s),...n})});l.displayName="TableHeader";let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",s),...n})});c.displayName="TableBody",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...n})}).displayName="TableFooter";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...n})});d.displayName="TableRow";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("th",{ref:t,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...n})});o.displayName="TableHead";let m=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("td",{ref:t,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...n})});m.displayName="TableCell",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",s),...n})}).displayName="TableCaption"}},e=>{e.O(0,[992,138,524,45,619,279,566,815,885,429,153,441,255,358],()=>e(e.s=2260)),_N_E=e.O()}]);